streamline_templates:
  clim_ampere_ring-tile:
    card:
      type: vertical-stack
      cards:
        - type: custom:ring-tile
          name: '[[card_name]]'
          entity: '[[entity]]'
          ring_entity: '[[entity]]'
          ring_type: open
          ring_size: 3
          scale: ticks_with_labels
          top_element: none
          middle_element: value_with_unit
          bottom_element: name
          colorize_icon: true
          indicator: dot
          min: 0
          max: 10
          colour:
            '0': ha_green
            '4': ha_green
            '5': ha_orange
            '6': ha_orange
            '7': ha_red
            '10': ha_red
          card_mod:
            style: |
              ha-card {
                background: none !important;
                border: none !important;
                box-shadow: none !important;
              }
  clim_voltage_ring-tile:
    card:
      type: vertical-stack
      cards:
        - type: custom:ring-tile
          name: '[[card_name]]'
          entity: '[[entity]]'
          ring_entity: '[[entity]]'
          ring_type: open
          ring_size: 3
          scale: ticks_with_labels
          top_element: none
          middle_element: value_with_unit
          bottom_element: name
          colorize_icon: true
          indicator: dot
          min: 170
          max: 240
          colour:
            '170': ha_red
            '190': ha_red
            '195': ha_orange
            '205': ha_orange
            '210': ha_green
            '240': ha_green
          card_mod:
            style: |
              ha-card {
                background: none !important;
                border: none !important;
                box-shadow: none !important;
              }
  nav_bar:
    card:
      type: vertical-stack
      cards:
        - type: custom:navbar-card
          routes:
            - url: /dashboard-tablette/home
              icon: mdi:home
              label: Home
            - url: /dashboard-tablette/lumieres
              icon: mdi:lightbulb
              label: lum.
            - url: /dashboard-tablette/clim
              icon: mdi:air-conditioner
              label: Clim
            - url: /dashboard-tablette/stores
              icon: mdi:window-shutter
              label: Stores
            - url: /dashboard-tablette/prises
              icon: mdi:power-plug-off
              label: Prises
            - icon: mdi:dots-horizontal
              label: More
              tap_action:
                action: open-popup
              popup:
                - icon: mdi:cog
                  url: /config/dashboard
                - icon: mdi:hammer
                  url: /developer-tools/yaml
                - icon: mdi:power
                  tap_action:
                    action: call-service
                    service: homeassistant.restart
                    service_data: {}
                    confirmation:
                      text: Are you sure you want to restart Home Assistant?
          card_mod:
            style: |
              ha-card {
                background: black !important;
                box-shadow: none !important;
                border: none !important;
              }
  calcule_temp_cible:
    card:
      type: vertical-stack
      cards:
        - type: markdown
          content: >
            **<<< CALCUL DE LA TEMPERATURE CIBLE >>>**

            {% set temp_ext = states('sensor.th_balcon_nord_temperature') |
            float(-999) %}  {% set consigne_de_base =
            states('sensor.consigne_de_base') | int(0) %}  {% set mode =
            states('sensor.mode_ete_hiver') %} {% set temp_eco =
            states('sensor.temperature_eco_hiver') | int(0) %}  {% set
            temp_eco_c = states('sensor.temperature_eco_hiver_corrige') | int(0)
            %} {% set temp_hg = states('sensor.temperature_hors_gel_hiver') |
            int(0) %}  {% set temp_diff =
            states('sensor.temperature_differentielle') | int(0) %} {% set
            delta_1 = states('sensor.delta_1') | int(0) %}  {% set delta_2 =
            states('sensor.delta_2') | int(0) %} {% set delta_5 =
            states('sensor.delta_5') | int(0) %} {% set delta_7 =
            states('sensor.delta_7') | int(0) %} {% set temp_cible =
            states('sensor.temperature_cible') | int(0) %} {% set temp_confort =
            states('sensor.temperature_confort_jour') | int(0) %} {% set
            temp_confort_n = states('sensor.temperature_confort_nuit') | int(0)
            %}  {% set tcmh = states('sensor.temperature_corrige_mamour_hivers')
            | float(0) %} {% set tceh =
            states('sensor.temperature_corrige_eric_hivers') | float(0) %} {%
            set tcch = states('sensor.temperature_corrige_chambre_hivers') |
            float(0) %}

            **TempÃ©rature ExtÃ©rieure: {{ temp_ext | round(2) }}Â°C**

             **RÃ©sumÃ© des valeurs actuel :**

            {% if temp_ext < 10 %}
              **- Calcul TÂ°cible si TÂ°Ext. â‰¤ 10Â°C [ {{ consigne_de_base }} + {{ delta_2 }} = {{ (consigne_de_base + delta_2) | round(0) }}Â°C ]**
              **- TempÃ©rature cible [ {{ temp_cible | round(0) }}Â°C ]**
              
              **- Calcul TÂ°Diff. si TÂ°Ext. â‰¤ 10Â°C [ {{ temp_diff }} + {{ delta_2 }} = {{ (temp_diff + delta_2) | round(0) }}Â°C ]**
              **- TempÃ©rature confort [ {{ temp_confort | round(0) }}Â°C ]**
              - Salon [ {{ tcmh | round(0) }}Â°C ]
              - Bureau [ {{ tceh | round(0) }}Â°C ]   
              - Chambre [ {{ tcch | round(0) }}Â°C ]
              
              **- TempÃ©rature confort de nuit [ {{ temp_confort_n | round(0) }}Â°C ] (21h <-> 7h30)**
              
              **- Calcul TÂ°Ã©CO si TÂ°Ext. â‰¤ 10Â°C [ {{ temp_eco }} + {{ delta_1 }} = {{ (temp_eco + delta_1) | round(0) }}Â°C ]**
              **- TempÃ©rature Ã©CO corrigÃ©: {{ temp_eco_c }}Â°C (Ã©CO. si absents)**
            {% elif temp_ext < 12 %}
              **- Calcul TÂ°cible si TÂ°Ext. â‰¤ 12Â°C [ {{ consigne_de_base }} + {{ delta_1 }} = {{ (consigne_de_base + delta_1) | round(0) }}Â°C ]**
              **- TempÃ©rature cible [ {{ temp_cible | round(0) }}Â°C ]**

              **- Calcul TÂ°Diff. si TÂ°Ext. â‰¤ 12Â°C [ {{ temp_diff }} + {{ delta_1 }} = {{ (temp_diff + delta_1) | round(0) }}Â°C ]**
              **- TempÃ©rature confort [ {{ temp_confort | round(0) }}Â°C ]**
              - Salon [ {{ tcmh | round(0) }}Â°C ]
              - Bureau [ {{ tceh | round(0) }}Â°C ]   
              - Chambre [ {{ tcch | round(0) }}Â°C ]
              
              **- TempÃ©rature confort de nuit [ {{ temp_confort_n | round(0) }}Â°C ] (21h <-> 7h30)**
              **- TempÃ©rature Ã©CO. : {{ temp_eco_c | round(0) }}Â°C -> (Ã©CO. si absents)**
            {% elif temp_ext > 40 %}
              **- Calcul TÂ°cible si TÂ°Ext. â‰¥ 40Â°C [ {{ temp_ext | round(0) }} - {{ delta_7 }} = {{ (temp_ext - delta_7) | round(0) }}Â°C ]**
              **- TempÃ©rature cible [ {{ temp_cible | round(0) }}Â°C ]**
              **- TempÃ©rature confort [ {{ temp_confort | round(0) }}Â°C ]**
            {% elif temp_ext > 32 %}
              **- Calcul TÂ°cible si TÂ°Ext. â‰¥ 32Â°C [ {{ temp_ext | round(0) }} - {{ delta_5 }} = {{ (temp_ext - delta_5) | round(0) }}Â°C ]**
              **- TempÃ©rature cible [ {{ temp_cible | round(0) }}Â°C ]**
              **- TempÃ©rature confort [ {{ temp_confort | round(0) }}Â°C ]**
            {% else %}
              **- TempÃ©rature cible [ {{ temp_cible | round(0) }}Â°C ]**
              **- TempÃ©rature confort [ {{ temp_confort | round(0) }}Â°C ]**
              {% if mode == "heat" %} **- TempÃ©rature confort de nuit [ {{ temp_confort_n | round(0) }}Â°C ] (21h <-> 7h30)**  {% endif %}
              {% if temp_ext < 17 %} **- TempÃ©rature Ã©CO. : {{ temp_eco_c | round(0) }}Â°C -> (Ã©CO. si absents)** {% endif %}
            {% endif %}

            **RÃ©sumÃ© des valeurs de base :**

            - Consigne de Base : {{ consigne_de_base }}Â°C

            - TempÃ©rature Cible : {{ temp_cible | round(0) }}Â°C

            - TempÃ©rature diffÃ©rentielle : {{ temp_diff | round(0) }}Â°C ->
            (Confort)

            - TempÃ©rature Ã©CO. : {{ temp_eco | round(0) }}Â°C -> (Ã©CO. si
            absents)



            **DELTA: {{ states('sensor.temperature_delta_affichage') |
            default('N/A') }}**


            **MODE: {{ states('sensor.mode_ete_hiver') | upper | default('N/A')
            }}**


            **Groupe = {{ states('sensor.groupe_clim') | default('N/A') }} -
            Presence = {{ states('sensor.presence_clim')  | default('N/A') }}**
          card_mod:
            style: |
              ha-card {
                border: none !important;
                box-shadow: none !important;
                background: transparent;
              }
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_jour_6h_21h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state: groupe_1
          card:
            type: markdown
            content: >
              **{{ states('sensor.presence_clim') }} (6h âŸ· 21h)** {% if
              is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Fan Only
                - Climatiseur Bureau : Fan Only
                - Climatiseur Chambre : Fan Only
              {% endif %}
            text_only: true
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_jour_6h_21h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state: groupe_2
          card:
            type: markdown
            content: >
              **{{ states('sensor.presence_clim') }} (6h âŸ· 21h)**  {% if
              is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_confort') | int }}Â°C (Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}Â°C (Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_confort') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Off
                - Climatiseur Bureau : Off
                - Climatiseur Chambre : Off
              {% endif %}
            text_only: true
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_jour_6h_21h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state: groupe_3
          card:
            type: markdown
            content: >
              **{{ states('sensor.presence_clim') }} (6h âŸ· 21h)** {% if
              is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}Â°C (Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_confort') | int }}Â°C (Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_confort') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Off
                - Climatiseur Bureau : Off
                - Climatiseur Chambre : Off
              {% endif %}    
            text_only: true
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_jour_6h_21h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state: groupe_4
          card:
            type: markdown
            content: |
              **{{ states('sensor.presence_clim') }} (6h âŸ· 21h)**
              {% if is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_confort') | int }}Â°C (Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_confort') | int }}Â°C (Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_confort') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_confort') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Off
                - Climatiseur Bureau : Off
                - Climatiseur Chambre : Off
              {% endif %}
            text_only: true
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_nuit_21h_6h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state: groupe_1
          card:
            type: markdown
            content: >
              **{{ states('sensor.presence_clim') }} (21h âŸ· 6h)** {% if
              is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_eco_hiver_corrige') | int }}Â°C (Ã©CO Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Fan Only
                - Climatiseur Bureau : Fan Only
                - Climatiseur Chambre : Fan Only
              {% endif %}
            text_only: true
        - type: conditional
          conditions:
            - condition: state
              entity: binary_sensor.est_nuit_21h_6h
              state: 'on'
            - condition: state
              entity: sensor.groupe_clim
              state_not: groupe_1
          card:
            type: markdown
            content: >
              **{{ states('sensor.presence_clim') }} (21h âŸ· 6h)** {% if
              is_state('sensor.mode_ete_hiver', 'heat') %}
                - Climatiseur Salon : {{ states('sensor.temperature_confort_nuit') | int }}Â°C (Heat)
                - Climatiseur Bureau : {{ states('sensor.temperature_confort_nuit') | int }}Â°C (Heat)
                - Climatiseur Chambre : {{ states('sensor.temperature_confort_nuit') | int }}Â°C (Heat)
              {% elif is_state('sensor.mode_ete_hiver', 'cool') %}
                - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}Â°C (Cool)
                - Climatiseur Chambre : {{ states('sensor.temperature_confort_nuit') | int }}Â°C (Cool)
              {% else %}
                - Climatiseur Salon : Off
                - Climatiseur Bureau : Off
                - Climatiseur Chambre : Off
              {% endif %}
            text_only: true
  carte_des_temperatures:
    card:
      type: custom:temperature-heatmap-card
      entity: '[[entity]]'
      title: '[[card_title]]'
      month_label: true
      day_label: true
      footer: true
      day_trend: true
      decimal_point: true
      card_mod:
        style: |
          ha-card {
            background: none !important;
            border: none !important;
            box-shadow: none !important;
          }
  pm25_ring-tile:
    card:
      type: vertical-stack
      cards:
        - type: custom:ring-tile
          name: '[[card_name]]'
          entity: '[[entity]]'
          ring_entity: '[[entity]]'
          ring_type: open
          ring_size: 3
          scale: ticks_with_labels
          top_element: none
          middle_element: value_with_unit
          bottom_element: name
          colorize_icon: true
          indicator: dot
          marker: 15
          marker_colour: rgb(255,193,7)
          marker2: '[[marker2]]'
          marker2_colour: rgb(244,67,54)
          min: 0
          max: 150
          colour:
            '0': '#50f0e6'
            '15': '#50ccaa'
            '25': '#f0e641'
            '50': '#ff5050'
            '75': '#960032'
            '37.5': '#ffb000'
          card_mod:
            style: |
              ha-card {
                background: none !important;
                border: none !important;
                box-shadow: none !important;
              }
        - type: markdown
          content: |
            <div style="text-align:center; line-height:1.2;">
              <strong>ðŸŸ¡ Limite: 15&nbsp;Âµg/mÂ³</strong>
              <strong>ðŸ”´ Moyenne 24&nbsp;h</strong>
            </div>
          card_mod:
            style: |
              ha-card {
                margin-top: -30px;
                margin-bottom:30px;     
                font-size: 11px;
                background: none !important;
                border: none !important;
                text-align: center;
                box-shadow: none !important;
              }
  cov_ring-tile:
    card:
      type: vertical-stack
      cards:
        - type: custom:ring-tile
          name: '[[card_name]]'
          entity: '[[entity]]'
          ring_entity: '[[entity]]'
          ring_type: open
          ring_size: 3
          scale: ticks_with_labels
          top_element: none
          middle_element: value_with_unit
          bottom_element: name
          colorize_icon: true
          indicator: dot
          unit: ppb
          min: 0
          max: 2000
          marker: 300
          marker_colour: rgb(255,193,7)
          marker2: '[[marker2]]'
          marker2_colour: rgb(244,67,54)
          colour:
            '0': '#50f0e6'
            '300': '#f0e641'
            '500': '#ffb000'
            '750': '#ff5050'
            '1000': '#8f3f97'
            '2000': '#7e0023'
          card_mod:
            style: |
              ha-card {
                background: transparent !important;
                border: none !important;
                box-shadow: none !important;
              }
        - type: markdown
          content: |
            <div style="text-align:center; line-height:1.2;">
              <strong>ðŸŸ¡ Limite: 300&nbsp;ppb</strong>
              <strong>ðŸ”´ Moyenne 24&nbsp;h</strong>
            </div>
          card_mod:
            style: |
              ha-card {
                 margin-top: -30px;
                margin-bottom: 30px;   
                font-size: 11px;
                background: none !important;
                border: none !important;
                text-align: center;
                box-shadow: none !important;
              }
  portable:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
      graph_span: 24h
      cache: true
      span:
        offset: +30m
      apex_config:
        chart:
          height: 340px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: Niveau de la batterie
        show_states: true
        colorize_states: true
      yaxis:
        - id: Niveau
          min: ~20
          max: ~100
          decimals: 0
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: false
          extremas: true
        curve: stepline
      series:
        - entity: '[[entity]]'
          name: Batterie
          yaxis_id: Niveau
          type: area
          color: green
          stroke_width: 1
          opacity: 0.4
          fill_raw: last
          group_by:
            func: last
            duration: 5m
          color_threshold:
            - value: 80
              color: green
            - value: 65
              color: orange
            - value: 20
              color: red
      card_mod:
        style: >
          ha-card { background: none !important; box-shadow: none !important;
          border: none !important; }
  pm25:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: +2m
      apex_config:
        chart:
          height: 340px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: Air Quality P.M. 2.5
        show_states: true
        colorize_states: true
      yaxis:
        - id: pm25
          min: 0
          max: ~15
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
      series:
        - entity: '[[entity_sensor]]'
          name: P.M. 2.5
          yaxis_id: pm25
          type: area
          color: green
          stroke_width: 1
          opacity: 0.4
          fill_raw: last
          group_by:
            func: last
            duration: 1m
          color_threshold:
            - value: 0
              color: green
            - value: 35
              color: orange
            - value: 120
              color: red
        - entity: '[[mean_24h_entity]]'
          name: Mean(24hrs)
          yaxis_id: pm25
          type: line
          color: red
          stroke_width: 2
          stroke_dash: 8
        - entity: '[[entity_sensor]]'
          yaxis_id: pm25
          type: area
          color: green
          stroke_width: 1
          opacity: 0.4
          show:
            in_brush: true
            in_chart: false
          group_by:
            func: last
            duration: 10m
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
  cov:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: +2m
      apex_config:
        chart:
          height: 340px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: Air Quality tC.O.V.
        show_states: true
        colorize_states: true
      yaxis:
        - id: cov
          min: 0
          max: ~300
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
      series:
        - entity: '[[entity_sensor]]'
          name: ComposÃ©s Organiques Volatils
          yaxis_id: cov
          unit: PPB
          type: area
          color: green
          stroke_width: 1
          opacity: 0.4
          fill_raw: last
          group_by:
            func: last
            duration: 1m
          color_threshold:
            - value: 0
              color: green
            - value: 300
              color: orange
            - value: 750
              color: red
        - entity: '[[mean_24h_entity]]'
          name: Mean(24hrs)
          yaxis_id: cov
          unit: PPB
          type: line
          color: red
          stroke_width: 2
          stroke_dash: 8
          group_by:
            func: avg
            duration: 24h
        - entity: '[[entity_sensor]]'
          yaxis_id: cov
          type: area
          color: green
          stroke_width: 1
          opacity: 0.4
          show:
            in_brush: true
            in_chart: false
          group_by:
            func: last
            duration: 10m
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
  temperature_humidite:
    card:
      type: custom:mod-card
      card_mod:
        style: >
          ha-card { background: transparent; border: transparent; box-shadow:
          none; }
      card:
        type: vertical-stack
        cards:
          - type: custom:apexcharts-card
            chart_type: radialBar
            cache: true
            series:
              - entity: '[[humidity_entity]]'
                max: 100
                color: rgb(19, 160, 255)
              - entity: '[[temperature_entity]]'
                max: 40
                color: '#ff9800'
            apex_config:
              chart:
                height: 200
              legend:
                show: false
              plotOptions:
                radialBar:
                  hollow:
                    size: 70%
                  dataLabels:
                    name:
                      show: false
                    value:
                      show: false
            card_mod:
              style: |
                ha-card { background: none; border: none; box-shadow: none; }
          - type: custom:button-card
            entity: '[[temperature_entity]]'
            size: 5%
            icon: '[[icon]]'
            show_state: false
            show_name: false
            label: '[[card_title]]'
            show_label: true
            styles:
              grid:
                - grid-template-areas: '"i" "l" "temp" "hum"'
            custom_fields:
              temp: >
                [[[ const t = states['[[temperature_entity]]']?.state ?? '-';
                return `<ha-icon icon="mdi:thermometer"
                style="width:15px;height:15px;margin-right:5px;"></ha-icon><span
                style="font-size:12px;font-weight:bold;">${t}Â°C</span>`; ]]]
              hum: >
                [[[ const h = states['[[humidity_entity]]']?.state ?? '-';
                return `<ha-icon icon="mdi:water"
                style="width:15px;height:15px;margin-right:5px;"></ha-icon><span
                style="font-size:12px;font-weight:bold;">${h}%</span>`; ]]]
            card_mod:
              style: >
                ha-card { margin-top: -170px; background: none; border: none;
                box-shadow: none; }
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: true
            span:
              offset: +2m
            apex_config:
              chart:
                height: 250px
              legend:
                show: false
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              title: '[[card_title]]'
              show_states: true
              colorize_states: true
            yaxis:
              - id: humidity
                min: ~30
                max: ~70
                decimals: 0
                apex_config:
                  tickAmount: 10
              - id: temperature
                min: ~10
                max: ~32
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 30m
              show:
                legend_value: false
                extremas: true
            brush:
              selection_span: 1h
            series:
              - entity: '[[temperature_entity]]'
                name: TempÃ©rature
                yaxis_id: temperature
                type: line
                color: '#ff9800'
                stroke_width: 2
                fill_raw: last
              - entity: '[[humidity_entity]]'
                name: HumiditÃ©
                yaxis_id: humidity
                type: column
            card_mod:
              style: >
                ha-card { margin-top: -150px !important; background: none
                !important; border: none !important; box-shadow: none
                !important; }
  conso_temps_reel_appareil:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      cache: true
      span:
        offset: +2m
      apex_config:
        chart:
          height: 340px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: '[[card_title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: 0
          max: auto
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
        - id: A
          min: 0
          max: auto
          decimals: 2
          opposite: true
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
      series:
        - entity: '[[energy_entity]]'
          name: InstantanÃ©
          yaxis_id: Watts
          type: area
          color: '[[energy_color]]'
          stroke_width: 1
          opacity: 0.4
          fill_raw: last
          group_by:
            func: last
            duration: 1m
        - entity: '[[current_entity]]'
          name: IntensitÃ©
          yaxis_id: A
          type: line
          color: red
          unit: A
          stroke_width: 1.5
          group_by:
            func: last
            duration: 1m
        - entity: '[[avg_daily_entity]]'
          name: Moy. depuis minuit
          yaxis_id: Watts
          type: line
          color: '#F44336'
          unit: W
          stroke_width: 2.5
          stroke_dash: 8
        - entity: '[[conso_daily_kwh_entity]]'
          name: Jour en cours
          color: '#F44336'
          show:
            in_header: true
            in_brush: false
            in_chart: false
          opacity: 0
        - entity: '[[energy_entity]]'
          yaxis_id: Watts
          type: area
          color: '[[energy_color]]'
          stroke_width: 0.5
          opacity: 0.4
          show:
            in_brush: true
            in_chart: false
          group_by:
            func: last
            duration: 1m
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
  conso_mensuelle_appareil:
    card:
      type: custom:apexcharts-card
      graph_span: 730h
      cache: true
      span:
        end: day
      apex_config:
        chart:
          height: 340px
      now:
        show: false
      header:
        show: true
        title: '[[title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: W_day
          min: 0
          max: auto
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
        - id: Avg
          min: 0
          max: auto
          decimals: 0
          opposite: true
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: true
          extremas: true
      brush:
        selection_span: 24h
      series:
        - entity: '[[energy_entity]]'
          name: Conso. par jour
          yaxis_id: W_day
          type: column
          color: '[[color]]'
          unit: Wh
          transform: return x * 1000;
          group_by:
            func: diff
            duration: 24h
            start_with_last: true
        - entity: '[[avg_monthly_entity]]'
          name: Moy. 1er du mois
          yaxis_id: Avg
          type: line
          color: red
          unit: W
          stroke_width: 2.5
          stroke_dash: 8
          group_by:
            func: last
            duration: 1d
        - entity: '[[conso_monthly_kwh_entity]]'
          name: Mois en ccours
          color: '#F44336'
          unit: kWh
          show:
            in_header: true
            in_brush: false
            in_chart: false
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
  conso_temps_reel_clim_rad:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      cache: true
      span:
        offset: +2m
      apex_config:
        chart:
          height: 340px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: '[[card_title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: 0
          max: auto
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
        - id: A
          min: 0
          max: auto
          decimals: 2
          opposite: true
          apex_config:
            tickAmount: 10
      all_series_config:
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
      series:
        - entity: '[[energy_entity]]'
          name: InstantanÃ©
          yaxis_id: Watts
          type: area
          color: '[[energy_color]]'
          stroke_width: 1
          opacity: 0.4
          fill_raw: last
          group_by:
            func: last
            duration: 1m
        - entity: '[[current_entity]]'
          name: IntensitÃ©
          yaxis_id: A
          type: line
          color: red
          unit: A
          stroke_width: 1.5
          group_by:
            func: last
            duration: 1m
        - entity: '[[avg_daily_entity]]'
          name: Moy. depuis minuit
          yaxis_id: Watts
          type: line
          color: '#F44336'
          unit: W
          stroke_width: 2.5
          stroke_dash: 8
        - entity: '[[conso_daily_kwh_entity]]'
          name: Jour en cours
          color: '#F44336'
          show:
            in_header: true
            in_brush: false
            in_chart: false
          opacity: 0
        - entity: '[[energy_entity]]'
          yaxis_id: Watts
          type: area
          color: '[[energy_color]]'
          stroke_width: 0.5
          opacity: 0.4
          show:
            in_brush: true
            in_chart: false
          group_by:
            func: last
            duration: 1m
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
  conso_mensuelle_clim:
    card:
      type: custom:apexcharts-card
      graph_span: 730h
      cache: true
      span:
        end: day
      apex_config:
        chart:
          height: 340px
      now:
        show: false
      header:
        show: true
        title: '[[title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: W_day
          min: 0
          max: auto
          decimals: 0
          opposite: false
          apex_config:
            tickAmount: 10
        - id: Avg
          min: 0
          max: auto
          decimals: 0
          opposite: true
          apex_config:
            tickAmount: 10
        - id: TH
          show: false
          min: auto
          max: auto
          decimals: 2
          opposite: true
      all_series_config:
        show:
          legend_value: true
          extremas: true
      brush:
        selection_span: 24h
      series:
        - entity: '[[energy_entity]]'
          name: Conso. par jour
          yaxis_id: W_day
          type: column
          color: '[[energy_color]]'
          unit: kWh
          group_by:
            func: diff
            duration: 24h
            start_with_last: true
        - entity: '[[temp_entity]]'
          name: T.Mini.
          yaxis_id: TH
          type: line
          curve: stepline
          color: '#E6E6FA'
          unit: Â°C
          float_precision: 2
          stroke_width: 2
          group_by:
            func: last
            duration: 24h
            start_with_last: true
        - entity: '[[avg_monthly_entity]]'
          name: Moy. 1er du mois
          yaxis_id: Avg
          type: line
          color: red
          unit: W
          stroke_width: 2.5
          stroke_dash: 8
          group_by:
            func: last
            duration: 1d
        - entity: '[[conso_monthly_kwh_entity]]'
          name: Mois en ccours
          color: '#F44336'
          unit: kWh
          show:
            in_header: true
            in_brush: false
            in_chart: false
      card_mod:
        style: >
          ha-card { background: none !important; border: none !important;
          box-shadow: none !important; }
views:
  - title: Home
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: custom:meteofrance-weather-card
            entity: weather.vence
            animated_icons: true
            alert_forecast: true
            details: false
            current: true
            one_hour_forecast: true
            forecast: true
            rainChanceEntity: sensor.vence_rain_chance
            uvEntity: sensor.vence_uv
            cloudCoverEntity: sensor.vence_cloud_cover
            freezeChanceEntity: sensor.vence_freeze_chance
            snowChanceEntity: sensor.vence_snow_chance
            alertEntity: sensor.06_weather_alert
            name: Vence
            detailEntity: sensor.temperature_delta_affichage
            daily_forecast: false
            wind_forecast_icons: true
            humidity_forecast: true
            hourly_forecast: false
            rainForecastEntity: sensor.vence_next_rain
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: conditional
                conditions:
                  - condition: numeric_state
                    entity: sensor.studio_code_server_cpu_percent
                    above: 1
                card:
                  type: custom:button-card
                  entity: sensor.127_0_0_1_cpu_load
                  name: Visual Server Code
                  icon: mdi:microsoft-visual-studio-code
                  show_state: true
                  show_label: false
                  state_display: '[[[ return parseFloat(entity.state).toFixed(2) ]]]'
                  layout: icon_name_state
                  tap_action:
                    action: call-service
                    confirmation:
                      text: |-
                        âš ï¸ VS Code semble bloquÃ© ?

                        Voulez-vous forcer le redÃ©marrage de l'Add-on ?
                    service: hassio.addon_restart
                    service_data:
                      addon: a0d7b954_vscode
                  styles:
                    card:
                      - border-radius: 12px
                      - height: 50px
                      - padding: 0px 15px
                      - background-color: |
                          [[[
                            return (states['sensor.studio_code_server_cpu_percent'].state > 20) 
                            ? '#f44336' : '#03a9f4';
                          ]]]
                      - animation: |
                          [[[
                            return (states['sensor.studio_code_server_cpu_percent'].state > 20) 
                            ? 'blink 1s ease infinite' : 'none';
                          ]]]
                    grid:
                      - grid-template-columns: 35px auto 60px
                    icon:
                      - width: 24px
                      - color: white
                    name:
                      - color: white
                      - font-weight: bold
                      - font-size: 14px
                      - justify-self: start
                    state:
                      - color: white
                      - font-weight: bold
                      - font-size: 14px
                      - justify-self: end
                  extra_styles: |
                    @keyframes blink {
                      50% { opacity: 0.5; }
                    }
          - type: custom:button-card
            entity: sensor.blitzortung_lightning_counter
            triggers_update:
              - sensor.dernier_impact_temps_reel
              - sensor.blitzortung_lightning_distance
            name: |
              [[[
                const distRaw = states['sensor.blitzortung_lightning_distance'] ? parseFloat(states['sensor.blitzortung_lightning_distance'].state) : 0;
                const localisation = states['sensor.blitzortung_lightning_localisation'];
                const azimuth = states['sensor.blitzortung_lightning_azimuth'] ? parseFloat(states['sensor.blitzortung_lightning_azimuth'].state) : null;
                const impactCount = parseInt(entity.state) || 0;
                const timePhrase = states['sensor.dernier_impact_temps_reel'] ? states['sensor.dernier_impact_temps_reel'].state : '';

                let message = '';
                
                if (distRaw > 0) {
                  const distance = distRaw.toFixed(1);
                  message = `Impact Ã  <strong>${distance} Km</strong>`;
                  
                  let city = null;
                  if (localisation && localisation.attributes && localisation.attributes.features) {
                    const features = localisation.attributes.features;
                    if (features[0]?.properties?.geocoding?.city) {
                      city = features[0].properties.geocoding.city;
                      message += ` Ã  ${city}`;
                    }
                  }

                  if (!city && azimuth !== null) {
                    const directions = [
                      "au nord", "au nord-nord-est", "au nord-est", "Ã  l'est-nord-est", 
                      "Ã  l'est", "Ã  l'est-sud-est", "au sud-est", "au sud-sud-est", 
                      "au sud", "au sud-sud-ouest", "au sud-ouest", "Ã  l'ouest-sud-ouest", 
                      "Ã  l'ouest", "Ã  l'ouest-nord-ouest", "au nord-ouest", "au nord-nord-ouest"
                    ];
                    const index = Math.round(azimuth / 22.5) % 16;
                    message += ` ${directions[index]}`;
                  }
                } else {
                  message = "Aucun impact rÃ©cent dÃ©tectÃ©";
                }

                const impactLine = impactCount > 0 
                  ? `<br><span style="color: #ffeb3b; font-weight: bold; font-size: 17px;">âš¡ ${impactCount} impact(s) dÃ©tectÃ©(s)</span>` 
                  : '';

                return `
                  <div style="line-height: 1.6;">
                    <span style="font-size: 14px;">${message}</span><br>
                    <span style="font-size: 13px; opacity: 0.9; font-weight: 500;">${timePhrase}</span>
                    ${impactLine}
                  </div>
                `;
              ]]]
            show_state: false
            styles:
              card:
                - border-radius: 12px
                - padding: 15px
                - border-style: solid
                - border-width: 2px
                - background: |
                    [[[
                      const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                      if (d > 0 && d <= 5) return 'rgba(255, 0, 0, 0.2)';
                      if (d > 5) return 'rgba(255, 123, 0, 0.1)';
                      return 'rgba(0, 255, 0, 0.05)';
                    ]]]
                - border-color: |
                    [[[
                      const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                      if (d > 0 && d <= 5) return 'red';
                      if (d > 5) return 'rgba(255, 123, 0, 0.5)';
                      return 'rgba(0, 255, 0, 0.4)';
                    ]]]
                - animation: |
                    [[[
                      const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                      return (d > 0 && d <= 5) ? 'blink-danger 1s ease infinite' : 'none';
                    ]]]
              name:
                - justify-self: center
                - text-align: center
                - color: white
              icon:
                - width: 45px
                - color: |
                    [[[
                      const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                      if (d > 0 && d <= 5) return 'red';
                      if (d > 5) return 'rgb(255, 123, 0)';
                      return 'rgb(0, 255, 0)';
                    ]]]
            extra_styles: |
              @keyframes blink-danger {
                50% { background: rgba(255, 0, 0, 0.6); border-color: white; }
              }
            tap_action:
              action: navigate
              navigation_path: meteo/#foudre
            grid_options:
              columns: 12
              rows: 2.5
            visibility:
              - condition: numeric_state
                entity: sensor.blitzortung_lightning_counter
                above: 1
          - type: custom:bubble-card
            card_type: separator
            name: Personne(s)
            icon: mdi:account-group
            card_layout: normal
            rows: 1
            styles: |
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 0.8;
              }
              .bubble-sub-button {
                background-color: ${
                  hass.states['sensor.etat_wifi_maison'].state === '2'
                    ? 'darkgreen'
                    : (hass.states['sensor.etat_wifi_maison'].state === 'Eric' ||
                       hass.states['sensor.etat_wifi_maison'].state === 'Mamour')
                      ? 'darkorange'
                      : 'grey'
                } !important;
                color: gainsboro !important;
              }

              ha-card {
                margin-top: 20px !important;
              }
            sub_button:
              - entity: sensor.etat_wifi_maison
                show_last_changed: false
                show_state: true
                show_icon: true
                icon: mdi:home
                show_attribute: false
                show_name: true
                name: Maison
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: device_tracker.eric
            show_name: true
            show_last_changed: true
            show_attribute: false
            card_layout: normal
            layout_options:
              grid_columns: 2
              grid_rows: 1
            show_state: false
            sub_button:
              - entity: person.eric
                show_state: false
                show_icon: true
                show_background: true
                show_attribute: false
                attribute: entity_picture
            styles: |
              ha-card {
                --bubble-icon-background-color: black !important;
              }
              .bubble-sub-button {
                background-color: black !important;
              }

              .bubble-button-background {
                background-color:
                  ${ state === 'home'
                    ? 'green'
                    : state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : state === 'Boulot'
                      ? 'rgb(0,87,81)'
                      : 'grey'
                  } !important;
              }
              .bubble-icon,
              .bubble-sub-button > ha-icon {
                color:
                  ${ state === 'home'
                    ? 'darkgreen'
                    : state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : state === 'Boulot'
                        ? 'rgb(0,87,81)'
                        : 'grey'
                  } !important;
              }

              ${subButtonIcon[0].setAttribute("icon",
                state === 'home'
                  ? 'mdi:home'
                  : state === 'not_home'
                    ? 'mdi:home-off'
                    : state === 'Boulot'
                      ? 'mdi:hammer-screwdriver'
                      : 'mdi:crosshairs-question'
              )}
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: device_tracker.poco_x7_pro_mamour
            show_name: true
            show_last_changed: true
            show_attribute: false
            card_layout: normal
            layout_options:
              grid_columns: 2
              grid_rows: 1
            show_state: false
            sub_button:
              - entity: person.mamour
                show_state: false
                show_icon: true
                show_background: true
                show_attribute: false
                attribute: entity_picture
            styles: |
              ha-card {
                --bubble-icon-background-color: black !important;
              }
              .bubble-sub-button {
                background-color: black !important;
              }

              .bubble-button-background {
                background-color:
                  ${ state === 'home'
                    ? 'darkgreen'
                    : state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : state === 'LECLERC VENCE'
                        ? 'rgb(0, 102, 204)'
                        : state === 'Primark'
                        ? 'rgb(4,155,216)'
                        : 'grey'
                  } !important;
              }
              .bubble-icon,
              .bubble-sub-button > ha-icon {
                color:
                  ${ state === 'home'
                    ? 'darkgreen'
                    : state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : state === 'LECLERC VENCE'
                        ? 'rgb(0, 102, 204)'
                        : state === 'Primark'
                        ? 'rgb(4,155,216)'
                        : 'grey'
                  } !important;
              }

              ${subButtonIcon[0].setAttribute("icon",
                state === 'home'
                  ? 'mdi:home'
                  : state === 'not_home'
                    ? 'mdi:home-off'
                    : state === 'LECLERC VENCE'
                      ? 'mdi:basket-check'
                      : state === 'Primark'
                        ? 'mdi:hanger'
                        : 'mdi:crosshairs-question'
              )}
            name: Mamour
          - type: custom:mushroom-entity-card
            entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
            name: DÃ©tecteur de fuite sous Ã©vier cuisine
            fill_container: true
            primary_info: name
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: none
            grid_options:
              columns: 12
              rows: 2
            visibility:
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: 'on'
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: unavailable
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: unknown
            layout: vertical
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - square: false
            type: grid
            cards:
              - type: custom:button-card
                icon: mdi:weather-partly-cloudy
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/meteo
                name: MÃ©tÃ©o
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                  icon:
                    - transform: rotate(350deg)
                    - left: 20%
                    - top: 20%
                    - color: gold
                    - opacity: 1
                  name:
                    - color: white
                    - top: 12%
                    - left: 5%
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/temperatures
                entities:
                  - sensor.th_balcon_nord_temperature
                  - sensor.th_balcon_nord_humidity
                  - sensor.th_salon_temperature
                  - sensor.th_salon_humidity
                  - sensor.th_cellier_temperature
                  - sensor.th_cellier_humidity
                  - sensor.th_cuisine_temperature
                  - sensor.th_cuisine_humidity
                  - sensor.th_bureau_temperature
                  - sensor.th_bureau_humidity
                  - sensor.th_salle_de_bain_temperature
                  - sensor.th_salle_de_bain_humidity
                  - sensor.th_chambre_temperature
                  - sensor.th_chambre_humidity
                triggers_update:
                  - sensor.th_balcon_nord_temperature
                  - sensor.th_balcon_nord_humidity
                  - sensor.th_salon_temperature
                  - sensor.th_salon_humidity
                  - sensor.th_cellier_temperature
                  - sensor.th_cellier_humidity
                  - sensor.th_cuisine_temperature
                  - sensor.th_cuisine_humidity
                  - sensor.th_bureau_temperature
                  - sensor.th_bureau_humidity
                  - sensor.th_salle_de_bain_temperature
                  - sensor.th_salle_de_bain_humidity
                  - sensor.th_chambre_temperature
                  - sensor.th_chambre_humidity
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre titre"
                        "piece temp espace humidite"
                    - grid-template-columns: 1fr 1fr 0.5fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    temp:
                      - justify-self: center
                      - margin-left: 35px
                      - text-align: center
                    espace:
                      - justify-self: center
                      - margin-left: 0px
                      - text-align: center
                    humidite:
                      - justify-self: end
                      - margin-right: 6px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[ return 'Courbes TempÃ©rature' ]]]
                  piece: |
                    [[[
                      return '<span style="display: block; text-align: left; line-height: 1.2;">Balcon N.</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Salon</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Cellier</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Cuisine</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Bureau</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">SdB</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Chambre</span>';
                    ]]]
                  temp: |
                    [[[
                      function getTemperatureColor(temp) {
                        if (temp === 'NaN') return '#aaaaaa';
                        var t = parseFloat(temp);
                        if (t < 5) return '#3674B5';
                        if (t < 13) return '#578FCA';
                        if (t < 19) return '#A1E3F9';
                        if (t < 25) return 'lightgreen';
                        if (t < 32) return '#FFD700';
                        if (t < 36) return '#FFA500';
                        if (t < 40) return '#F44336';
                        return 'lightgreen';
                      }
                      
                      function formatTemp(entityId) {
                        var s = states[entityId]?.state;
                        var val = (s && s !== 'unknown' && s !== 'unavailable') ? parseFloat(s).toFixed(1) : 'NaN';
                        var color = getTemperatureColor(val);
                        var text = val === 'NaN' ? 'N/A' : val + 'Â°C';
                        return `<span style="display: block; text-align: center; line-height: 1.2; color: ${color};">${text}</span>`;
                      }

                      return formatTemp('sensor.th_balcon_nord_temperature') +
                             formatTemp('sensor.th_salon_temperature') +
                             formatTemp('sensor.th_cellier_temperature') +
                             formatTemp('sensor.th_cuisine_temperature') +
                             formatTemp('sensor.th_bureau_temperature') +
                             formatTemp('sensor.th_salle_de_bain_temperature') +
                             formatTemp('sensor.th_chambre_temperature');
                    ]]]
                  espace: |
                    [[[
                      return Array(7).fill('<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>').join('');
                    ]]]
                  humidite: |
                    [[[
                      function getHumidityColor(h) {
                        if (h === 'NaN') return '#aaaaaa';
                        var val = parseFloat(h);
                        if (val > 75) return '#F44336';
                        if (val > 55) return '#FFA500';
                        return 'white';
                      }
                      
                      function formatHum(entityId) {
                        var s = states[entityId]?.state;
                        var val = (s && s !== 'unknown' && s !== 'unavailable') ? parseFloat(s).toFixed(1) : 'NaN';
                        var color = getHumidityColor(val);
                        var text = val === 'NaN' ? 'N/A' : val + '%';
                        return `<span style="display: block; text-align: right; line-height: 1.2; color: ${color};">${text}</span>`;
                      }

                      return formatHum('sensor.th_balcon_nord_humidity') +
                             formatHum('sensor.th_salon_humidity') +
                             formatHum('sensor.th_cellier_humidity') +
                             formatHum('sensor.th_cuisine_humidity') +
                             formatHum('sensor.th_bureau_humidity') +
                             formatHum('sensor.th_salle_de_bain_humidity') +
                             formatHum('sensor.th_chambre_humidity');
                    ]]]
              - type: custom:button-card
                entities:
                  - sensor.temperature_moyenne_interieure
                  - sensor.delta_ademe_recommande
                  - sensor.mode_ete_hiver_etat
                  - sensor.clim_salon_etat
                  - sensor.radiateur_cuisine_etat
                  - sensor.clim_bureau_etat
                  - sensor.radiateur_sdb_etat
                  - sensor.clim_chambre_etat
                  - sensor.salon_power_status
                  - sensor.cuisine_power_status
                  - sensor.bureau_power_status
                  - sensor.sdb_soufflant_power_status
                  - sensor.chambre_power_status
                  - climate.clim_salon_rm4_mini
                  - climate.radiateur_cuisine
                  - climate.clim_bureau_rm4_mini
                  - climate.soufflant_salle_de_bain
                  - climate.clim_chambre_rm4_mini
                triggers_update:
                  - sensor.temperature_moyenne_interieure
                  - sensor.delta_ademe_recommande
                  - sensor.mode_ete_hiver_etat
                  - sensor.clim_salon_etat
                  - sensor.radiateur_cuisine_etat
                  - sensor.clim_bureau_etat
                  - sensor.radiateur_sdb_etat
                  - sensor.clim_chambre_etat
                  - sensor.salon_power_status
                  - sensor.cuisine_power_status
                  - sensor.bureau_power_status
                  - sensor.sdb_soufflant_power_status
                  - sensor.chambre_power_status
                  - climate.clim_salon_rm4_mini
                  - climate.radiateur_cuisine
                  - climate.clim_bureau_rm4_mini
                  - climate.soufflant_salle_de_bain
                  - climate.clim_chambre_rm4_mini
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/clim
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece mode consigne"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto auto auto
                    - margin-top: 3px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    mode:
                      - justify-self: start
                      - margin-left: 15px
                      - text-align: left
                    consigne:
                      - justify-self: end
                      - margin-right: 6px
                      - text-align: right
                custom_fields:
                  titre: Commande Clim.
                  piece: |
                    [[[
                      const colorMap = {
                        'Fan': '#00FF00',
                        'on': 'lightgreen',
                        'off': 'white',
                        'default': '#aaaaaa'
                      };

                      function safeState(entityId, defaultValue = 'on') {
                        return states[entityId]?.state || defaultValue;
                      }

                      function getColorForPowerStatus(powerStatus, mode) {
                        if (mode === 'Fan') return colorMap['Fan'];
                        if (powerStatus === 'on') return colorMap['on'];
                        if (powerStatus === 'off') return colorMap['off'];
                        return colorMap['default'];
                      }

                      const pieces = [
                        { name: 'TÌ„ Appart. --------------', color: 'white' },
                        { name: 'Î” Ademe --------------', color: 'white' },
                        { name: 'Mode ->', color: 'white' },
                        { name: 'Salon', power: safeState('sensor.salon_power_status'), mode: safeState('sensor.clim_salon_etat') },
                        { name: 'Cuisine', power: safeState('sensor.cuisine_power_status'), mode: safeState('sensor.radiateur_cuisine_etat') },
                        { name: 'Bureau', power: safeState('sensor.bureau_power_status'), mode: safeState('sensor.clim_bureau_etat') },
                        { name: 'SdB', power: safeState('sensor.sdb_soufflant_power_status'), mode: safeState('sensor.sdb_soufflant_etat') },
                        { name: 'Chambre', power: safeState('sensor.chambre_power_status'), mode: safeState('sensor.clim_chambre_etat') }
                      ];

                      return pieces.map(piece =>
                        `<span style="display: block; text-align: left; line-height: 1.2; color: ${piece.color || getColorForPowerStatus(piece.power, piece.mode)};">${piece.name}</span>`
                      ).join('');
                    ]]]
                  mode: |
                    [[[
                      const colorMap = {
                        'cool': 'skyblue',
                        'heat': '#FFA500',
                        'fan': 'turquoise',
                        'off': '#F44336',
                        'N/A': '#aaaaaa', 
                        'default': '#aaaaaa'
                      };

                      function safeState(entityId, defaultValue = 'off') {
                        const state = states[entityId]?.state?.trim()?.toLowerCase() || defaultValue;
                        if (state === 'unknown' || state === 'unavailable') return 'N/A';
                        return state === 'fan_only' ? 'fan' : state;
                      }

                      function getColorForMode(mode) {
                        return colorMap[mode] || colorMap['default'];
                      }

                      function formatMode(mode) {
                        const color = getColorForMode(mode);
                        const formattedMode = mode.charAt(0).toUpperCase() + mode.slice(1);
                        return `<span style="display: block; text-align: left; line-height: 1.2; color: ${color};">${formattedMode}</span>`;
                      }

                      const modes = [
                        { entity: 'sensor.mode_ete_hiver_etat', label: '.' },
                        { entity: 'sensor.clim_salon_etat', label: 'Salon' },
                        { entity: 'sensor.radiateur_cuisine_etat', label: 'Cuisine' },
                        { entity: 'sensor.clim_bureau_etat', label: 'Bureau' },
                        { entity: 'sensor.sdb_soufflant_etat', label: 'SdB' },
                        { entity: 'sensor.clim_chambre_etat', label: 'Chambre' }
                      ];

                      return [
                        '<span style="display: block; text-align: left; line-height: 1.2; color: transparent;">.</span>',
                        '<span style="display: block; text-align: left; line-height: 1.2; color: transparent;">.</span>',
                        ...modes.map(mode => formatMode(safeState(mode.entity)))
                      ].join('');
                    ]]]
                  consigne: |
                    [[[
                      function safeState(entityId, attribute = 'temperature') {
                        const entity = states[entityId];
                        if (!entity) return 'N/A';
                        if (entity.state && !isNaN(parseFloat(entity.state))) {
                          return parseFloat(entity.state).toFixed(1);
                        }
                        if (entity.attributes && entity.attributes[attribute] !== undefined) {
                          return parseFloat(entity.attributes[attribute]).toFixed(1);
                        }
                        return 'N/A';
                      }

                      // Fonction pour gÃ©rer la couleur (Gris si N/A) et le formatage
                      function formatDisplay(value) {
                        const color = value === 'N/A' ? '#aaaaaa' : 'inherit';
                        const text = value === 'N/A' ? 'N/A' : value + 'Â°C';
                        return `<span style="display: block; text-align: right; line-height: 1.2; color: ${color};">${text}</span>`;
                      }

                      // --- LOGIQUE DELTA ADEME RÃ‰UTILISÃ‰E ET FORMATÃ‰E ---
                      const deltaADEME = parseFloat(states['sensor.delta_ademe_recommande']?.state);
                      const isCooling = states['sensor.mode_ete_hiver']?.state === 'cool';

                      const deltaColor = 
                        !isNaN(deltaADEME) && isCooling && deltaADEME >= -8 && deltaADEME <= -4 
                          ? 'lightgreen' // Optimal
                          : !isNaN(deltaADEME) && isCooling
                            ? '#FF0000' // Avertissement
                            : 'white'; // Neutre
                            
                      const ademeDisplayValue = !isNaN(deltaADEME) 
                        ? `${deltaADEME.toFixed(1)}Â°C` 
                        : 'N/A';
                      // -----------------------------------------------------------

                      const tempMoyenne = safeState('sensor.temperature_moyenne_interieure');
                      const consigneSalon = safeState('climate.clim_salon_rm4_mini');
                      const consigneCuisine = safeState('climate.radiateur_cuisine');
                      const consigneBureau = safeState('climate.clim_bureau_rm4_mini');
                      const consigneSdB = safeState('climate.soufflant_salle_de_bain');
                      const consigneChambre = safeState('climate.clim_chambre_rm4_mini');

                      return [
                        `<span style="display: block; text-align: right; line-height: 1.2; color: lightgreen;">${tempMoyenne}Â°C</span>`,
                        `<span style="display: block; text-align: right; line-height: 1.2; color: ${deltaColor};">${ademeDisplayValue}</span>`,
                        '<span style="display: block; text-align: right; line-height: 1.2;">.</span>',
                        formatDisplay(consigneSalon),
                        formatDisplay(consigneCuisine),
                        formatDisplay(consigneBureau),
                        formatDisplay(consigneSdB),
                        formatDisplay(consigneChambre)
                      ].join('');
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie
                entities:
                  - sensor.conso_mini
                  - sensor.ecojoko_consommation_temps_reel
                  - sensor.conso_maxi
                  - sensor.ecojoko_consommation_hp_reseau
                  - sensor.ecojoko_consommation_hc_reseau
                  - sensor.tarif_heures_pleines_ttc
                  - sensor.tarif_heures_creuses_ttc
                triggers_update:
                  - sensor.conso_mini
                  - sensor.ecojoko_consommation_temps_reel
                  - sensor.conso_maxi
                  - sensor.ecojoko_consommation_hp_reseau
                  - sensor.ecojoko_consommation_hc_reseau
                  - sensor.tarif_heures_pleines_ttc
                  - sensor.tarif_heures_creuses_ttc
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre_1 titre_1 titre_1"
                        "mini realtime maxi"
                        "titre_2 titre_2 titre_2"
                        "toto hp hc"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto auto auto auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre_1:
                      - grid-area: titre_1
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    mini:
                      - grid-area: mini
                      - text-align: center
                    realtime:
                      - grid-area: realtime
                      - text-align: center
                    maxi:
                      - grid-area: maxi
                      - text-align: center
                    titre_2:
                      - grid-area: titre_2
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    toto:
                      - grid-area: toto
                      - margin-right: 7px
                      - font-weight: bold
                    hc:
                      - grid-area: hc
                      - margin-right: 7px
                      - font-weight: bold
                    hp:
                      - grid-area: hp
                      - margin-right: 7px
                      - font-weight: bold
                custom_fields:
                  titre_1: >
                    [[[ return 'Home Consumption<br><br>Mini -- Realtime --
                    Maxi'; ]]]
                  mini: |
                    [[[
                      const value = parseFloat(states['sensor.conso_mini']?.state || 0);
                      let color = 'white';
                      if (value > 75) { color = 'rgb(244,67,54)'; }
                      else if (value > 50) { color = '#FFA500'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  realtime: |
                    [[[
                      const value = parseFloat(states['sensor.ecojoko_consommation_temps_reel']?.state || 0);
                      let color = 'white';
                      if (value > 4000) { color = 'rgb(244,67,54)'; }
                      else if (value > 2000) { color = '#FFA500'; }
                      else if (value > 1000) { color = 'lightgreen'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  maxi: |
                    [[[
                      const value = parseFloat(states['sensor.conso_maxi']?.state || 0);
                      let color = 'white';
                      if (value > 4000) { color = 'rgb(244,67,54)'; }
                      else if (value > 2000) { color = '#FFA500'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  titre_2: >
                    [[[ return '__________________________<br><br>CoÃ»ts Total =
                    H.P. + H.C.'; ]]]
                  toto: |
                    [[[
                      const hp = parseFloat(states['sensor.ecojoko_consommation_hp_reseau']?.state || 0);
                      const hc = parseFloat(states['sensor.ecojoko_consommation_hc_reseau']?.state || 0);
                      const tarif_hp = parseFloat(states['sensor.tarif_heures_pleines_ttc']?.state || 0);
                      const tarif_hc = parseFloat(states['sensor.tarif_heures_creuses_ttc']?.state || 0);
                      const total = (hp * tarif_hp) + (hc * tarif_hc);
                      return `<span style="display:block; text-align:right; line-height:1.2; color:lightgreen;">
                        ${total.toFixed(2)}<span style="font-size:9px;"> â‚¬</span>
                      </span>`;
                    ]]]
                  hc: |
                    [[[
                      const hc_value = parseFloat(states['sensor.ecojoko_consommation_hc_reseau']?.state || 0);
                      const tarif_hc = parseFloat(states['sensor.tarif_heures_creuses_ttc']?.state || 0);
                      const hc_total = hc_value * tarif_hc;
                      return `<span style="display:block; text-align:right; line-height:1.2;">
                        ${hc_total.toFixed(2)}<span style="font-size:9px;"> â‚¬</span>
                      </span>`;
                    ]]]
                  hp: |
                    [[[
                      const hp_value = parseFloat(states['sensor.ecojoko_consommation_hp_reseau']?.state || 0);
                      const tarif_hp = parseFloat(states['sensor.tarif_heures_pleines_ttc']?.state || 0);
                      const hp_total = hp_value * tarif_hp;
                      return `<span style="display:block; text-align:right; line-height:1.2;">
                        ${hp_total.toFixed(2)}<span style="font-size:9px;"> â‚¬</span>
                      </span>`;
                    ]]]
              - type: custom:button-card
                entities:
                  - climate.clim_salon_rm4_mini
                  - climate.radiateur_cuisine
                  - climate.clim_bureau_rm4_mini
                  - climate.soufflant_salle_de_bain
                  - climate.clim_chambre_rm4_mini
                  - sensor.salon_power_status
                  - sensor.cuisine_power_status
                  - sensor.bureau_power_status
                  - sensor.sdb_soufflant_etat
                  - sensor.sdb_seche_serviette_etat
                  - sensor.chambre_power_status
                  - sensor.clim_salon_quotidien
                  - sensor.radiateur_elec_cuisine_quotidien
                  - sensor.clim_bureau_quotidien
                  - sensor.soufflant_sdb_quotidien
                  - sensor.seche_serviette_sdb_quotidien
                  - sensor.clim_chambre_quotidien
                  - sensor.conso_clim_rad_total_quotidien
                  - sensor.clim_salon_mensuel
                  - sensor.radiateur_elec_cuisine_mensuel
                  - sensor.clim_bureau_mensuel
                  - sensor.soufflant_sdb_mensuel
                  - sensor.seche_serviette_sdb_mensuel
                  - sensor.clim_chambre_mensuel
                  - sensor.conso_clim_rad_total_mensuel
                triggers_update:
                  - climate.clim_salon_rm4_mini
                  - climate.radiateur_cuisine
                  - climate.clim_bureau_rm4_mini
                  - climate.soufflant_salle_de_bain
                  - climate.clim_chambre_rm4_mini
                  - sensor.salon_power_status
                  - sensor.cuisine_power_status
                  - sensor.bureau_power_status
                  - sensor.sdb_soufflant_etat
                  - sensor.sdb_seche_serviette_etat
                  - sensor.chambre_power_status
                  - sensor.clim_salon_quotidien
                  - sensor.radiateur_elec_cuisine_quotidien
                  - sensor.clim_bureau_quotidien
                  - sensor.soufflant_sdb_quotidien
                  - sensor.seche_serviette_sdb_quotidien
                  - sensor.clim_chambre_quotidien
                  - sensor.conso_clim_rad_total_quotidien
                  - sensor.clim_salon_mensuel
                  - sensor.radiateur_elec_cuisine_mensuel
                  - sensor.clim_bureau_mensuel
                  - sensor.soufflant_sdb_mensuel
                  - sensor.seche_serviette_sdb_mensuel
                  - sensor.clim_chambre_mensuel
                  - sensor.conso_clim_rad_total_mensuel
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie-clim
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece quotidien mensuel"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    quotidien:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    mensuel:
                      - justify-self: end
                      - margin-right: 5px
                      - text-align: right
                custom_fields:
                  titre: Consommation CLIM
                  piece: |
                    [[[
                      const colorMap = {
                        'off_off': 'rgb(244,67,54)',
                        'on_cool': 'skyblue',
                        'on_heat': '#FFA500',
                        'on_fan': 'turquoise',
                        'off': 'white',
                        'on_off': '#aaaaaa'
                      };

                      function getColorForStatus(powerStatus, mode) {
                        if (powerStatus === 'off') {
                          return mode === 'off' ? colorMap['off_off'] : colorMap['off'];
                        } else {
                          return colorMap[`on_${mode}`] || colorMap['off'];
                        }
                      }

                      function safeState(entityId) {
                        return states[entityId]?.state?.toLowerCase() || 'off';
                      }

                      const pieces = [
                        { name: 'Salon', power: safeState('sensor.salon_power_status'), mode: safeState('sensor.clim_salon_etat') },
                        { name: 'Cuisine', power: safeState('sensor.cuisine_power_status'), mode: safeState('sensor.radiateur_cuisine_etat') },
                        { name: 'Bureau', power: safeState('sensor.bureau_power_status'), mode: safeState('sensor.clim_bureau_etat') },
                        { name: 'SdB Sft', power: safeState('sensor.sdb_soufflant_power_status'), mode: safeState('sensor.sdb_soufflant_etat') },
                        { name: 'SdB SÃ¨S', power: safeState('sensor.sdb_seche_serviette_power_status'), mode: safeState('sensor.sdb_seche_serviette_etat') },
                        { name: 'Chambre', power: safeState('sensor.chambre_power_status'), mode: safeState('sensor.clim_chambre_etat') },
                        { name: 'TOTAL', color: 'lightgreen', bold: true }
                      ];

                      return pieces.map(piece =>
                        `<span style="display: block; text-align: left; line-height: 1.2; color: ${piece.color || getColorForStatus(piece.power, piece.mode)}; ${piece.bold ? 'font-weight: bold;' : ''}">${piece.name}</span>`
                      ).join('');
                    ]]]
                  quotidien: |
                    [[[
                      const list = [
                        'sensor.clim_salon_quotidien',
                        'sensor.radiateur_elec_cuisine_quotidien',
                        'sensor.clim_bureau_quotidien',
                        'sensor.soufflant_sdb_quotidien',
                        'sensor.seche_serviette_sdb_quotidien',
                        'sensor.clim_chambre_quotidien',
                        'sensor.conso_clim_rad_total_quotidien'
                      ];

                      return list.map((sensor, i) => {
                        const s = states[sensor]?.state;
                        const val = parseFloat(s);
                        const isTotal = i === list.length - 1;

                        if (s === 'unavailable' || s === 'unknown' || isNaN(val)) {
                          let style = isTotal ? 'color: #aaaaaa; font-weight: bold;' : 'color: #aaaaaa;';
                          return `<span style="display: block; text-align: right; line-height: 1.2; ${style}">N/A</span>`;
                        }

                        let unit = val < 1 ? 'Wh' : 'kWh';
                        let displayVal = val < 1 ? (val * 1000).toFixed(0) : val.toFixed(2);
                        let style = isTotal ? 'color: lightgreen; font-weight: bold;' : '';
                        return `<span style="display: block; text-align: right; line-height: 1.2; ${style}">${displayVal} <span style="font-size: 5px;">${unit}</span></span>`;
                      }).join('');
                    ]]]
                  mensuel: |
                    [[[
                      const list = [
                        'sensor.clim_salon_mensuel',
                        'sensor.radiateur_elec_cuisine_mensuel',
                        'sensor.clim_bureau_mensuel',
                        'sensor.soufflant_sdb_mensuel',
                        'sensor.seche_serviette_sdb_mensuel',
                        'sensor.clim_chambre_mensuel',
                        'sensor.conso_clim_rad_total_mensuel'
                      ];

                      return list.map((sensor, i) => {
                        const s = states[sensor]?.state;
                        const val = parseFloat(s);
                        const isTotal = i === list.length - 1;

                        if (s === 'unavailable' || s === 'unknown' || isNaN(val)) {
                          let style = isTotal ? 'color: #aaaaaa; font-weight: bold;' : 'color: #aaaaaa;';
                          return `<span style="display: block; text-align: right; line-height: 1.2; ${style}">N/A</span>`;
                        }

                        let unit = val < 1 ? 'Wh' : 'kWh';
                        let displayVal = val < 1 ? (val * 1000).toFixed(0) : val.toFixed(2);
                        let style = isTotal ? 'color: lightgreen; font-weight: bold;' : '';
                        return `<span style="display: block; text-align: right; line-height: 1.2; ${style}">${displayVal} <span style="font-size: 5px;">${unit}</span></span>`;
                      }).join('');
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie-lampes
                entities:
                  - sensor.lumiere_appartement_etat
                  - sensor.lumiere_salon_etat
                  - sensor.lumiere_cuisine_etat
                  - sensor.lumiere_bureau_etat
                  - sensor.lumiere_salle_de_bain_etat
                  - sensor.lumiere_chambre_etat
                  - sensor.eclairage_appart_2_quotidien_kwh_um
                  - sensor.eclairage_salon_5_quotidien_kwh_um
                  - sensor.eclairage_cuisine_1_quotidien_kwh_um
                  - sensor.eclairage_bureau_5_quotidien_kwh_um
                  - sensor.eclairage_sdb_2_quotidien_kwh_um
                  - sensor.eclairage_chambre_4_quotidien_kwh_um
                  - sensor.eclairage_total_unit_quotidien_kwh_um
                  - sensor.eclairage_appart_2_mensuel_kwh_um
                  - sensor.eclairage_salon_5_mensuel_kwh_um
                  - sensor.eclairage_cuisine_1_mensuel_kwh_um
                  - sensor.eclairage_bureau_5_mensuel_kwh_um
                  - sensor.eclairage_sdb_2_mensuel_kwh_um
                  - sensor.eclairage_chambre_4_mensuel_kwh_um
                  - sensor.eclairage_total_unit_mensuel_kwh_um
                triggers_update:
                  - sensor.lumiere_appartement_etat
                  - sensor.lumiere_salon_etat
                  - sensor.lumiere_cuisine_etat
                  - sensor.lumiere_bureau_etat
                  - sensor.lumiere_salle_de_bain_etat
                  - sensor.lumiere_chambre_etat
                  - sensor.eclairage_appart_2_quotidien_kwh_um
                  - sensor.eclairage_salon_5_quotidien_kwh_um
                  - sensor.eclairage_cuisine_1_quotidien_kwh_um
                  - sensor.eclairage_bureau_5_quotidien_kwh_um
                  - sensor.eclairage_sdb_2_quotidien_kwh_um
                  - sensor.eclairage_chambre_4_quotidien_kwh_um
                  - sensor.eclairage_total_unit_quotidien_kwh_um
                  - sensor.eclairage_appart_2_mensuel_kwh_um
                  - sensor.eclairage_salon_5_mensuel_kwh_um
                  - sensor.eclairage_cuisine_1_mensuel_kwh_um
                  - sensor.eclairage_bureau_5_mensuel_kwh_um
                  - sensor.eclairage_sdb_2_mensuel_kwh_um
                  - sensor.eclairage_chambre_4_mensuel_kwh_um
                  - sensor.eclairage_total_unit_mensuel_kwh_um
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece quotidien mensuel"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    quotidien:
                      - justify-self: start
                      - margin-left: 15px
                      - text-align: left
                    mensuel:
                      - justify-self: end
                      - margin-right: 6px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[ return 'Consommation LAMPES' ]]]
                  piece: |
                    [[[
                      function getCol(entityId, isEcoSensitive = false) {
                        const s = states[entityId]?.state;
                        if (!s || s === 'Ã‰teint') return 'white';
                        if (isEcoSensitive && s === 'Ã‰co.') return 'white';
                        return 'lightgreen';
                      }

                      const pieces = [
                        { name: 'Appart.', color: getCol('sensor.lumiere_appartement_etat') },
                        { name: 'Salon', color: getCol('sensor.lumiere_salon_etat') },
                        { name: 'Cuisine', color: getCol('sensor.lumiere_cuisine_etat') },
                        { name: 'Bureau', color: getCol('sensor.lumiere_bureau_etat', true) },
                        { name: 'SdB', color: getCol('sensor.lumiere_salle_de_bain_etat') },
                        { name: 'Chambre', color: getCol('sensor.lumiere_chambre_etat', true) },
                        { name: 'TOTAL', color: 'lightgreen', bold: true }
                      ];

                      return pieces.map(p => 
                        `<span style="display: block; text-align: left; line-height: 1.2; color: ${p.color}; ${p.bold ? 'font-weight: bold;' : ''}">${p.name}</span>`
                      ).join('');
                    ]]]
                  quotidien: |
                    [[[
                      function safeState(entityId) {
                        const entity = states[entityId];
                        if (!entity || ['unavailable', 'unknown'].includes(entity.state)) return '<span style="color: #aaaaaa;">N/A</span>';
                        var val = parseFloat(entity.state);
                        if (isNaN(val)) return '<span style="color: #aaaaaa;">N/A</span>';
                        
                        if (val < 1) return (val * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        return val.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                      }

                      const sensors = [
                        'sensor.eclairage_appart_2_quotidien_kwh_um',
                        'sensor.eclairage_salon_5_quotidien_kwh_um',
                        'sensor.eclairage_cuisine_1_quotidien_kwh_um',
                        'sensor.eclairage_bureau_5_quotidien_kwh_um',
                        'sensor.eclairage_sdb_2_quotidien_kwh_um',
                        'sensor.eclairage_chambre_4_quotidien_kwh_um',
                        'sensor.eclairage_total_unit_quotidien_kwh_um'
                      ];

                      return sensors.map((s, i) => {
                        const isLast = i === sensors.length - 1;
                        return `<span style="display: block; text-align: right; line-height: 1.2; ${isLast ? 'color: lightgreen; font-weight: bold;' : ''}">${safeState(s)}</span>`;
                      }).join('');
                    ]]]
                  mensuel: |
                    [[[
                      function safeState(entityId) {
                        const entity = states[entityId];
                        if (!entity || ['unavailable', 'unknown'].includes(entity.state)) return '<span style="color: #aaaaaa;">N/A</span>';
                        var val = parseFloat(entity.state);
                        if (isNaN(val)) return '<span style="color: #aaaaaa;">N/A</span>';
                        
                        if (val < 1) return (val * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        return val.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                      }

                      const sensors = [
                        'sensor.eclairage_appart_2_mensuel_kwh_um',
                        'sensor.eclairage_salon_5_mensuel_kwh_um',
                        'sensor.eclairage_cuisine_1_mensuel_kwh_um',
                        'sensor.eclairage_bureau_5_mensuel_kwh_um',
                        'sensor.eclairage_sdb_2_mensuel_kwh_um',
                        'sensor.eclairage_chambre_4_mensuel_kwh_um',
                        'sensor.eclairage_total_unit_mensuel_kwh_um'
                      ];

                      return sensors.map((s, i) => {
                        const isLast = i === sensors.length - 1;
                        return `<span style="display: block; text-align: right; line-height: 1.2; ${isLast ? 'color: lightgreen; font-weight: bold;' : ''}">${safeState(s)}</span>`;
                      }).join('');
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/lumieres
                entities:
                  - sensor.lumiere_appartement_etat
                  - sensor.lumiere_salon_etat
                  - sensor.lumiere_cuisine_etat
                  - sensor.bureau_etat
                  - sensor.lumiere_salle_de_bain_etat
                  - sensor.chambre_etat
                  - sensor.lumiere_ecran_etat
                  - light.entree
                  - light.couloir
                  - light.salon
                  - light.table
                  - light.cuisine
                  - light.lampe_salle_de_bain_hue
                  - light.chambre
                  - light.hue_color_candle_chambre_gege
                  - light.hue_color_candle_chambre_eric
                  - switch.prise_tete_de_lit_chambre
                triggers_update:
                  - sensor.lumiere_appartement_etat
                  - sensor.lumiere_salon_etat
                  - sensor.lumiere_cuisine_etat
                  - sensor.bureau_etat
                  - sensor.lumiere_salle_de_bain_etat
                  - sensor.chambre_etat
                  - sensor.lumiere_ecran_etat
                  - light.entree
                  - light.couloir
                  - light.salon
                  - light.table
                  - light.cuisine
                  - light.lampe_salle_de_bain_hue
                  - light.chambre
                  - light.hue_color_candle_chambre_gege
                  - light.hue_color_candle_chambre_eric
                  - switch.prise_tete_de_lit_chambre
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece etat active"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    etat:
                      - grid-area: etat
                      - justify-self: end
                      - text-align: start
                      - margin-right: '-11px'
                    active:
                      - grid-area: active
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[ return 'Commande LAMPES' ]]]
                  piece: >
                    [[[ return
                    `<div><div>Appart.</div><div>Salon</div><div>Cuisine</div><div>Bureau</div><div>SdB</div><div>Chambre</div></div>`;
                    ]]]
                  etat: |
                    [[[
                      function getColorForStatus(status) {
                        if (status === 'N/A' || status === 'erreur') return '#aaaaaa';
                        if (status === 'AllumÃ©') return 'lightgreen';
                        if (status === 'Ã‰teint') return 'rgb(244,67,54)';
                        if (status === 'AlluSync' || status === 'Synchro' || status === 'Ã‰co.') return '#FFA500';

                        const greenStates = [
                          'EntrÃ©e', 'Couloir', 'Salon', 'Table', 'Bureau', 
                          'Ã‰cran', 'Chambre', 'Zone G.', 'Zone Ã‰.', 
                          'TÃªte Lit', 'Ch.+zG', 'Ch.+zÃ‰'
                        ];
                        if (greenStates.includes(status)) return 'lightgreen';
                        return 'white';
                      }

                      function safeState(entityId) {
                        const state = states[entityId]?.state;
                        return (!state || state === 'unavailable' || state === 'unknown') ? 'N/A' : state;
                      }

                      var appStat = safeState('sensor.lumiere_appartement_etat');
                      var salStat = safeState('sensor.lumiere_salon_etat');
                      var cuiStat = safeState('sensor.lumiere_cuisine_etat');
                      var burStat = safeState('sensor.bureau_etat');
                      var sdbStat = safeState('sensor.lumiere_salle_de_bain_etat');
                      var chaStat = safeState('sensor.chambre_etat');

                      return `<div>
                        <div style="color: ${getColorForStatus(appStat)};">${appStat}</div>
                        <div style="color: ${getColorForStatus(salStat)};">${salStat}</div>
                        <div style="color: ${getColorForStatus(cuiStat)};">${cuiStat}</div>
                        <div style="color: ${getColorForStatus(burStat)};">${burStat}</div>
                        <div style="color: ${getColorForStatus(sdbStat)};">${sdbStat}</div>
                        <div style="color: ${getColorForStatus(chaStat)};">${chaStat}</div>
                      </div>`;
                    ]]]
                  active: |
                    [[[
                      function countActiveEntities(entities) {
                        return entities.filter(entity => states[entity]?.state === 'on').length;
                      }
                      function getColorForCount(activeCount, totalCount) {
                        if (activeCount === totalCount && totalCount > 0) return 'lightgreen';
                        if (activeCount === 0) return 'rgb(244,67,54)';
                        return '#FFA500';
                      }

                      var appartement = { activeCount: countActiveEntities(['light.entree', 'light.couloir']), totalCount: 2 };
                      var salon = { activeCount: countActiveEntities(['light.salon', 'light.table']), totalCount: 2 };
                      var cuisine = { activeCount: countActiveEntities(['light.cuisine']), totalCount: 1 };
                      
                      var statusB = states['sensor.bureau_etat']?.state;
                      var ecranS = states['sensor.lumiere_ecran_etat']?.state;
                      var bTxt = "0/2";
                      var bCol = "rgb(244,67,54)";

                      if (statusB === 'AlluSync') { bTxt = "2/2"; bCol = "#FFA500"; }
                      else if (statusB === 'Synchro') { bTxt = "1/2"; bCol = "#FFA500"; }
                      else if (statusB === 'AllumÃ©') { bTxt = "2/2"; bCol = "lightgreen"; }
                      else if (statusB === 'Bureau') { 
                        if (ecranS === 'Ã‰co.') { bTxt = "1/1"; bCol = "lightgreen"; }
                        else { bTxt = "1/2"; bCol = "#FFA500"; }
                      }
                      else if (statusB === 'Ã‰cran') { bTxt = "1/2"; bCol = "#FFA500"; }
                      else if (statusB === 'Ã‰co.') { bTxt = "0/1"; bCol = "#FFA500"; }
                      else { bTxt = "0/2"; bCol = "rgb(244,67,54)"; }

                      var sdbActive = states['light.lampe_salle_de_bain_hue']?.state === 'on' ? 1 : 0;
                      
                      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      // CHAMBRE : Gestion du cas "Ã‰co." avec 0/1 en orange
                      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      var statusCh = states['sensor.chambre_etat']?.state;
                      var chEnt = ['light.chambre'];
                      
                      // Si la prise tÃªte de lit est allumÃ©e, ajouter les 2 bougies
                      if (states['switch.prise_tete_de_lit_chambre']?.state === 'on') { 
                        chEnt.push('light.hue_color_candle_chambre_gege', 'light.hue_color_candle_chambre_eric'); 
                      }
                      
                      var chActive = countActiveEntities(chEnt);
                      var chTxt = `${chActive}/${chEnt.length}`;
                      var chCol = getColorForCount(chActive, chEnt.length);
                      
                      // CAS SPÃ‰CIAL : Si l'Ã©tat de la chambre est "Ã‰co." et 0/1, forcer la couleur orange
                      if (statusCh === 'Ã‰co.' && chActive === 0 && chEnt.length === 1) {
                        chCol = '#FFA500';
                      }

                      return `<div>
                        <div style="color: ${getColorForCount(appartement.activeCount, 2)};">${appartement.activeCount}/2</div>
                        <div style="color: ${getColorForCount(salon.activeCount, 2)};">${salon.activeCount}/2</div>
                        <div style="color: ${getColorForCount(cuisine.activeCount, 1)};">${cuisine.activeCount}/1</div>
                        <div style="color: ${bCol};">${bTxt}</div>
                        <div style="color: ${getColorForCount(sdbActive, 1)};">${sdbActive}/1</div>
                        <div style="color: ${chCol};">${chTxt}</div>
                      </div>`;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/prises
                entities:
                  - switch.prise_horloge_ikea
                  - switch.hue_smart_eco_pc_bureau
                  - switch.prise_tete_de_lit_chambre
                  - light.hue_smart_salon
                  - light.hue_smart_tv_salon
                  - light.hue_smart_tv_chambre
                triggers_update:
                  - switch.prise_horloge_ikea
                  - switch.hue_smart_eco_pc_bureau
                  - switch.prise_tete_de_lit_chambre
                  - light.hue_smart_salon
                  - light.hue_smart_tv_salon
                  - light.hue_smart_tv_chambre
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre"
                        "piece etat"
                    - grid-template-columns: 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    etat:
                      - grid-area: etat
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                custom_fields:
                  titre: |
                    [[[ return 'Commande Ã©CO.' ]]]
                  piece: |
                    [[[
                      return `
                      <div>
                        <div>Horloge</div>
                        <div>Salon</div>
                        <div>TV Salon</div>
                        <div>PC Bureau</div>
                        <div>TV Chambre</div>
                        <div>TÃªte de Lit</div>
                      </div>
                      `;
                    ]]]
                  etat: |
                    [[[
                      function safeState(entityId) {
                        const entity = states[entityId];
                        if (!entity || entity.state === 'unavailable' || entity.state === 'unknown') {
                          return 'N/A';
                        }
                        return entity.state;
                      }

                      function getColorForStatus(status) {
                        if (status === 'N/A') return '#aaaaaa';
                        return status === 'on' ? 'lightgreen' : 'rgb(244,67,54)';
                      }

                      function getStatusText(status) {
                        if (status === 'N/A') return 'N/A';
                        return status === 'on' ? 'AllumÃ©' : 'Ã‰teint';
                      }

                      const hStat = safeState('switch.prise_horloge_ikea');
                      const sStat = safeState('light.hue_smart_salon');
                      const tsStat = safeState('light.hue_smart_tv_salon');
                      const pStat = safeState('switch.hue_smart_eco_pc_bureau');
                      const tcStat = safeState('light.hue_smart_tv_chambre');
                      const tlStat = safeState('switch.prise_tete_de_lit_chambre');

                      return `
                      <div>
                        <div style="color: ${getColorForStatus(hStat)};">${getStatusText(hStat)}</div>
                        <div style="color: ${getColorForStatus(sStat)};">${getStatusText(sStat)}</div>
                        <div style="color: ${getColorForStatus(tsStat)};">${getStatusText(tsStat)}</div>
                        <div style="color: ${getColorForStatus(pStat)};">${getStatusText(pStat)}</div>
                        <div style="color: ${getColorForStatus(tcStat)};">${getStatusText(tcStat)}</div>
                        <div style="color: ${getColorForStatus(tlStat)};">${getStatusText(tlStat)}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/stores
                entities:
                  - binary_sensor.contact_fenetre_salon_sonoff_contact
                  - binary_sensor.contact_fenetre_cuisine_sonoff_contact
                  - binary_sensor.contact_fenetre_bureau_sonoff_contact
                  - binary_sensor.contact_fenetre_chambre_sonoff_contact
                  - sensor.store_salon_status
                  - sensor.store_bureau_status
                triggers_update:
                  - binary_sensor.contact_fenetre_salon_sonoff_contact
                  - binary_sensor.contact_fenetre_cuisine_sonoff_contact
                  - binary_sensor.contact_fenetre_bureau_sonoff_contact
                  - binary_sensor.contact_fenetre_chambre_sonoff_contact
                  - sensor.store_salon_status
                  - sensor.store_bureau_status
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "espace espace espace"
                        "piece fenetres stores"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto 14px auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace:
                      - grid-area: espace
                      - height: 10px
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    fenetres:
                      - grid-area: fenetres
                      - justify-self: end
                      - text-align: center
                    stores:
                      - grid-area: stores
                      - justify-self: end
                      - margin-right: 7px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Commande Stores<BR>PiÃ¨ces / FenÃªtres / Stores';
                    ]]]
                  espace: |
                    [[[ return ' '; ]]]
                  piece: |
                    [[[
                      return `
                      <div>
                        <div>Salon</div>
                        <div>Cuisine</div>
                        <div>Bureau</div>
                        <div>Chambre</div>
                      </div>
                      `;
                    ]]]
                  fenetres: |
                    [[[
                      function getColorForFenetreStatus(entityId) {
                        const state = states[entityId]?.state;
                        if (state === 'on') return '<span style="color: rgb(244,67,54);">Ouvert</span>';
                        if (state === 'off') return '<span style="color: lightgreen;">FermÃ©</span>';
                        return '<span style="color: #aaaaaa;">N/A</span>';
                      }

                      var salon = getColorForFenetreStatus('binary_sensor.contact_fenetre_salon_sonoff_contact');
                      var cuisine = getColorForFenetreStatus('binary_sensor.contact_fenetre_cuisine_sonoff_contact');
                      var bureau = getColorForFenetreStatus('binary_sensor.contact_fenetre_bureau_sonoff_contact');
                      var chambre = getColorForFenetreStatus('binary_sensor.contact_fenetre_chambre_sonoff_contact');

                      return `
                      <div>
                        <div>${salon}</div>
                        <div>${cuisine}</div>
                        <div>${bureau}</div>
                        <div>${chambre}</div>
                      </div>
                      `;
                    ]]]
                  stores: |
                    [[[
                      function getStoreStatus(entityId) {
                        const entity = states[entityId];
                        if (!entity) return '-';
                        const state = entity.state;
                        if (state === 'unavailable' || state === 'unknown' || state === 'N/A') {
                          return '<span style="color: #aaaaaa;">N/A</span>';
                        }
                        // Harmonisation : si le store est "Ouvert", on peut aussi le mettre en rouge si tu veux, 
                        // mais ici on garde le texte brut du sensor de statut.
                        return state;
                      }

                      var salonStoreStatus = getStoreStatus('sensor.store_salon_status');
                      var cuisineStoreStatus = getStoreStatus('sensor.store_cuisine_status');
                      var bureauStoreStatus = getStoreStatus('sensor.store_bureau_status');
                      var chambreStoreStatus = getStoreStatus('sensor.store_chambre_status'); 

                      return `
                      <div>
                        <div>${salonStoreStatus}</div>
                        <div>${cuisineStoreStatus}</div>
                        <div>${bureauStoreStatus}</div>
                        <div>${chambreStoreStatus}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                icon: mdi:cog-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/systeme-freebox
                name: FreeBox Pop
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(340deg)
                    - left: 20%
                    - top: 20%
                    - color: rgb(244,67,54)
                    - opacity: 1
                  name:
                    - color: white
                    - top: 12%
                    - left: 5%
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                entity: sensor.system_monitor_temperature_du_processeur
                icon: phu:intel-nuc
                aspect_ratio: 1/1
                name: _____ Mini - P.C. _____
                entities:
                  - sensor.system_monitor_temperature_du_processeur
                  - sensor.system_monitor_utilisation_du_processeur
                  - sensor.system_monitor_utilisation_de_la_memoire
                  - sensor.system_monitor_utilisation_du_disque
                  - sensor.prise_mini_pc_ikea_power
                triggers_update:
                  - sensor.system_monitor_temperature_du_processeur
                  - sensor.system_monitor_utilisation_du_processeur
                  - sensor.system_monitor_utilisation_de_la_memoire
                  - sensor.system_monitor_utilisation_du_disque
                  - sensor.prise_mini_pc_ikea_power
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/systeme-mini-pc
                styles:
                  card:
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                    - padding: 3%
                  grid:
                    - grid-template-areas: |
                        "i temp"
                        "n n"
                        "cpu cpu"
                        "conso conso"
                        "ram ram"
                        "sd sd"
                  name:
                    - font-weight: bold
                    - font-size: 13px
                    - color: white
                    - align-self: middle
                    - justify-self: center
                    - padding-bottom: 7px
                  icon:
                    - color: |
                        [[[
                          if (entity.state < 65) return 'rgb(70, 175, 75)';
                          if (entity.state >= 65 && entity.state < 75) return 'orange';
                          else return 'rgb(244,67,54)';
                        ]]]
                    - width: 100%
                  custom_fields:
                    temp:
                      - align-self: start
                      - margin-top: 18px
                      - margin-right: 10px
                      - '--text-icon-sensor': |
                          [[[
                            if (entity.state < 65) return 'rgb(70, 175, 75)';
                            if (entity.state >= 65 && entity.state < 75) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                      - '--text-color-sensor': |
                          [[[
                            if (entity.state < 65) return 'rgb(255,255,255)';
                            if (entity.state >= 65 && entity.state < 75) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                    cpu:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            const stateObj = states["sensor.system_monitor_utilisation_du_processeur"];
                            if (!stateObj || stateObj.state === 'unavailable' || stateObj.state === 'unknown') return '#aaaaaa';
                            let val = parseFloat(stateObj.state);
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                    conso:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            const stateObj = states["sensor.prise_mini_pc_ikea_power"];
                            if (!stateObj || stateObj.state === 'unavailable' || stateObj.state === 'unknown') return '#aaaaaa';
                            let val = parseFloat(stateObj.state);
                            if (val < 15) return 'white';
                            if (val >= 15 && val < 19) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                    ram:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            const stateObj = states["sensor.system_monitor_utilisation_de_la_memoire"];
                            if (!stateObj || stateObj.state === 'unavailable' || stateObj.state === 'unknown') return '#aaaaaa';
                            let val = parseFloat(stateObj.state);
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                    sd:
                      - padding-bottom: 0px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            const stateObj = states["sensor.system_monitor_utilisation_du_disque"];
                            if (!stateObj || stateObj.state === 'unavailable' || stateObj.state === 'unknown') return '#aaaaaa';
                            let val = parseFloat(stateObj.state);
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'rgb(244,67,54)';
                          ]]]
                custom_fields:
                  temp: |
                    [[[
                      return `<ha-icon icon="mdi:thermometer" style="width: 15px; height: 15px; color: var(--text-icon-sensor);"></ha-icon> <span style="color: var(--text-color-sensor);">${entity.state}Â°C</span>`
                    ]]]
                  cpu: |
                    [[[
                      const stateObj = states['sensor.system_monitor_utilisation_du_processeur'];
                      const val = (stateObj && stateObj.state !== 'unavailable' && stateObj.state !== 'unknown') ? stateObj.state + '%' : 'N/A';
                      return `<ha-icon icon="mdi:server" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>CPU: <span style="color: var(--text-color-sensor);">${val}</span></span>`
                    ]]]
                  conso: |
                    [[[
                      const stateObj = states['sensor.prise_mini_pc_ikea_power'];
                      const val = (stateObj && stateObj.state !== 'unavailable' && stateObj.state !== 'unknown') ? stateObj.state + 'W' : 'N/A';
                      return `<ha-icon icon="mdi:lightning-bolt-outline" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>Power: <span style="color: var(--text-color-sensor);">${val}</span></span>`
                    ]]]
                  ram: |
                    [[[
                      const stateObj = states['sensor.system_monitor_utilisation_de_la_memoire'];
                      const val = (stateObj && stateObj.state !== 'unavailable' && stateObj.state !== 'unknown') ? stateObj.state + '%' : 'N/A';
                      return `<ha-icon icon="mdi:memory" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>RAM: <span style="color: var(--text-color-sensor);">${val}</span></span>`
                    ]]]
                  sd: |
                    [[[
                      const stateObj = states['sensor.system_monitor_utilisation_du_disque'];
                      const val = (stateObj && stateObj.state !== 'unavailable' && stateObj.state !== 'unknown') ? stateObj.state + '%' : 'N/A';
                      return `<ha-icon icon="mdi:harddisk" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>SD: <span style="color: var(--text-color-sensor);">${val}</span></span>`
                    ]]]
              - type: custom:button-card
                entity: sensor.available_updates
                icon: mdi:home-assistant
                aspect_ratio: 1/1
                name: Software | modules
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/maj
                styles:
                  card:
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: |
                        [[[
                          if (entity.state == '0') return 'white';
                          else return 'orange';
                        ]]]
                    - font-size: 11px
                    - line-height: 1.2
                    - font-weight: bold
                  grid:
                    - grid-template-areas: '''icon n'' ''updates updates'''
                    - grid-template-columns: auto 1fr
                    - grid-template-rows: 1fr min-content
                  name:
                    - font-weight: bold
                    - color: white
                    - align-self: start
                    - justify-self: center
                    - margin-right: 50px
                  custom_fields:
                    icon:
                      - width: 40px
                      - height: 40px
                      - margin-top: 0%
                      - margin-left: 250%
                      - justify-self: center
                      - color: |
                          [[[
                            if (entity.state == '0') return 'lightblue';
                            else return 'orange';
                          ]]]
                    updates:
                      - align-self: start
                      - justify-self: center
                custom_fields:
                  icon: |
                    [[[
                      return '<ha-icon icon="mdi:home-assistant" style="width: 40px; height: 40px; color: ' +
                        (entity.state == '0' ? 'lightblue' : 'orange') + ';"></ha-icon>';
                    ]]]
                  updates: |
                    [[[
                      if (entity.state == '0') return 'Tout est Ã  jour';
                      else if (entity.state == '1') return '1 mise Ã  jour';
                      else return entity.state + ' mises Ã  jour';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/battery-bp
                  entities:
                    - group.hue_devices
                    - group.ikea_devices
                    - group.sonoff_devices
                triggers_update:
                  - group.hue_devices
                  - group.ikea_devices
                  - group.sonoff_devices
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: >
                        "title title title title title title" "espace_debut
                        espace_debut espace_debut espace_debut espace_debut
                        espace_debut" "count marque 100_75_battery 75_50_battery
                        50_25_battery 25_0_battery" "espace_fin espace_fin
                        espace_fin espace_fin espace_fin espace_fin"
                    - grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr
                    - grid-template-rows: auto 10px auto 18px
                    - margin-top: 4.5px
                  custom_fields:
                    title:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace_debut:
                      - grid-area: espace_debut
                      - height: 10px
                    count:
                      - grid-area: count
                      - justify-self: start
                      - margin-left: 5px
                      - text-align: right
                    marque:
                      - grid-area: marque
                      - margin-right: '-21px'
                      - text-align: left
                    100_75_battery:
                      - grid-area: 100_75_battery
                      - justify-self: end
                      - margin-right: '-15px'
                      - text-align: right
                    75_50_battery:
                      - grid-area: 75_50_battery
                      - justify-self: end
                      - margin-right: '-9px'
                      - text-align: right
                    50_25_battery:
                      - grid-area: 50_25_battery
                      - justify-self: end
                      - margin-right: '-2px'
                      - text-align: right
                    25_0_battery:
                      - grid-area: 25_0_battery
                      - justify-self: end
                      - margin-right: 5px
                      - text-align: right
                    espace_fin:
                      - grid-area: espace_fin
                      - height: 10px
                custom_fields:
                  title: |
                    [[[
                      return 'Etat des Piles & Batteries<br><br> 100%> 75%> 50%> 25%>';
                    ]]]
                  espace_debut: |
                    [[[
                      return ' ';
                    ]]]
                  count: |
                    [[[
                      function hasBatteryBelowThreshold(groupName, threshold) {
                        var group = states[groupName];
                        if (!group) return false;
                        return group.attributes.entity_id.some(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= threshold;
                        });
                      }
                      function getStyledCount(groupName) {
                        if (hasBatteryBelowThreshold(groupName, 10)) {
                          // L'Ã©moji âš ï¸ avec ton rouge et en gras (font-weight: bold)
                          return '<span style="color: rgb(244,67,54); font-weight: bold;">âš ï¸</span>';
                        }
                        var group = states[groupName];
                        return group ? group.attributes.entity_id.length : 0;
                      }
                      var hueCount = getStyledCount('group.hue_devices');
                      var ikeaCount = getStyledCount('group.ikea_devices');
                      var sonoffCount = getStyledCount('group.sonoff_devices');
                      return `<div><div>${hueCount}</div><div>${ikeaCount}</div><div>${sonoffCount}</div></div>`;
                    ]]]
                  marque: |
                    [[[
                      function hasBatteryBelowThreshold(groupName, threshold) {
                        var group = states[groupName];
                        if (!group) return false;
                        return group.attributes.entity_id.some(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= threshold;
                        });
                      }
                      function getStyledMarque(name, groupName) {
                        if (hasBatteryBelowThreshold(groupName, 10)) {
                          // Le nom de la marque passe aussi en ROUGE et en GRAS
                          return `<span style="color: rgb(244,67,54); font-weight: bold;">${name}</span>`;
                        }
                        return name;
                      }
                      return `<div><div>${getStyledMarque('HUE', 'group.hue_devices')}</div><div>${getStyledMarque('IKEA', 'group.ikea_devices')}</div><div>${getStyledMarque('SONOFF', 'group.sonoff_devices')}</div></div>`;
                    ]]]
                  100_75_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: #FFA500;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue100_75 = getStyledCount(countBatteriesInRange('group.hue_devices', 76, 99));
                      var ikea100_75 = getStyledCount(countBatteriesInRange('group.ikea_devices', 76, 99));
                      var sonoff100_75 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 76, 99));
                      return `
                      <div>
                        <div>${hue100_75}</div>
                        <div>${ikea100_75}</div>
                        <div>${sonoff100_75}</div>
                      </div>
                      `;
                    ]]]
                  75_50_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: #FFA500;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue75_50 = getStyledCount(countBatteriesInRange('group.hue_devices', 51, 75));
                      var ikea75_50 = getStyledCount(countBatteriesInRange('group.ikea_devices', 51, 75));
                      var sonoff75_50 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 51, 75));
                      return `
                      <div>
                        <div>${hue75_50}</div>
                        <div>${ikea75_50}</div>
                        <div>${sonoff75_50}</div>
                      </div>
                      `;
                    ]]]
                  50_25_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: #FFA500;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue50_25 = getStyledCount(countBatteriesInRange('group.hue_devices', 26, 50));
                      var ikea50_25 = getStyledCount(countBatteriesInRange('group.ikea_devices', 26, 50));
                      var sonoff50_25 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 26, 50));
                      return `
                      <div>
                        <div>${hue50_25}</div>
                        <div>${ikea50_25}</div>
                        <div>${sonoff50_25}</div>
                      </div>
                      `;
                    ]]]
                  25_0_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: #FFA500;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue25_0 = getStyledCount(countBatteriesInRange('group.hue_devices', 0, 25));
                      var ikea25_0 = getStyledCount(countBatteriesInRange('group.ikea_devices', 0, 25));
                      var sonoff25_0 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 0, 25));
                      return `
                      <div>
                        <div>${hue25_0}</div>
                        <div>${ikea25_0}</div>
                        <div>${sonoff25_0}</div>
                      </div>
                      `;
                    ]]]
                  espace_fin: |
                    [[[
                      return '----------------------------------------';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/phone
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "nom batterie reserve"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                      - margin-top: 3px
                    nom:
                      - grid-area: nom
                      - justify-self: start
                      - margin-left: 4px
                      - text-align: left
                    batterie:
                      - grid-area: batterie
                      - justify-self: center
                      - text-align: right
                    reserve:
                      - grid-area: reserve
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                      - margin-top: 0px
                custom_fields:
                  titre: |
                    [[[
                      return 'Ã‰tat Batterie Portables';
                    ]]]
                  nom: |
                    [[[
                      return `
                      <div>
                        <div>POCO_E</div>
                        <div>POCO_G</div>
                        <div>1+10P_E</div>
                        <div>1+10P_G</div>
                        <div>GM1901</div>
                        <div>SM-A53</div>
                        <div>Tablette</div>
                      </div>
                      `;
                    ]]]
                  batterie: |
                    [[[
                      function getColorForBatteryLevel(batteryLevel) {
                        const lvl = Number(batteryLevel);
                        if (Number.isNaN(lvl)) return 'gray';
                        if (lvl >= 80) return 'lightgreen';
                        if (lvl >= 50) return 'orange';
                        if (lvl >= 20) return 'rgb(255,152,0)';
                        return 'rgb(244,67,54)'; 
                      }

                      function getDeviceStatus(entityId) {
                        const st = states[entityId];
                        if (!st || st.state === 'unavailable' || st.state === 'unknown') {
                          return '<span style="color: gray;">Ã‰teint</span>';
                        }
                        const lvl = Number(st.state);
                        const color = getColorForBatteryLevel(lvl);
                        const safe = Number.isNaN(lvl) ? 'â€”' : `${lvl}%`;
                        return `<span style="color: ${color};">${safe}</span>`;
                        }
                      

                      const pocox7_e_Status   = getDeviceStatus('sensor.poco_x7_pro_battery_level');
                      const pocox7_g_Status   = getDeviceStatus('sensor.poco_x7_pro_mamour_battery_level');
                      const ne2213_e_Status   = getDeviceStatus('sensor.ne2213_eric_battery_level');
                      const ne2213_g_Status   = getDeviceStatus('sensor.ne2213_mamour_battery_level');
                      const gm1901Status      = getDeviceStatus('sensor.gm1901_battery_level');
                      const smA530FStatus     = getDeviceStatus('sensor.sm_a530f_battery_level');
                      const tabletteStatus    = getDeviceStatus('sensor.tablette_battery_level');

                      return `
                      <div>
                        <div>${pocox7_e_Status}</div>
                        <div>${pocox7_g_Status}</div>
                        <div>${ne2213_e_Status}</div>
                        <div>${ne2213_g_Status}</div>
                        <div>${gm1901Status}</div>
                        <div>${smA530FStatus}</div>
                        <div>${tabletteStatus}</div>
                      </div>
                      `;
                    ]]]
                  reserve: |
                    [[[
                      function getBatteryStateIcon(entityId) {
                        const state = states[entityId]?.state;
                        if (!state || state === 'unknown' || state === 'unavailable') return 'âš«';
                        if (state === 'discharging')        return 'ðŸŸ¢';
                        if (state === 'charging_wireless')  return 'ðŸŸ¡';
                        if (state === 'wireless')           return 'ðŸŸ¡';
                        if (state === 'charging')           return 'ðŸŸ ';
                        if (state === 'full')               return 'Full';
                        return state;
                      }
                      const pocox7_e_BatteryState    = getBatteryStateIcon('sensor.poco_x7_pro_battery_state');
                      const pocox7_g_BatteryState    = getBatteryStateIcon('sensor.poco_x7_pro_mamour_battery_state');
                      const ne2213_e_BatteryState    = getBatteryStateIcon('sensor.ne2213_eric_battery_state');
                      const ne2213_g_BatteryState    = getBatteryStateIcon('sensor.ne2213_mamour_battery_state');
                      const gm1901BatteryState       = getBatteryStateIcon('sensor.gm1901_battery_state');
                      const smA530FBatteryState      = getBatteryStateIcon('sensor.sm_a530f_battery_state');
                      const tabletteBatteryState     = getBatteryStateIcon('sensor.tablette_battery_state');

                      return `
                      <div>
                        <div>${pocox7_e_BatteryState}</div>
                        <div>${pocox7_g_BatteryState}</div>
                        <div>${ne2213_e_BatteryState}</div>
                        <div>${ne2213_g_BatteryState}</div>
                        <div>${gm1901BatteryState}</div>
                        <div>${smA530FBatteryState}</div>
                        <div>${tabletteBatteryState}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                show_icon: false
                show_name: false
                styles:
                  grid:
                    - grid-template-areas: '"graph"'
                    - grid-template-columns: 1fr
                    - grid-template-rows: 1fr
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  custom_fields:
                    graph:
                      - width: 115%
                      - height: 120%
                      - margin-top: 20px
                      - margin-left: 10px
                      - margin-right: 10px
                      - margin-bottom: 0px
                      - align-self: center
                      - justify-self: center
                custom_fields:
                  graph:
                    card:
                      type: custom:flex-horseshoe-card
                      entities:
                        - entity: sensor.taille_db_home_assistant
                          tap_action:
                            action: navigate
                            navigation_path: /dashboard-tablette/reserve
                          decimals: 1
                          name: MARIADB
                          icon: mdi:database
                      show:
                        horseshoe_style: colorstopgradient
                      layout:
                        icons:
                          - id: 0
                            entity_index: 0
                            xpos: 50
                            ypos: 25
                            size: 5
                        states:
                          - id: 0
                            entity_index: 0
                            xpos: 50
                            ypos: 60
                            styles:
                              - font-weight: bold;
                              - font-size: 30px;
                              - opacity: 0.95;
                        names:
                          - id: 0
                            entity_index: 0
                            xpos: 50
                            ypos: 77
                            styles:
                              - font-weight: 700;
                              - font-size: 15px;
                              - opacity: 0.9;
                        hlines:
                          - id: 0
                            xpos: 50
                            ypos: 37
                            length: 50
                            styles:
                              - stroke: var(--primary-text-color);
                              - stroke-width: 2;
                              - stroke-linecap: round;
                              - opacity: 1;
                      horseshoe_scale:
                        min: 0
                        max: 4000
                        width: 3
                      color_stops:
                        '0': green
                        '1800': gold
                        '2500': rgb(231,180,57)
                        '3000': rgb(225,156,24)
                        '3500': darkorange
                        '4000': red
                      card_mod:
                        style: |
                          ha-card {
                            background: none !important;
                            box-shadow: none !important;
                            border: none !important;
                          }
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/air-quality
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: >
                        "titre titre titre"

                        "espace_debut espace_debut espace_debut"

                        "piece_pm25_salon type_pm25_salon value_pm25_salon"

                        "piece_pm25_bureau type_pm25_bureau value_pm25_bureau"

                        "piece_pm25_chambre type_pm25_chambre
                        value_pm25_chambre"

                        "piece_tcov_salon type_tcov_salon value_tcov_salon"

                        "piece_tcov_bureau type_tcov_bureau value_tcov_bureau"

                        "piece_tcov_chambre type_tcov_chambre
                        value_tcov_chambre"

                        "espace_fin espace_fin espace_fin"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace_debut:
                      - grid-area: espace_debut
                      - height: 10px
                    piece_pm25_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_pm25_bureau:
                      - justify-self: start
                      - margin-left: 4px
                    piece_pm25_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    type_pm25_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_pm25_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_pm25_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_tcov_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    type_tcov_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    type_tcov_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    value_pm25_salon:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_pm25_bureau:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_pm25_chambre:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_tcov_salon:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 14px
                    value_tcov_bureau:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 15px
                    value_tcov_chambre:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 14px
                    espace_fin:
                      - grid-area: espace_fin
                      - height: 10px
                custom_fields:
                  titre: |
                    [[[
                      return 'QualitÃ© de l\'Air ambiant';
                    ]]]
                  espace_debut: |
                    [[[
                      return ' ';
                    ]]]
                  piece_pm25_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Salon</span>';
                    ]]]
                  piece_pm25_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Bureau</span>';
                    ]]]
                  piece_pm25_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Chambre</span>';
                    ]]]
                  piece_tcov_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Salon</span>';
                    ]]]
                  piece_tcov_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Bureau</span>';
                    ]]]
                  piece_tcov_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">Chambre</span>';
                    ]]]
                  type_pm25_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_pm25_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_pm25_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var color = (pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '') ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_tcov_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  type_tcov_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  type_tcov_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var color = (tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '') ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  value_pm25_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var isMissing = pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : pm25Value + ' Âµg/mÂ³';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  value_pm25_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var isMissing = pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : pm25Value + ' Âµg/mÂ³';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  value_pm25_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_pm25'];
                      var pm25Value = state ? state.state : 'unavailable';
                      var isMissing = pm25Value == 'unknown' || pm25Value == 'unavailable' || pm25Value === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(pm25Value) > 35 ? 'rgb(244,67,54)' : 
                                   parseFloat(pm25Value) > 11 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : pm25Value + ' Âµg/mÂ³';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  value_tcov_salon: |
                    [[[
                      var state = states['sensor.qualite_air_salon_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var isMissing = tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : tcovValue + ' ppb';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  value_tcov_bureau: |
                    [[[
                      var state = states['sensor.qualite_air_bureau_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var isMissing = tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : tcovValue + ' ppb';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  value_tcov_chambre: |
                    [[[
                      var state = states['sensor.qualite_air_chambre_ikea_voc_index'];
                      var tcovValue = state ? state.state : 'unavailable';
                      var isMissing = tcovValue == 'unknown' || tcovValue == 'unavailable' || tcovValue === '';
                      var color = isMissing ? '#808080' : 
                                  (parseFloat(tcovValue) > 1000 ? 'rgb(244,67,54)' : 
                                   parseFloat(tcovValue) > 250 ? 'orange' : 'white');
                      var displayValue = isMissing ? 'N/A' : tcovValue + ' ppb';
                      return '<span style="color: ' + color + ';">' + displayValue + '</span>';
                    ]]]
                  espace_fin: |
                    [[[
                      return ' ';
                    ]]]
              - type: custom:button-card
                icon: mdi:face-mask-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/pollen-pollution
                name: |-
                  [[[
                    var airQuality = states['sensor.qualite_globale_vence'].state;
                    var pollenAlert = states['sensor.qualite_globale_pollen_vence'].state;

                    function getColor(value) {
                      var severity = [
                        { color: 'grey', from: 0, to: 0 },
                        { color: 'green', from: 1, to: 1 },
                        { color: 'lightgreen', from: 2, to: 2 },
                        { color: 'gold', from: 3, to: 3 },
                        { color: 'orange', from: 4, to: 4 },
                        { color: 'red', from: 5, to: 5 },
                        { color: 'darkred', from: 6, to: 6 },
                        { color: 'purple', from: 7, to: 7 }
                      ];

                      var color = severity.find(function(range) {
                        return value >= range.from && value <= range.to;
                      });

                      return color ? color.color : 'black';
                    }

                    var airColor = getColor(airQuality);
                    var pollenColor = getColor(pollenAlert);

                    return `<div style="text-align: left; color: white; font-size: 13px;margin-bottom: 4px;">Pollution / Pollen</div>
                                  <div><span style="color: ${airColor}; font-weight: bold;">Niveau ${airQuality}</span> /
                                  <span style="color: ${pollenColor}; font-weight: bold;">Niveau ${pollenAlert}</span></div>`;
                  ]]]
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(350deg)
                    - left: 15%
                    - top: 15%
                    - color: white
                    - opacity: 1
                  name:
                    - color: white
                    - top: 10px
                    - left: 10px
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                icon: |
                  [[[
                    // RÃ©cupÃ¨re l'entitÃ©
                    var sensor = states['sensor.alert_level_in_vence'];
                    // RÃ©cupÃ¨re le nom de l'icÃ´ne ou une icÃ´ne par dÃ©faut
                    var iconName = sensor && sensor.attributes && sensor.attributes.icon ? sensor.attributes.icon : 'mdi:water-outline';
                    return iconName;
                  ]]]
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/vigieau
                name: |
                  [[[
                    var sensor = states['sensor.alert_level_in_vence'];
                    var alertLevel = sensor.state;
                    var alertColor = (sensor.attributes && sensor.attributes.Couleur) ? sensor.attributes.Couleur : 'grey';
                    switch(alertLevel) {
                      case 'vigilance (pas de restriction)':
                        alertLevel = 'Aucune restriction';
                      case 'alerte_renforcee':
                        alertLevel = 'Alerte renforcÃ©e';
                        break;
                    }

                    return `<div style="text-align: left; color: white; font-size: 13px; margin-bottom: 4px;">Vigieau / Vigi-Eau</div>
                            <div><span style="color: ${alertColor}; font-weight: bold;">${alertLevel}</span></div>`;
                  ]]]
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(350deg)
                    - left: 15%
                    - top: 15%
                    - color: |
                        [[[
                            var sensor = states['sensor.alert_level_in_vence'];
                            return (sensor && sensor.attributes && sensor.attributes.Couleur) ? sensor.attributes.Couleur : 'white';
                        ]]]
                  name:
                    - color: white
                    - top: 10px
                    - left: 10px
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
            columns: 3
          - type: custom:streamline-card
            template: nav_bar
    cards: []
    badges: []
  - title: MÃ©tÃ©o
    path: meteo
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:clouds
            heading: METEO
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.icone_th_balcon_nord
                color: green
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: Appartement
            icon: mdi:home-assistant
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: horizontal-stack
            cards:
              - type: markdown
                content: >
                  <center>TempÃ©rature: <ha-icon
                  icon="mdi:home-thermometer"></ha-icon> {{
                  states("sensor.th_balcon_nord_temperature")}}Â°C</center>
                card_mod:
                  style: |
                    ha-card {
                      font-size: 17px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: markdown
                content: >
                  <center>HumiditÃ©: <ha-icon icon="mdi:water-percent"></ha-icon>
                  {{ states("sensor.th_balcon_nord_humidity") | round(0)
                  }}%</center>
                card_mod:
                  style: |
                    ha-card {
                      font-size: 17px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: custom:bubble-card
            card_type: separator
            name: PrÃ©vision MÃ©tÃ©o France & Carte Windy
            icon: mdi:sun-snowflake
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: weather-forecast
                    show_current: true
                    show_forecast: true
                    entity: weather.vence
                    forecast_type: hourly
                    card_mod:
                      style: |
                        .temp-attribute {
                          color:green;
                        }
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:swipe-card
                    parameters:
                      allowTouchMove: false
                      effect: coverflow
                      centeredSlides: true
                      slidesPerView: auto
                      spaceBetween: 8
                      pagination:
                        type: progressbar
                      navigation: null
                      keyboard:
                        enabled: true
                        onlyInViewport: true
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                    navigation: null
                    cards:
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=5&overlay=radar&product=radar&level=surface&lat=43.612&lon=7.207
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=rain&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=temp&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=wind&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                  - type: weather-forecast
                    show_current: false
                    show_forecast: true
                    entity: weather.vence
                    forecast_type: daily
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: heading
            icon: mdi:compass-rose
            heading: Vitesse du Vent - BaromÃ¨tre - U.V. - Pluie
            heading_style: title
            badges: []
            tap_action:
              action: none
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: separator
                name: Vent
                icon: mdi:compass-outline
                rows: 2
                styles: |-
                  .bubble-line {
                    background: var(--primary-text-color);
                    opacity: 1;
                  }
                card_layout: normal
              - type: custom:windrose-card
                title: Direction et Vitesse du Vent avec Rafales
                max_width: 300
                windspeed_bar_location: bottom
                windspeed_bar_full: true
                wind_direction_entity:
                  entity: sensor.direction_du_vent_vence
                  use_statistics: false
                  direction_compensation: 0
                windspeed_entities:
                  - entity: weather.vence
                    attribute: wind_speed
                    name: Moyenne
                    speed_unit: auto
                    speed_range_beaufort: false
                    speed_range_step: 5
                    speed_range_max: 35
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                  - entity: sensor.vence_wind_gust
                    name: Rafale
                    speed_unit: auto
                    speed_range_beaufort: false
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                wind_direction_unit: degrees
                input_speed_unit: auto
                output_speed_unit: kph
                direction_labels:
                  cardinal_direction_letters: NESO
                  show_cardinal_directions: true
                  show_intercardinal_directions: true
                  show_secondary_intercardinal_directions: true
                  cardinal_directions_text_size: 60
                  intercardinal_directions_text_size: 45
                  secondary_intercardinal_directions_text_size: 30
                  custom_labels:
                    'n': Nord
                    e: Est
                    s: Sud
                    w: Ouest
                    ne: NE
                    se: SE
                    sw: SO
                    nw: 'NO'
                    nne: NNE
                    ene: ENE
                    ese: ESE
                    sse: SSE
                    ssw: SSO
                    wsw: OSO
                    wnw: ONO
                    nnw: NNO
                matching_strategy: full-time
                direction_speed_time_diff: 1
                center_calm_percentage: true
                center_circle_size: 30
                colors:
                  rose_lines: rgb(0,255,0)
                  rose_cardinal_direction_labels: white
                  rose_intercardinal_direction_labels: white
                  rose_secondary_intercardinal_direction_labels: white
                  rose_center_percentage: white
                  rose_percentages: white
                  rose_current_direction_arrow: red
                  bar_border: hsl(200, 100%, 60%)
                  bar_unit_name: white
                  bar_name: white
                  bar_unit_values: white
                  bar_percentages: auto
                data_period:
                  period_selector:
                    location: top
                    active_color: black
                    active_bg_color: white
                    color: white
                    bg_color: black
                    buttons:
                      - hours: 24
                        title: 1 day
                        active: true
                      - hours: 168
                        title: 7 days
                      - hours: 360
                        title: 15 days
                      - hours: 730
                        title: 30 days
                refresh_interval: 60
                windrose_draw_north_offset: 0
                current_direction:
                  entity: sensor.vence_wind_speed
                  show_arrow: true
                  arrow_size: 100
                  center_circle_size: 30
                  hide_direction_below_speed: 1
                compass_direction:
                  entity: sensor.direction_du_vent_vence
                  auto_rotate: false
                  as_heading: false
                corner_info:
                  top_left:
                    label: Vitesse du Vent
                    unit: ' km/h'
                    entity: sensor.vitesse_du_vent_vence
                    label_text_size: 40
                  top_right:
                    label: Direction du Vent
                    color: white
                    entity: sensor.direction_du_vent_vence_label
                    label_text_size: 50
                    value_text_size: 60
                  bottom_left:
                    label: Boussole
                    unit: Â°
                    entity: sensor.direction_du_vent_vence
                    label_text_size: 40
                  bottom_right:
                    label: Vitesse de la rafale actuelle
                    unit: ' km/h'
                    entity: sensor.vence_wind_gust
                    label_text_size: 50
                    value_text_size: 60
                    input_unit: kph
                    output_unit: kph
                    precision: 1
                actions:
                  top_left:
                    tap_action:
                      action: none
                  top_right:
                    double_tap_action:
                      action: none
                  windrose:
                    tap_action:
                      action: none
                  bottom_right:
                    tap_action:
                      action: mone
                  bottom_left:
                    tap_action:
                      action: none
                  speed_bar_1:
                    tap_action:
                      action: none
                  speed_bar_2:
                    tap_action:
                      action: none
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: custom:bubble-card
                card_type: separator
                name: BaromÃ¨tre
                icon: mdi:clouds
                rows: 2
                styles: |-
                  .bubble-line {
                    background: var(--primary-text-color);
                    opacity: 1;
                  }
                card_layout: normal
              - type: vertical-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - type: custom:ha-tbaro-card
                        entity: sensor.vence_pressure
                        show_weather_icon: true
                        show_weather_text: true
                        show_pressure: true
                        stroke_width: 10
                        show_icon: true
                        needle_color: gainsboro
                        tick_color: gainsboro
                        show_border: false
                        unit: hpa
                        angle: 270
                        size: 400
                        segments:
                          - from: 950
                            to: 980
                            color: '#FF4500'
                          - from: 980
                            to: 1000
                            color: '#FFD700'
                          - from: 1000
                            to: 1020
                            color: '#3399ff'
                          - from: 1020
                            to: 1050
                            color: '#4CAF50'
                        border: none
                        language: fr
                        icon_offset_y: 10
                        icon_offset_x: 7
                        icon_size: 30
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:bubble-card
                            card_type: separator
                            name: UV
                            icon: mdi:sunglasses
                            rows: 1
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
                          - type: custom:bubble-card
                            card_type: separator
                            name: Pluie
                            icon: mdi:weather-pouring
                            rows: 1
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
              - type: vertical-stack
                cards:
                  - card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:uv-index-card
                            entity: sensor.vence_uv
                            name: ''
                            icon: mdi:weather-sunny
                            card_mod:
                              style: |
                                ha-card {
                                  font-size: 15px;
                                  border: none !important;
                                  text-align: center;
                                }
                                ha-card > div > div:nth-child(1) > svg {
                                  width: 80%;
                                  margin-top: 25px;
                                  border: none !important;
                                } 
                          - type: custom:rain-gauge-card
                            entity: sensor.vence_daily_precipitation
                            fill_drop_colour: '#44739E'
                            max_level: 60
                            border_colour: grey
                            name: ''
                            icon: mdi:weather-rainy
                            card_mod:
                              style: |
                                ha-card {
                                  margin-top: 20px;
                                  font-size: 15px; 
                                  border: none !important;
                                  text-align: center;
                                }
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:bubble-card
                            card_type: separator
                            name: Pluie ces derniÃ¨res 24 heures (MÃ©tÃ©o France)
                            icon: mdi:weather-pouring
                            rows: 2
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
              - type: vertical-stack
                cards:
                  - card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:apexcharts-card
                            graph_span: 24h
                            header:
                              show: false
                              title: ''
                            series:
                              - entity: sensor.vence_daily_precipitation
                                stroke_width: 2
                                type: area
                                color: '#44739E'
                                opacity: 0.5
                                group_by:
                                  func: avg
                                  duration: 1m
                            card_mod:
                              style: |
                                ha-card {
                                  background: none !important;
                                  border: none !important;
                                }
            grid_options:
              columns: full
              rows: 8
          - type: heading
            heading_style: title
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#foudre'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Impacts de foudre (30 Km)
                icon: mdi:weather-lightning
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
                sub_button:
                  main: []
                  bottom: []
                slider_fill_orientation: left
                slider_value_position: right
              - type: custom:button-card
                entity: sensor.blitzortung_lightning_counter
                triggers_update:
                  - sensor.dernier_impact_temps_reel
                  - sensor.blitzortung_lightning_distance
                name: |
                  [[[
                    const distRaw = states['sensor.blitzortung_lightning_distance'] ? parseFloat(states['sensor.blitzortung_lightning_distance'].state) : 0;
                    const localisation = states['sensor.blitzortung_lightning_localisation'];
                    const azimuth = states['sensor.blitzortung_lightning_azimuth'] ? parseFloat(states['sensor.blitzortung_lightning_azimuth'].state) : null;
                    const impactCount = parseInt(entity.state) || 0;
                    const timePhrase = states['sensor.dernier_impact_temps_reel'] ? states['sensor.dernier_impact_temps_reel'].state : '';

                    let message = '';
                    
                    if (distRaw > 0) {
                      const distance = distRaw.toFixed(1);
                      message = `Impact Ã  <strong>${distance} Km</strong>`;
                      
                      let city = null;
                      if (localisation && localisation.attributes && localisation.attributes.features) {
                        const features = localisation.attributes.features;
                        if (features[0]?.properties?.geocoding?.city) {
                          city = features[0].properties.geocoding.city;
                          message += ` Ã  ${city}`;
                        }
                      }

                      if (!city && azimuth !== null) {
                        const directions = [
                          "au nord", "au nord-nord-est", "au nord-est", "Ã  l'est-nord-est", 
                          "Ã  l'est", "Ã  l'est-sud-est", "au sud-est", "au sud-sud-est", 
                          "au sud", "au sud-sud-ouest", "au sud-ouest", "Ã  l'ouest-sud-ouest", 
                          "Ã  l'ouest", "Ã  l'ouest-nord-ouest", "au nord-ouest", "au nord-nord-ouest"
                        ];
                        const index = Math.round(azimuth / 22.5) % 16;
                        message += ` ${directions[index]}`;
                      }
                    } else {
                      message = "Aucun impact rÃ©cent dÃ©tectÃ©";
                    }

                    const impactLine = impactCount > 0 
                      ? `<br><span style="color: #ffeb3b; font-weight: bold; font-size: 17px;">âš¡ ${impactCount} impact(s) dÃ©tectÃ©(s)</span>` 
                      : '';

                    return `
                      <div style="line-height: 1.6;">
                        <span style="font-size: 14px;">${message}</span><br>
                        <span style="font-size: 13px; opacity: 0.9; font-weight: 500;">${timePhrase}</span>
                        ${impactLine}
                      </div>
                    `;
                  ]]]
                show_state: false
                styles:
                  card:
                    - border-radius: 12px
                    - padding: 15px
                    - border-style: solid
                    - border-width: 2px
                    - background: |
                        [[[
                          const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                          if (d > 0 && d <= 5) return 'rgba(255, 0, 0, 0.2)';
                          if (d > 5) return 'rgba(255, 123, 0, 0.1)';
                          return 'rgba(0, 255, 0, 0.05)';
                        ]]]
                    - border-color: |
                        [[[
                          const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                          if (d > 0 && d <= 5) return 'red';
                          if (d > 5) return 'rgba(255, 123, 0, 0.5)';
                          return 'rgba(0, 255, 0, 0.4)';
                        ]]]
                    - animation: |
                        [[[
                          const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                          return (d > 0 && d <= 5) ? 'blink-danger 1s ease infinite' : 'none';
                        ]]]
                  name:
                    - justify-self: center
                    - text-align: center
                    - color: white
                  icon:
                    - width: 45px
                    - color: |
                        [[[
                          const d = parseFloat(states['sensor.blitzortung_lightning_distance']?.state);
                          if (d > 0 && d <= 5) return 'red';
                          if (d > 5) return 'rgb(255, 123, 0)';
                          return 'rgb(0, 255, 0)';
                        ]]]
                extra_styles: |
                  @keyframes blink-danger {
                    50% { background: rgba(255, 0, 0, 0.6); border-color: white; }
                  }
                grid_options:
                  columns: 12
                  rows: 2
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Compteur des points d'impacts
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_hourly
                            name: Heure
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 3000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 428
                          - color: gold
                            from: 429
                            to: 857
                          - color: orange
                            from: 858
                            to: 1285
                          - color: darkorange
                            from: 1286
                            to: 1714
                          - color: red
                            from: 1715
                            to: 2142
                          - color: darkred
                            from: 2143
                            to: 2571
                          - color: purple
                            from: 2572
                            to: 3000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_daily
                            name: Jour
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 30000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 4285
                          - color: gold
                            from: 4286
                            to: 8571
                          - color: orange
                            from: 8572
                            to: 12857
                          - color: darkorange
                            from: 12858
                            to: 17142
                          - color: red
                            from: 17143
                            to: 21428
                          - color: darkred
                            from: 21429
                            to: 25714
                          - color: purple
                            from: 25715
                            to: 30000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_weekly
                            name: Semaine
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 50000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 7142
                          - color: gold
                            from: 7143
                            to: 14285
                          - color: orange
                            from: 14286
                            to: 21428
                          - color: darkorange
                            from: 21429
                            to: 28571
                          - color: red
                            from: 28572
                            to: 35714
                          - color: darkred
                            from: 35715
                            to: 42857
                          - color: purple
                            from: 42858
                            to: 50000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_monthly
                            name: Mois
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 70000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 10000
                          - color: gold
                            from: 10001
                            to: 20000
                          - color: orange
                            from: 20001
                            to: 30000
                          - color: darkorange
                            from: 30001
                            to: 40000
                          - color: red
                            from: 40001
                            to: 50000
                          - color: darkred
                            from: 50001
                            to: 60000
                          - color: purple
                            from: 60001
                            to: 70000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_yearly
                            name: AnnÃ©e
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 150000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 22000
                          - color: gold
                            from: 22001
                            to: 44000
                          - color: orange
                            from: 44001
                            to: 66000
                          - color: darkorange
                            from: 66001
                            to: 88000
                          - color: red
                            from: 88001
                            to: 110000
                          - color: darkred
                            from: 110001
                            to: 132000
                          - color: purple
                            from: 132001
                            to: 154000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Direction et distance du dernier point d'impact
              - type: custom:windrose-card
                max_width: 300
                windspeed_bar_location: bottom
                windspeed_bar_full: true
                wind_direction_entity:
                  entity: sensor.lightning_bearing
                  use_statistics: false
                  direction_compensation: 0
                windspeed_entities:
                  - entity: sensor.lightning_distance_km
                    name: Distance
                    speed_unit: kph
                    speed_range_beaufort: false
                    speed_range_step: 10
                    speed_range_max: 20
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                wind_direction_unit: degrees
                input_speed_unit: kph
                output_speed_unit: kph
                direction_labels:
                  cardinal_direction_letters: NESO
                  show_cardinal_directions: true
                  show_intercardinal_directions: true
                  show_secondary_intercardinal_directions: true
                  cardinal_directions_text_size: 60
                  intercardinal_directions_text_size: 45
                  secondary_intercardinal_directions_text_size: 30
                  custom_labels:
                    'n': Nord
                    e: Est
                    s: Sud
                    w: Ouest
                    ne: NE
                    se: SE
                    sw: SO
                    nw: 'NO'
                    nne: NNE
                    ene: ENE
                    ese: ESE
                    sse: SSE
                    ssw: SSO
                    wsw: OSO
                    wnw: ONO
                    nnw: NNO
                matching_strategy: full-time
                direction_speed_time_diff: 1
                center_calm_percentage: true
                center_circle_size: 30
                colors:
                  rose_lines: rgb(0,255,0)
                  rose_cardinal_direction_labels: white
                  rose_intercardinal_direction_labels: white
                  rose_secondary_intercardinal_direction_labels: white
                  rose_center_percentage: white
                  rose_percentages: white
                  rose_current_direction_arrow: purple
                  bar_border: hsl(200, 100%, 60%)
                  bar_unit_name: white
                  bar_name: white
                  bar_unit_values: white
                  bar_percentages: auto
                data_period:
                  period_selector:
                    location: top
                    active_color: black
                    active_bg_color: white
                    color: white
                    bg_color: black
                    buttons:
                      - hours: 24
                        title: 1 jour
                        active: true
                      - hours: 168
                        title: 7 jours
                      - hours: 360
                        title: 15 jours
                      - hours: 730
                        title: 30 jours
                refresh_interval: 60
                windrose_draw_north_offset: 0
                current_direction:
                  entity: sensor.lightning_bearing
                  show_arrow: true
                  arrow_size: 100
                  center_circle_size: 30
                  hide_direction_below_speed: 1
                compass_direction:
                  entity: sensor.lightning_bearing
                  auto_rotate: false
                  as_heading: false
                corner_info:
                  top_left:
                    label: Distance de l'Ã©clair
                    unit: ' km'
                    entity: sensor.lightning_distance_km
                    label_text_size: 50
                    value_text_size: 60
                    input_unit: kph
                    output_unit: kph
                    precision: 1
                  top_right:
                    label: Direction de l'Ã©clair
                    color: white
                    entity: sensor.direction_de_l_eclair_label
                    label_text_size: 50
                    value_text_size: 60
                  bottom_left:
                    label: Boussole
                    unit: Â°
                    entity: sensor.lightning_bearing
                    label_text_size: 40
                  bottom_right:
                    label: Compteur d'Ã©clairs
                    unit: ' â†¯'
                    entity: sensor.eclair_daily
                    label_text_size: 40
                actions:
                  top_left:
                    tap_action:
                      action: none
                  top_right:
                    double_tap_action:
                      action: none
                  windrose:
                    tap_action:
                      action: none
                  bottom_right:
                    tap_action:
                      action: none
                  bottom_left:
                    tap_action:
                      action: none
                  speed_bar_1:
                    tap_action:
                      action: none
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
                    .sensor-1 {
                      line-height: 18px;
                    }
                    .sensor-1 .value {
                      font-weight: bold;
                      font-size: 18px !important;
                    }
                    .sensor-0 .value {
                      {% if is_state('sensor.lightning_distance_km', 'unknown') %}
                        font-size: 0px !important;
                      {% else %}
                        font-weight: bold;
                        font-size: 26px !important;
                      {% endif %}
                    }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Graphiques des points d'impact par pÃ©riode
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                span:
                  end: day
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: Nombre d'Ã©claires heure par heure
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Eclaires
                    min: 0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: diff
                    duration: 1h
                    start_with_last: true
                  show:
                    legend_value: true
                    extremas: true
                series:
                  - entity: sensor.eclair_yearly
                    yaxis_id: Eclaires
                    name: Nb Ã©claires ce jours
                    color: gainsboro
                    type: column
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 429
                        color: gold
                      - value: 858
                        color: orange
                      - value: 1286
                        color: darkorange
                      - value: 1715
                        color: red
                      - value: 2143
                        color: darkred
                      - value: 2572
                        color: purple
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 730h
                span:
                  end: day
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: Nombre d'Ã©claires par jour du mois en cours
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Eclaires
                    min: 0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: diff
                    duration: 24h
                    start_with_last: true
                  show:
                    legend_value: true
                    extremas: true
                series:
                  - entity: sensor.eclair_yearly
                    yaxis_id: Eclaires
                    name: Nb Ã©claires ce jours
                    color: gainsboro
                    type: column
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 4286
                        color: gold
                      - value: 8572
                        color: orange
                      - value: 12858
                        color: darkorange
                      - value: 17143
                        color: red
                      - value: 21429
                        color: darkred
                      - value: 25715
                        color: purple
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Cartes des orages et des impacts de foudre
              - type: custom:stack-in-card
                mode: horizontal
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: custom:swipe-card
                    parameters:
                      allowTouchMove: false
                      effect: coverflow
                      centeredSlides: true
                      slidesPerView: auto
                      spaceBetween: 8
                      pagination:
                        type: progressbar
                      navigation: null
                      keyboard:
                        enabled: true
                        onlyInViewport: true
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                    navigation: null
                    cards:
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=5&overlay=radar&product=radar&level=surface&lat=43.612&lon=7.207
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: https://map.blitzortung.org/#6.70/43.7221/7.10878
                        aspect_ratio: 100%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                            }
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#alert'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Carte d'alerte(s) MÃ©tÃ©o France
                icon: mdi:alert-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                              ha-card {
                                top: 10px;
                                border: none !important;
                                box-shadow: none !important;
                                background: none !important;
                              }
                        card:
                          type: custom:text-divider-row
                          text: CARTES
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            ha-card {
                              margin: -30px 5px -23px 5px;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              entity: camera.mf_alerte_today
                              name: Alerte mÃ©tÃ©o <br/>Aujourd'hui
                              show_icon: false
                              show_entity_picture: true
                              aspect_ratio: 1/1
                              size: 100%
                              styles:
                                card:
                                  - '--mdc-ripple-color': none
                                  - padding: 15%
                              card_mod:
                                style: |
                                  ha-card {
                                    border: none !important;
                                    box-shadow: none !important;
                                    background: none !important;
                                  }
                            - type: custom:button-card
                              entity: camera.mf_alerte_tomorrow
                              name: Alerte mÃ©tÃ©o <br/>Demain
                              aspect_ratio: 1/1
                              show_icon: false
                              show_entity_picture: true
                              size: 100%
                              styles:
                                card:
                                  - '--mdc-ripple-color': none
                                  - padding: 15%
                              card_mod:
                                style: |
                                  ha-card {
                                    border: none !important;
                                    box-shadow: none !important;
                                    background: none !important;
                                  }
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_meteo
                    secondary: MÃ©tÃ©o
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_orages
                    secondary: Orages
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_pluie_inondation
                    secondary: Pluie Inondation
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_vent_violent
                    secondary: Vent violent
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_avalanches
                    secondary: Avalanches
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_canicule
                    secondary: Canicule
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_inondation
                    secondary: Inondation
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_neige_verglas
                    secondary: Neige
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_grand_froid
                    secondary: Grand Froid
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_vagues_submersion
                    secondary: Vagues submersion
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: custom:meteoalarm-card
                entities:
                  - entity: sensor.06_weather_alert
                integration: meteofrance
                hide_when_no_warning: true
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#sun'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Lever et coucher du Soleil
                icon: mdi:sun-clock-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                        card:
                          type: custom:text-divider-row
                          text: Suivi du soleil
                      - type: custom:horizon-card
                        title: ' '
                        moon: true
                        refresh_period: 60
                        fields:
                          sunrise: true
                          sunset: true
                          dawn: true
                          noon: true
                          dusk: true
                          azimuth: true
                          sun_azimuth: true
                          moon_azimuth: true
                          elevation: true
                          sun_elevation: true
                          moon_elevation: true
                          moonrise: false
                          moonset: false
                          moon_phase: false
                        southern_flip: false
                        moon_phase_rotation: -10
                        language: fr
                        time_format: fr
                        number_format: fr
                        latitude: 43.716667
                        longitude: 7.116667
                        elevation: 330
                        time_zone: Europe/paris
                        no_card: false
                        debug_level: 0
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                              margin-top: -50px;
                            }
                      - type: custom:tsmoon-card
                        title: ''
                        entity: sensor.moon_phase
                        icon_type: round
                        time_format: 24h
                        language: fr
                        hemisphere: 'N'
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                              margin-top: -40px;
                            }
                      - type: custom:entity-progress-card-template
                        name: >
                          {% set sunrise =
                          as_datetime(states('sensor.sun_next_rising')) %} {%
                          set sunset =
                          as_datetime(states('sensor.sun_next_setting')) %} {%
                          set now_time = now() %} {% if sunrise and sunset %}
                            {% if sunrise < sunset %}
                              LevÃ© du soleil Ã  {{ sunrise.timestamp() | timestamp_custom('%H:%M', true) }}
                            {% else %}
                              CouchÃ© du soleil Ã  {{ sunset.timestamp() | timestamp_custom('%H:%M', true) }}
                            {% endif %}
                          {% else %}
                            Suninformation not available
                          {% endif %}
                        entity: sun.sun
                        bar_color: |
                          {% if states('sun.sun') == 'below_horizon' %}
                            lightgray
                          {% else %}
                            orange
                          {% endif %}
                        color: |
                          {% if states('sun.sun') == 'below_horizon' %}
                            none
                          {% else %}
                            orange
                          {% endif %}
                        secondary: >
                          {% set sunrise =
                          as_datetime(states('sensor.sun_next_rising')) %} {%
                          set sunset =
                          as_datetime(states('sensor.sun_next_setting')) %} {%
                          set now_time = now() %} {% if sunrise and sunset %}
                            {% if sunrise < sunset %}
                              {% set next_event = sunrise %}
                              {% set last_event = sunrise - timedelta(days=1) %}
                            {% else %}
                              {% set next_event = sunset %}
                              {% set last_event = sunset - timedelta(days=1) %}
                            {% endif %}
                            {% set delta = next_event - now_time %}
                            {% set total_seconds = delta.total_seconds() %}
                            {% if total_seconds > 1 %}
                              {% set days = (total_seconds // 86400) | int %}
                              {% set hours = (total_seconds % 86400) // 3600 %}
                              {% set minutes = (total_seconds % 3600) // 60 %}
                              {% set seconds = (total_seconds % 60) %}
                              dans
                              {% if days > 0 %}
                                {{ days }}d
                              {% endif %}
                              {{ '%02d:%02d:%02d' | format(hours | int, minutes | int, seconds | int) }}
                            {% else %}
                              maintenant
                            {% endif %}
                          {% else %}
                            --:--:--
                          {% endif %}
                        percent: >
                          {% set sunrise =
                          as_datetime(states('sensor.sun_next_rising')) %} {%
                          set sunset =
                          as_datetime(states('sensor.sun_next_setting')) %} {%
                          set now_time = now() %} {% if sunrise and sunset %}
                            {% if sunrise < sunset %}
                              {% set next_event = sunrise %}
                              {% set last_event = sunrise - timedelta(days=1) %}
                            {% else %}
                              {% set next_event = sunset %}
                              {% set last_event = sunset - timedelta(days=1) %}
                            {% endif %}
                            {% set total = (next_event - last_event).total_seconds() %}
                            {% set elapsed = (now_time - last_event).total_seconds() %}
                            {% if total > 0 %}
                              {{ ((elapsed / total) * 100) | round(2) }}
                            {% else %}
                              0
                            {% endif %}
                          {% else %}
                            0
                          {% endif %}
                        tap_action:
                          action: more-info
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                              margin-top: -30px;
                            }
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                            ha-card {
                              margin-top: -10px;
                            }
                        card:
                          type: custom:text-divider-row
                          text: Cycles
                      - type: glance
                        entities:
                          - entity: sun.sun
                            name: Soleil
                          - entity: sensor.season
                            name: Saison
                        state_color: true
                        show_name: true
                        show_state: true
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                              margin-top: -35px;
                            }
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
          - type: custom:bubble-card
            card_type: horizontal-buttons-stack
            1_link: '#alert'
            1_icon: mdi:alert-outline
            2_link: '#foudre'
            2_icon: mdi:weather-lightning
            3_link: '#sun'
            3_icon: mdi:sun-clock-outline
            highlight_current_view: true
            hide_gradient: true
            rise_animation: true
            auto_order: true
    cards: []
  - type: sections
    path: lumieres
    max_columns: 2
    title: lumiÃ¨res
    sections:
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-classic-3-alt
            heading: LUMIERES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: phu:rooms-hallway
            heading: EntrÃ©e
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.entree
                color: state
                name: EntrÃ©e
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_entree_etat
            secondary_info: state
            icon_color: deep-orange
            name: EntrÃ©e
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.entree
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.entree' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.entree', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.entree', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.entree', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 12
              rows: 2
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: cover.store_salon
                color: state
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.salon
                icon: hue:flourish-alt
                color: state
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: light.table
                icon: mdi:ceiling-light
                color: state
                state_content: state
            heading: Salon
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_salon_etat
            secondary_info: state
            icon_color: deep-orange
            name: Salon
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.salon
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.salon' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.salon', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.salon', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.salon', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 6
              rows: 2
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_table_etat
            secondary_info: state
            icon_color: deep-orange
            name: Table
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.table
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.table' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.table', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.table', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.table', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 6
              rows: 2
          - type: heading
            icon: mdi:fridge
            heading: Cuisine
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.cuisine
                color: state
                name: 'Cuisine '
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_cuisine_etat
            secondary_info: state
            icon_color: deep-orange
            name: Cuisine
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.cuisine
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.cuisine' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.cuisine', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.cuisine', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.cuisine', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 12
              rows: 2
          - type: heading
            icon: mdi:home-import-outline
            heading: Couloir
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.couloir
                color: state
                name: Couloir
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_couloir_etat
            secondary_info: state
            icon_color: deep-orange
            name: Couloir
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.couloir
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.couloir' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.couloir', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.couloir', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.couloir', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 12
              rows: 2
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-classic-3-alt
            heading: LUMIERES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            heading: Bureau
            grid_options:
              columns: 12
              rows: 1
            badges:
              - type: entity
                entity: sensor.th_bureau_temperature
                color: green
                show_state: true
              - type: entity
                entity: sensor.lumiere_bureau_etat
                icon: hue:flourish-alt
                card_mod:
                  style: |
                    :host {
                      {% set etat = states('sensor.lumiere_bureau_etat') %}
                      {% if etat in ['Bureau', 'AllumÃ©'] %}
                        --label-badge-red: #FFBF00 !important;
                        --ha-label-badge-color: #FFBF00 !important;
                        color: #FFBF00 !important;
                      {% else %}
                        --ha-label-badge-color: grey !important;
                        color: grey !important;
                      {% endif %}
                    }
                    ha-state-icon {
                      color: {% if states('sensor.lumiere_bureau_etat') in ['Bureau', 'AllumÃ©'] %} #FFBF00 {% else %} grey {% endif %} !important;
                    }
              - type: entity
                entity: sensor.lumiere_ecran_etat
                icon: mdi:monitor-dashboard
                card_mod:
                  style: |
                    :host {
                      {% set etat = states('sensor.lumiere_ecran_etat') %}
                      {% if etat == 'Ã‰co.' %}
                        /* Couleur Verte quand Ã‰co. */
                        --label-badge-red: var(--green-color) !important;
                        --ha-label-badge-color: var(--green-color) !important;
                        color: var(--green-color) !important;
                      {% elif etat in ['Ã‰cran', 'AllumÃ©'] %}
                        /* Couleur Ambre pour le reste */
                        --label-badge-red: #FFBF00 !important;
                        --ha-label-badge-color: #FFBF00 !important;
                        color: #FFBF00 !important;
                      {% else %}
                        /* Gris par dÃ©faut */
                        --ha-label-badge-color: grey !important;
                        color: grey !important;
                      {% endif %}
                    }
                    ha-state-icon {
                      {% set etat = states('sensor.lumiere_ecran_etat') %}
                      color: {% if etat == 'Ã‰co.' %} var(--green-color) {% elif etat in ['Ã‰cran', 'AllumÃ©'] %} #FFBF00 {% else %} grey {% endif %} !important;
                    }
              - type: entity
                entity: cover.store_bureau
                color: state
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.lumiere_bureau_etat
                secondary_info: state
                icon_color: deep-orange
                name: Bureau
                tap_action:
                  action: call-service
                  service: light.toggle
                  target:
                    entity_id:
                      - light.hue_white_lamp_bureau_1
                      - light.hue_white_lamp_bureau_2
                layout: horizontal
                card_mod:
                  style:
                    mushroom-shape-icon$: >
                      .shape {
                        {% set trigger_active = states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %}
                        
                        {% if trigger_active %}
                          --shape-animation: flame-core 1.4s infinite;
                          --flame-layer1: flame-layers 1.8s infinite;
                          --flame-layer2: ember-pulse 2.4s infinite;
                          opacity: 1;
                        {% else %}
                          --shape-animation: none;
                          --flame-layer1: none;
                          --flame-layer2: none;
                          opacity: 0.6;
                        {% endif %}

                        position: relative;
                        transform-origin: 50% 75%;
                        animation: var(--shape-animation);
                      }


                      .shape::before, .shape::after {
                        content: "";
                        position: absolute;
                        inset: -8px;
                        border-radius: inherit;
                        pointer-events: none;
                        filter: blur(3px);
                      }

                      .shape::before { animation: var(--flame-layer1); }

                      .shape::after { animation: var(--flame-layer2); }


                      /* Core flame motion: chaotic vertical flicker + heat
                      ripple */
                        @keyframes flame-core {
                          0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                          12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                          25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                          40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                          55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                          70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                          85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                          100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                        }


                        /* Outer flame shape: shifting blurred glow */
                        @keyframes flame-layers {
                          0% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                          33% {
                            box-shadow:
                              0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                              0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                          }
                          66% {
                            box-shadow:
                              0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                              0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                          }
                          100% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                        }


                        /* Ember pulse: slow breathing glow */
                        @keyframes ember-pulse {
                          0% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                          50% {
                            box-shadow:
                              0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                              0 0 90px 35px rgba(255, 150, 0, 0.25);
                          }
                          100% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                        }
                    .: |
                      mushroom-shape-icon {
                        {% set active = states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %}
                        --shape-color: {% if active %} rgba(var(--rgb-deep-orange), 0.2) {% else %} rgba(var(--rgb-disabled), 0.1) {% endif %} !important;
                        --icon-color: {% if active %} rgb(var(--rgb-deep-orange)) {% else %} rgb(var(--rgb-disabled)) {% endif %} !important;
                        --icon-size: 65px;
                        display: flex;
                        margin: -18px 30px -20px !important;
                        padding-right: 20px;
                      }
                      mushroom-state-info {
                        position: absolute !important;
                        top: 27px !important;  
                        left: 137px !important; 
                        text-align: left !important;
                      }
                      ha-card {
                        border: 1px solid {% if states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %} transparent {% else %} grey {% endif %} !important;
                        background-color: {% if states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %} !important;
                        height: 120px !important;
                      }
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    entity: sensor.lumiere_bureau_etat
                    tap_action:
                      action: navigate
                      navigation_path: '#bureau'
                    icon: >
                      {{ 'hue:flourish-alt' if
                      states('sensor.lumiere_bureau_etat') in ['AllumÃ©',
                      'Bureau'] else 'hue:flourish' }}
                    icon_color: >
                      {{ '#FFA000A9' if states('sensor.lumiere_bureau_etat') in
                      ['AllumÃ©', 'Bureau'] else 'grey' }}
                card_mod:
                  style: |
                    ha-card {
                      --chip-border-color: {% if states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %} rgb(255, 160, 0) {% else %} rgba(var(--rgb-disabled), 0.1) {% endif %};
                      background: transparent !important;
                      border: none !important;
                      box-shadow: none !important;
                      margin-left: 180px;
                      bottom: 47px;
                      height: 0px !important;
                    }
            grid_options:
              columns: 6
              rows: 2
            card_mod:
              style: |
                ha-card {
                  background: transparent !important;
                  border: 1px solid {% if states('sensor.lumiere_bureau_etat') in ['AllumÃ©', 'Bureau'] %} transparent {% else %} grey {% endif %};
                  box-shadow: none !important;
                }
          - type: conditional
            conditions:
              - entity: switch.ecran_p_c_3_play_hue
                state: 'on'
            card:
              type: custom:vertical-stack-in-card
              card_mod:
                style: |
                  ha-card {
                    background: transparent !important;
                    border: 1px solid {% if is_state('light.ecrans_pc', 'on') %} transparent {% else %} grey {% endif %};
                    box-shadow: transparent !important;
                  }
              cards:
                - type: custom:mushroom-entity-card
                  entity: sensor.lumiere_ecran_etat
                  secondary_info: state
                  icon_color: deep-orange
                  name: Ecran
                  tap_action:
                    action: call-service
                    service: light.toggle
                    target:
                      entity_id:
                        - light.hue_play_1_pc_bureau
                        - light.hue_play_2_pc_bureau
                        - light.hue_play_3_pc_bureau
                  layout: horizontal
                  card_mod:
                    style:
                      mushroom-shape-icon$: >
                        .shape {
                          {# ========== USER CONFIG ========== #}
                          {# true = number mode, false = state mode #}
                          {% set use_number      = false %}

                          {# STATE MODE SETTINGS #}
                          {% set state_entity    = 'light.ecrans_pc' %}
                          {% set active_value    = 'on' %}

                          {# OPTIONAL: NUMBER MODE SETTINGS #}
                          {% set number_entity   = 'sensor.plug_power' %}
                          
                          {# '>' '<' '=' '>=' '<=' #}
                          {% set number_operator = '>' %}
                          
                          {% set threshold       = 0.0 %}
                          {# ========== END USER CONFIG ====== #}

                          {# ----------- TRIGGER LOGIC ----------- #}
                          {% if use_number %}
                            {% set num = states(number_entity) | float(0) %}
                            {% if number_operator == '>' %}
                              {% set trigger_active = (num > threshold) %}
                            {% elif number_operator == '<' %}
                              {% set trigger_active = (num < threshold) %}
                            {% elif number_operator == '=' %}
                              {% set trigger_active = (num == threshold) %}
                            {% elif number_operator == '>=' %}
                              {% set trigger_active = (num >= threshold) %}
                            {% elif number_operator == '<=' %}
                              {% set trigger_active = (num <= threshold) %}
                            {% else %}
                              {% set trigger_active = false %}
                            {% endif %}
                          {% else %}
                            {% set trigger_active = (states(state_entity) == active_value) %}
                          {% endif %}
                          {# --------- END TRIGGER LOGIC --------- #}

                          {% if trigger_active %}
                            --shape-animation: flame-core 1.4s infinite;
                            --flame-layer1: flame-layers 1.8s infinite;
                            --flame-layer2: ember-pulse 2.4s infinite;
                            opacity: 1;
                          {% else %}
                            --shape-animation: none;
                            --flame-layer1: none;
                            --flame-layer2: none;
                            opacity: 0.6;
                          {% endif %}

                          position: relative;
                          transform-origin: 50% 75%;
                        }


                        /* Flame layers */

                        .shape::before,

                        .shape::after {
                          content: "";
                          position: absolute;
                          inset: -8px;
                          border-radius: inherit;
                          pointer-events: none;
                          filter: blur(3px);
                        }


                        .shape::before {
                          animation: var(--flame-layer1);
                        }


                        .shape::after {
                          animation: var(--flame-layer2);
                        }



                        /* Core flame motion: chaotic vertical flicker + heat
                        ripple */

                        @keyframes flame-core {
                          0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                          12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                          25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                          40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                          55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                          70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                          85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                          100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                        }



                        /* Outer flame shape: shifting blurred glow */

                        @keyframes flame-layers {
                          0% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                          33% {
                            box-shadow:
                              0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                              0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                          }
                          66% {
                            box-shadow:
                              0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                              0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                          }
                          100% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                        }



                        /* Ember pulse: slow breathing glow */

                        @keyframes ember-pulse {
                          0% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                          50% {
                            box-shadow:
                              0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                              0 0 90px 35px rgba(255, 150, 0, 0.25);
                          }
                          100% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                        }
                      .: |
                        mushroom-shape-icon {
                          /* On dÃ©finit les variables directment sur le composant */
                          {% if is_state('light.ecrans_pc', 'on') %}
                            --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                            --icon-color: rgb(var(--rgb-deep-orange)) !important;
                          {% else %}
                            --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                            --icon-color: rgb(var(--rgb-disabled)) !important;
                          {% endif %}
                          
                          --icon-size: 65px;
                          display: flex;
                          margin: -18px 30px -20px !important;
                          padding-right: 20px;
                        }
                        mushroom-state-info {
                          position: absolute !important;
                          top: 27px !important;  
                          left: 137px !important; 
                          text-align: left !important;
                        }
                        ha-card {
                          clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                          border: 1px solid {% if is_state('light.ecrans_pc', 'on') %} transparent {% else %} grey {% endif %};
                          background-color: {% if is_state('light.ecrans_pc', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                          height: 120px !important;
                          width: auto !important;
                        }
                - type: custom:mushroom-chips-card
                  chips:
                    - type: template
                      entity: sensor.lumiere_ecran_etat
                      tap_action:
                        action: navigate
                        navigation_path: '#ecranpc'
                      icon: >
                        {% set actif = states('sensor.lumiere_ecran_etat') in
                        ['Ã‰cran', 'AllumÃ©', 'AllumÃ© & Sync.', 'Synchro.'] %} {{
                        'mdi:monitor-dashboard' if actif else 'mdi:monitor' }}
                      icon_color: >
                        {% set actif = states('sensor.lumiere_ecran_etat') in
                        ['Ã‰cran', 'AllumÃ©', 'AllumÃ© & Sync.', 'Synchro.'] %} {{
                        '#FFA000A9' if actif else 'grey' }}
                  card_mod:
                    style: |
                      ha-card {
                        --chip-border-color: {{ '#FFA000A9' if is_state('light.ecrans_pc', 'on') else 'grey' }};
                        background: transparent !important;
                        border: none !important;
                        box-shadow: none !important;
                        margin-left: 180px;
                        bottom: 47px;
                        height: 0px !important;
                      }
            grid_options:
              columns: 6
              rows: 2
          - type: heading
            icon: mdi:bathtub
            heading: Salle de Bain
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lampe_salle_de_bain_hue
                icon: mdi:ceiling-light
                color: state
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.relais_lumiere_sdb_sonoff
                color: state
                icon: mdi:mirror-rectangle
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_salle_de_bain_etat
            secondary_info: state
            icon_color: deep-orange
            name: Salle de Bain
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.lampe_salle_de_bain_hue
                  - switch.relais_lumiere_sdb_sonoff
            layout: horizontal
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.lampe_salle_de_bain_hue' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.lampe_salle_de_bain_hue', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.lampe_salle_de_bain_hue', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.lampe_salle_de_bain_hue', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
            grid_options:
              columns: 12
              rows: 2
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.chambre
                icon: hue:flourish-alt
                color: state
                state_content: state
          - type: custom:mushroom-entity-card
            entity: sensor.lumiere_chambre_etat
            secondary_info: state
            icon_color: deep-orange
            name: Chambre
            tap_action:
              action: call-service
              service: light.toggle
              target:
                entity_id:
                  - light.chambre
            layout: horizontal
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-shape-icon$: >
                  .shape {
                    {# ========== USER CONFIG ========== #}
                    {# true = number mode, false = state mode #}
                    {% set use_number      = false %}

                    {# STATE MODE SETTINGS #}
                    {% set state_entity    = 'light.chambre' %}
                    {% set active_value    = 'on' %}

                    {# OPTIONAL: NUMBER MODE SETTINGS #}
                    {% set number_entity   = 'sensor.plug_power' %}
                    
                    {# '>' '<' '=' '>=' '<=' #}
                    {% set number_operator = '>' %}
                    
                    {% set threshold       = 0.0 %}
                    {# ========== END USER CONFIG ====== #}

                    {# ----------- TRIGGER LOGIC ----------- #}
                    {% if use_number %}
                      {% set num = states(number_entity) | float(0) %}
                      {% if number_operator == '>' %}
                        {% set trigger_active = (num > threshold) %}
                      {% elif number_operator == '<' %}
                        {% set trigger_active = (num < threshold) %}
                      {% elif number_operator == '=' %}
                        {% set trigger_active = (num == threshold) %}
                      {% elif number_operator == '>=' %}
                        {% set trigger_active = (num >= threshold) %}
                      {% elif number_operator == '<=' %}
                        {% set trigger_active = (num <= threshold) %}
                      {% else %}
                        {% set trigger_active = false %}
                      {% endif %}
                    {% else %}
                      {% set trigger_active = (states(state_entity) == active_value) %}
                    {% endif %}
                    {# --------- END TRIGGER LOGIC --------- #}

                    {% if trigger_active %}
                      --shape-animation: flame-core 1.4s infinite;
                      --flame-layer1: flame-layers 1.8s infinite;
                      --flame-layer2: ember-pulse 2.4s infinite;
                      opacity: 1;
                    {% else %}
                      --shape-animation: none;
                      --flame-layer1: none;
                      --flame-layer2: none;
                      opacity: 0.6;
                    {% endif %}

                    position: relative;
                    transform-origin: 50% 75%;
                  }


                  /* Flame layers */

                  .shape::before,

                  .shape::after {
                    content: "";
                    position: absolute;
                    inset: -8px;
                    border-radius: inherit;
                    pointer-events: none;
                    filter: blur(3px);
                  }


                  .shape::before {
                    animation: var(--flame-layer1);
                  }


                  .shape::after {
                    animation: var(--flame-layer2);
                  }



                  /* Core flame motion: chaotic vertical flicker + heat ripple
                  */

                  @keyframes flame-core {
                    0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                    12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                    25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                    40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                    55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                    70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                    85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                    100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                  }



                  /* Outer flame shape: shifting blurred glow */

                  @keyframes flame-layers {
                    0% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                    33% {
                      box-shadow:
                        0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                        0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                    }
                    66% {
                      box-shadow:
                        0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                        0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                    }
                    100% {
                      box-shadow:
                        0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                        0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                    }
                  }



                  /* Ember pulse: slow breathing glow */

                  @keyframes ember-pulse {
                    0% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                    50% {
                      box-shadow:
                        0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                        0 0 90px 35px rgba(255, 150, 0, 0.25);
                    }
                    100% {
                      box-shadow:
                        0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                        0 0 60px 20px rgba(255, 120, 0, 0.15);
                    }
                  }
                .: |
                  mushroom-shape-icon {
                    /* On dÃ©finit les variables directment sur le composant */
                    {% if is_state('light.chambre', 'on') %}
                      --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                      --icon-color: rgb(var(--rgb-deep-orange)) !important;
                    {% else %}
                      --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                      --icon-color: rgb(var(--rgb-disabled)) !important;
                    {% endif %}
                    
                    --icon-size: 65px;
                    display: flex;
                    margin: -18px 30px -20px !important;
                    padding-right: 20px;
                  }
                  ha-card {
                    clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                    border: 1px solid {% if is_state('light.chambre', 'on') %} transparent {% else %} grey {% endif %};
                    background-color: {% if is_state('light.chambre', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    height: 120px !important;
                    width: auto !important;
                  }
          - type: heading
            icon: mdi:bed
            heading: TÃªtes de Lit
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.zone_eric
                color: state
                icon: hue:wall-impress-narrow
                name: zE
                state_content:
                  - name
                  - state
                  - brightness
              - type: entity
                show_state: true
                show_icon: true
                entity: light.zone_gege
                name: zG
                icon: hue:wall-impress-narrow
                state_content:
                  - name
                  - state
                  - brightness
                color: state
            visibility:
              - condition: state
                entity: switch.prise_tete_de_lit_chambre
                state: 'on'
          - type: conditional
            conditions:
              - entity: switch.prise_tete_de_lit_chambre
                state: 'on'
            card:
              type: custom:vertical-stack-in-card
              card_mod:
                style: |
                  ha-card {
                    background: transparent !important;
                    border: 1px solid {% if is_state('light.lit', 'on') %} transparent {% else %} grey {% endif %};
                    box-shadow: transparent !important;
                  }
              cards:
                - type: custom:mushroom-entity-card
                  entity: sensor.lumiere_tete_de_lit_etat
                  secondary_info: state
                  icon_color: deep-orange
                  name: TÃªte de Lit
                  tap_action:
                    action: call-service
                    service: light.toggle
                    target:
                      entity_id:
                        - light.hue_color_candle_chambre_gege
                        - light.hue_color_candle_chambre_eric
                  layout: horizontal
                  card_mod:
                    style:
                      mushroom-shape-icon$: >
                        .shape {
                          {# ========== USER CONFIG ========== #}
                          {# true = number mode, false = state mode #}
                          {% set use_number      = false %}

                          {# STATE MODE SETTINGS #}
                          {% set state_entity    = 'light.lit' %}
                          {% set active_value    = 'on' %}

                          {# OPTIONAL: NUMBER MODE SETTINGS #}
                          {% set number_entity   = 'sensor.plug_power' %}
                          
                          {# '>' '<' '=' '>=' '<=' #}
                          {% set number_operator = '>' %}
                          
                          {% set threshold       = 0.0 %}
                          {# ========== END USER CONFIG ====== #}

                          {# ----------- TRIGGER LOGIC ----------- #}
                          {% if use_number %}
                            {% set num = states(number_entity) | float(0) %}
                            {% if number_operator == '>' %}
                              {% set trigger_active = (num > threshold) %}
                            {% elif number_operator == '<' %}
                              {% set trigger_active = (num < threshold) %}
                            {% elif number_operator == '=' %}
                              {% set trigger_active = (num == threshold) %}
                            {% elif number_operator == '>=' %}
                              {% set trigger_active = (num >= threshold) %}
                            {% elif number_operator == '<=' %}
                              {% set trigger_active = (num <= threshold) %}
                            {% else %}
                              {% set trigger_active = false %}
                            {% endif %}
                          {% else %}
                            {% set trigger_active = (states(state_entity) == active_value) %}
                          {% endif %}
                          {# --------- END TRIGGER LOGIC --------- #}

                          {% if trigger_active %}
                            --shape-animation: flame-core 1.4s infinite;
                            --flame-layer1: flame-layers 1.8s infinite;
                            --flame-layer2: ember-pulse 2.4s infinite;
                            opacity: 1;
                          {% else %}
                            --shape-animation: none;
                            --flame-layer1: none;
                            --flame-layer2: none;
                            opacity: 0.6;
                          {% endif %}

                          position: relative;
                          transform-origin: 50% 75%;
                        }


                        /* Flame layers */

                        .shape::before,

                        .shape::after {
                          content: "";
                          position: absolute;
                          inset: -8px;
                          border-radius: inherit;
                          pointer-events: none;
                          filter: blur(3px);
                        }


                        .shape::before {
                          animation: var(--flame-layer1);
                        }


                        .shape::after {
                          animation: var(--flame-layer2);
                        }



                        /* Core flame motion: chaotic vertical flicker + heat
                        ripple */

                        @keyframes flame-core {
                          0%   { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                          12%  { transform: translateY(-2px) scale(1.05);  filter: brightness(1.4) hue-rotate(-10deg); }
                          25%  { transform: translateY(1px)  scale(0.98);  filter: brightness(0.9) hue-rotate(8deg); }
                          40%  { transform: translateY(-3px) scale(1.07);  filter: brightness(1.5) hue-rotate(-18deg); }
                          55%  { transform: translateY(0)    scale(1.02);  filter: brightness(1.2) hue-rotate(10deg); }
                          70%  { transform: translateY(-1px) scale(1.04);  filter: brightness(1.35) hue-rotate(-6deg); }
                          85%  { transform: translateY(2px)  scale(0.97);  filter: brightness(0.95) hue-rotate(6deg); }
                          100% { transform: translateY(0)    scale(1);     filter: brightness(1.1) hue-rotate(0deg); }
                        }



                        /* Outer flame shape: shifting blurred glow */

                        @keyframes flame-layers {
                          0% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                          33% {
                            box-shadow:
                              0 0 20px 10px rgba(var(--rgb-{{ config.icon_color }}), 1),
                              0 -16px 30px -8px rgba(255, 160, 0, 0.5);
                          }
                          66% {
                            box-shadow:
                              0 0 18px 9px rgba(var(--rgb-{{ config.icon_color }}), 0.9),
                              0 -8px 20px -6px rgba(255, 220, 0, 0.35);
                          }
                          100% {
                            box-shadow:
                              0 0 14px 8px rgba(var(--rgb-{{ config.icon_color }}), 0.8),
                              0 -12px 24px -6px rgba(255, 200, 0, 0.4);
                          }
                        }



                        /* Ember pulse: slow breathing glow */

                        @keyframes ember-pulse {
                          0% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                          50% {
                            box-shadow:
                              0 0 50px 18px rgba(var(--rgb-{{ config.icon_color }}), 0.5),
                              0 0 90px 35px rgba(255, 150, 0, 0.25);
                          }
                          100% {
                            box-shadow:
                              0 0 30px 10px rgba(var(--rgb-{{ config.icon_color }}), 0.25),
                              0 0 60px 20px rgba(255, 120, 0, 0.15);
                          }
                        }
                      .: |
                        mushroom-shape-icon {
                          /* On dÃ©finit les variables directment sur le composant */
                          {% if is_state('light.lit', 'on') %}
                            --shape-color: rgba(var(--rgb-deep-orange), 0.2) !important;
                            --icon-color: rgb(var(--rgb-deep-orange)) !important;
                          {% else %}
                            --shape-color: rgba(var(--rgb-disabled), 0.1) !important;
                            --icon-color: rgb(var(--rgb-disabled)) !important;
                          {% endif %}
                          
                          --icon-size: 65px;
                          display: flex;
                          margin: -18px 30px -20px !important;
                          padding-right: 20px;
                        }
                        ha-card {
                          clip-path: inset(0 0 0 0 round var(--ha-card-border-radius, 12px));
                          border: 1px solid {% if is_state('light.lit', 'on') %} transparent {% else %} grey {% endif %};
                          background-color: {% if is_state('light.lit', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                          height: 120px !important;
                          width: auto !important;
                        }
                - type: custom:mushroom-chips-card
                  chips:
                    - type: template
                      entity: light.lit
                      tap_action:
                        action: navigate
                        navigation_path: '#tete_de_lit'
                      icon: >-
                        {{ 'mdi:floor-lamp' if is_state('light.lit', 'on') else
                        'mdi:floor-lamp-outline' }}
                      icon_color: >-
                        {{ '#FFA000A9' if is_state('light.lit', 'on') else
                        'grey' }}
                  card_mod:
                    style: |
                      ha-card {
                        --chip-border-color: {{ '#FFA000A9' if is_state('light.lit', 'on') else 'grey' }};
                        background: transparent !important;
                        border: transparent !important;
                        box-shadow: transparent !important;
                        margin-left: 400px;
                        bottom: 80px;
                        height: 0px !important;
                      }
            grid_options:
              columns: 12
              rows: 2
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tete_de_lit'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: TÃªtes de Lit
                icon: mdi:floor-lamp
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                sub_button:
                  main: []
                  bottom: []
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.hue_color_candle_chambre_gege
                    name: TÃªte de Lit GÃ©gÃ©
                    icon: mdi:floor-lamp
                    icon_color: null
                    layout: normal
                    use_light_color: false
                    show_brightness_control: true
                    show_color_temp_control: false
                    show_color_control: false
                    collapsible_controls: false
                    card_mod:
                      style: |
                        ha-card {
                          border: 2px solid {% if is_state('light.hue_color_candle_chambre_gege', 'on') %} #FFA000A9 {% else %} grey {% endif %};
                          background-color: {% if is_state('light.hue_color_candle_chambre_gege', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                        }
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 25% 25% 25% 25%
                      grid-template-rows: 100%
                      grid-template-areas: |
                        "zone1 zone2 zone3 zone4"
                    cards:
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone1
                        label: 25%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 25
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone2
                        label: 50%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 50
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone3
                        label: 75%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 75
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone4
                        label: 100%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 100
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
              - type: custom:mushroom-light-card
                entity: light.hue_color_candle_chambre_eric
                name: TÃªte de Lit Eric
                icon: mdi:floor-lamp
                icon_color: null
                layout: normal
                use_light_color: false
                show_brightness_control: true
                show_color_temp_control: false
                show_color_control: false
                collapsible_controls: false
                card_mod:
                  style: |
                    ha-card {
                      border: 2px solid {% if is_state('light.hue_color_candle_chambre_eric', 'on') %} #FFA000A9 {% else %} grey {% endif %};
                      background-color: {% if is_state('light.hue_color_candle_chambre_eric', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                    }
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  grid-template-columns: 25% 25% 25% 25%
                  grid-template-rows: 100%
                  grid-template-areas: |
                    "zone1 zone2 zone3 zone4"
                cards:
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone1
                    label: 25%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 25
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "rgba(255, 160, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone2
                    label: 50%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 50
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "rgba(255, 160, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone3
                    label: 75%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 75
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "rgba(255, 160, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone4
                    label: 100%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 100
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "rgba(255, 160, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "#FFA000A9";
                              else
                                return "grey";
                            ]]]
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bureau'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Lampes Bureau
                icon: hue:flourish-alt
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                sub_button:
                  main: []
                  bottom: []
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.bureau
                    name: Lampes Bureau
                    icon: hue:flourish-alt
                    icon_color: null
                    layout: normal
                    use_light_color: false
                    show_brightness_control: true
                    show_color_temp_control: false
                    show_color_control: false
                    collapsible_controls: false
                    card_mod:
                      style: |
                        ha-card {
                          border: 2px solid {% if is_state('light.bureau', 'on') %} #FFA000A9 {% else %} grey {% endif %};
                          background-color: {% if is_state('light.bureau', 'on') %} rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                        }
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 25% 25% 25% 25%
                      grid-template-rows: 100%
                      grid-template-areas: |
                        "zone1 zone2 zone3 zone4"
                    cards:
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone1
                        label: 25%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau
                            brightness_pct: 25
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone2
                        label: 50%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau
                            brightness_pct: 50
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone3
                        label: 75%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau
                            brightness_pct: 75
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau'].attributes.brightness;
                                  if (states['light.bureau'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone4
                        label: 100%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau
                            brightness_pct: 100
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  if (states['light.bureau'].state == "on" && states['light.bureau'].attributes.brightness == 255)
                                    return "rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  if (states['light.bureau'].state == "on" && states['light.bureau'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  if (states['light.bureau'].state == "on" && states['light.bureau'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  if (states['light.bureau'].state == "on" && states['light.bureau'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#ecranpc'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Ecrans P.C.
                icon: mdi:television
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                sub_button:
                  main: []
                  bottom: []
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.ecrans_pc
                    name: Ecrans P.C.
                    icon: mdi:television
                    icon_color: null
                    layout: normal
                    use_light_color: false
                    show_brightness_control: true
                    show_color_temp_control: false
                    show_color_control: false
                    collapsible_controls: false
                    card_mod:
                      style: |
                        ha-card {
                          border: 2px solid {% if is_state('light.ecrans_pc', 'on') %} #FFA000A9 {% else %} grey {% endif %};
                          background-color: {% if is_state('light.ecrans_pc', 'on') %}  rgba(255, 160, 0, 0.1) {% else %} transparent {% endif %};
                        }
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 25% 25% 25% 25%
                      grid-template-rows: 100%
                      grid-template-areas: |
                        "zone1 zone2 zone3 zone4"
                    cards:
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone1
                        label: 25%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.ecrans_pc
                            brightness_pct: 25
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return " rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone2
                        label: 50%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.ecrans_pc
                            brightness_pct: 50
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return " rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone3
                        label: 75%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.ecrans_pc
                            brightness_pct: 75
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return " rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.ecrans_pc'].attributes.brightness;
                                  if (states['light.ecrans_pc'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone4
                        label: 100%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.ecrans_pc
                            brightness_pct: 100
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  if (states['light.ecrans_pc'].state == "on" && states['light.ecrans_pc'].attributes.brightness == 255)
                                    return " rgba(255, 160, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  if (states['light.ecrans_pc'].state == "on" && states['light.ecrans_pc'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  if (states['light.ecrans_pc'].state == "on" && states['light.ecrans_pc'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  if (states['light.ecrans_pc'].state == "on" && states['light.ecrans_pc'].attributes.brightness == 255)
                                    return "#FFA000A9";
                                  else
                                    return "grey";
                                ]]]
            grid_options:
              columns: 12
              rows: auto
          - type: custom:streamline-card
            template: nav_bar
      - type: grid
        cards: []
    cards: []
  - title: Temperatures
    path: temperatures
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:thermometer
            heading: TEMPERATURE - HUMIDITEES
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_battery
                color: state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            graph_span: 24h
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: ExtÃ¨rieur
              show_states: true
              colorize_states: true
            yaxis:
              - id: humidity
                min: ~30
                max: ~70
                decimals: 0
                apex_config:
                  tickAmount: 10
              - id: temperature
                min: ~10
                max: ~32
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 30m
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_balcon_nord_humidity
                name: Humi.Bal.Nrd
                yaxis_id: humidity
                type: column
                color: rgb(19,160,255)
              - entity: sensor.vence_temperature
                name: MÃ©tÃ©o VENCE
                yaxis_id: temperature
                stroke_width: 2
                color: orange
              - entity: sensor.th_balcon_nord_temperature
                name: TÂ° Bal.Nrd
                yaxis_id: temperature
                stroke_width: 2
                color: green
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:water-thermometer-outline
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta_affichage
                icon: mdi:delta
                color: primary
                tap_action:
                  action: navigate
                  navigation_path: '#tendances'
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: 'Tendances '
            tap_action:
              action: navigate
              navigation_path: '#exterieur'
          - type: horizontal-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_temperature
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_temperature'') }}Â°C'
                    tap_action:
                      action: navigate
                      navigation_path: '#tcourbe'
                    hold_action:
                      action: none
                    color: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        red
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        blue
                      {% else %}
                        #df6366
                      {% endif %}
                    features_position: bottom
                    card_mod:
                      style: |
                        ha-card {
                          background-color: transparent !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_temperature
                        name: TempÃ©rature
                        color: '#df6366'
                    height: 200
                    hours_to_show: 24
                    decimals: 0
                    points_per_hour: 1
                    line_width: 2
                    font_size: 20
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                      points: false
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_humidity
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_humidity_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif is_state('sensor.th_balcon_nord_humidity_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    icon_color: |
                      {% if is_state('sensor.th_balcon_nord_humidity_trend',
                          'increasing') %}
                            blue
                          {% elif is_state('sensor.th_balcon_nord_humidity_trend',
                          'decreasing') %}
                            #ADD8E6
                          {% else %}
                            #00CED1
                          {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_humidity'') }}%'
                    layout: horizontal
                    tap_action:
                      action: navigate
                      navigation_path: '#hcourbe'
                    hold_action:
                      action: none
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_humidity
                        name: HumiditÃ©
                        color: '#00CED1'
                    height: 200
                    hours_to_show: 24
                    decimals: 0
                    points_per_hour: 1
                    line_width: 2
                    font_size: 20
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                      points: false
                    card_mod:
                      style: |
                        ha-card {
                         background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  height: 228px;
                  margin-left: auto;
                  margin-right: auto;
                }
          - type: heading
            icon: mdi:lightning-bolt-outline
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Consomation
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: sensor.salon_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_salon_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_salon_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Salon: {% if is_state('sensor.clim_salon_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.cuisine_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: |
                    {% if is_state('sensor.radiateur_cuisine_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Cuisine: {% if is_state('sensor.radiateur_cuisine_etat',
                    'Heat') %}
                      Heat
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.bureau_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_bureau_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_bureau_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Bureau: {% if is_state('sensor.clim_bureau_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.sdb_soufflant_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heat-wave
                  icon_color: |
                    {% if is_state('sensor.soufflant_sdb_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.soufflant_sdb_etat', 'off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Salle de Bain: {% if is_state('sensor.soufflant_sdb_etat',
                    'Heat') %}
                      Heat
                    {% else %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.sdb_seche_serviette_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: >
                    {% if is_state('sensor.sdb_seche_serviette_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.sdb_seche_serviette_etat', 'off')
                    %}
                      #FF0000
                    {% endif %}
                  content: >
                    Salle de Bain: {% if
                    is_state('sensor.sdb_seche_serviette_etat', 'Heat') %}
                      Heat
                    {% else %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.chambre_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_chambre_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_chambre_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Chambre: {% if is_state('sensor.clim_chambre_etat', 'Heat')
                    %}
                      Heat
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
            alignment: center
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: true
            span:
              start: day
              offset: '-0h'
            apex_config:
              chart:
                height: 400px
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: temperature
                min: ~10
                max: ~32
                decimals: 2
                apex_config:
                  tickAmount: 10
              - id: conso_clim
                min: ~150
                max: auto
                opposite: true
                decimals: 2
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 60m
              show:
                legend_value: false
            series:
              - entity: sensor.temperature_moyenne_interieure
                name: TÌ„ Appart.
                yaxis_id: temperature
                stroke_width: 4
                fill_raw: last
                color: orange
                show:
                  extremas: true
              - entity: sensor.th_balcon_nord_temperature
                name: TÂ° Bal.Nrd
                yaxis_id: temperature
                stroke_width: 4
                fill_raw: last
                color: green
                show:
                  extremas: true
              - entity: sensor.conso_clim_rad_total
                name: Conso. Instan.
                yaxis_id: conso_clim
                type: column
                opacity: 0.6
                fill_raw: last
                color: rgb(68,115,158)
                unit: W
                group_by:
                  func: max
                  duration: 1h
                  start_with_last: true
              - entity: sensor.conso_clim_rad_total_quotidien
                name: Conso. Total
                color: rgb(68,115,158)
                unit: kWh
                show:
                  in_brush: false
                  in_chart: false
              - entity: sensor.clim_rad_total_avg_watts_daily
                name: Moy.depuis Minuit
                yaxis_id: conso_clim
                type: line
                stroke_width: 2
                color: red
                unit: W
                show:
                  in_brush: false
                  in_chart: true
              - entity: sensor.conso_clim_rad_total_mensuel
                name: Mois en cours
                color: '#F44336'
                show:
                  in_brush: false
                  in_chart: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;   
                  box-shadow: none !important;
                  border: none !important;
                  font-size: 12px;
                }
          - type: heading
            icon: mdi:thermometer
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: RÃ©cap. TempÃ©ratures
          - type: custom:apexcharts-card
            graph_span: 24h
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: Salon / Cellier / Cuisine / Bureau / SdB / Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: TH
                min: ~10
                max: ~32
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 1h
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_salon_temperature
                name: Salon
                color: rgb(202, 135, 135)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cellier_temperature
                name: Cellier
                color: skyblue
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cuisine_temperature
                name: Cuisine
                color: rgb(162, 148, 249)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_bureau_temperature
                name: Bureau
                color: orange
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_salle_de_bain_temperature
                name: Salle de bain
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_chambre_temperature
                name: Chambre
                color: rgb(177, 194, 158)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:water
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: RÃ©cap. HumiditÃ©e
          - type: custom:apexcharts-card
            graph_span: 24h
            update_interval: 1m
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: Salon / Cellier / Cuisine / Bureau / SdB / Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: humidity
                min: ~30
                max: ~75
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 1h
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_salon_humidity
                name: Salon
                color: rgb(202, 135, 135)
                yaxis_id: humidity
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cellier_humidity
                name: Cellier
                color: skyblue
                yaxis_id: humidity
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cuisine_humidity
                name: Cuisine
                color: rgb(162, 148, 249)
                yaxis_id: humidity
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_bureau_humidity
                name: Bureau
                color: orange
                yaxis_id: humidity
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_salle_de_bain_humidity
                name: Salle de bain
                yaxis_id: humidity
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_chambre_humidity
                name: Chambre
                color: rgb(177, 194, 158)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_salon_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
                state_content:
                  - name
                  - state
                name: Salon
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
            tap_action:
              action: navigate
              navigation_path: '#salon'
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_salon_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_salon_rm4_mini
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Salon
              temperature_entity: sensor.th_salon_temperature
              humidity_entity: sensor.th_salon_humidity
              margin_top: '-150'
              icon: mdi:sofa
          - type: heading
            icon: mdi:food-variant
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cellier_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CELLIER
            tap_action:
              action: navigate
              navigation_path: '#cellier'
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Cellier
              temperature_entity: sensor.th_cellier_temperature
              humidity_entity: sensor.th_cellier_humidity
              icon: mdi:food-variant
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                icon: mdi:power
                color: state
                tap_action:
                  action: toggle
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
                name: Cuisine
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CUISINE  (RADIATEUR)
            tap_action:
              action: navigate
              navigation_path: '#cuisine'
          - type: custom:bubble-card
            card_type: climate
            entity: climate.radiateur_cuisine
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.radiateur_cuisine
            icon: ''
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Radiateur de la Cuisine
            styles: |
              ha-card {
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Cuisine
              temperature_entity: sensor.th_cuisine_temperature
              humidity_entity: sensor.th_cuisine_humidity
              icon: mdi:fridge
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_bureau_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
                name: Bureau
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: BUREAU
            tap_action:
              action: navigate
              navigation_path: '#bureau'
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_bureau_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_du_bureau
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Bureau
              temperature_entity: sensor.th_bureau_temperature
              humidity_entity: sensor.th_bureau_humidity
              icon: mdi:desktop-tower-monitor
          - type: heading
            icon: mdi:bathtub
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                name: Salle de Bain
                state_content:
                  - name
                  - state
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALLE DE BAIN
            tap_action:
              action: navigate
              navigation_path: '#salle_de_bain'
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Salle de Bain
              temperature_entity: sensor.th_salle_de_bain_temperature
              humidity_entity: sensor.th_salle_de_bain_humidity
              icon: mdi:bathtub
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_chambre_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                name: Chambre
                state_content:
                  - name
                  - state
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CHAMBRE
            tap_action:
              action: navigate
              navigation_path: '#chambre'
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_chambre_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_chambre_rm4_mini
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Chambre
              temperature_entity: sensor.th_chambre_temperature
              humidity_entity: sensor.th_chambre_humidity
              icon: mdi:bed
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tendances'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CALCUL DU DELTA IntÃ©rieur <-> ExtÃ©rieur
                icon: mdi:delta
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: calcule_temp_cible
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#exterieur'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° EXTÃ‰RIEUR
                icon: mdi:sun-thermometer-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:temperature-heatmap-card
                entity: sensor.th_balcon_nord_temperature
                title: Carte des TÂ° EXTÃ‰RIEUR
                month_label: true
                day_label: true
                footer: true
                day_trend: true
                day_forecast: true
                forecast_entity: weather.vence
                force_fahrenheit: false
                temp_adj: 0
                decimal_point: true
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#salon'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DU SALON
                icon: mdi:sofa
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_salon_temperature
                  card_title: Carte des TÂ° du SALON
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cellier'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DU CELLIER
                icon: mdi:food-variant
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_cellier_temperature
                  card_title: Carte des TÂ° du CELLIER
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cuisine'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DE LA CUISINE
                icon: mdi:fridge
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_cuisine_temperature
                  card_title: Carte des TÂ° de la CUISINE
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bureau'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DU BUREAU
                icon: mdi:desktop-tower-monitor
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_bureau_temperature
                  card_title: Carte des TÂ° du BUREAU
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#salle_de_bain'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DE LA SALLE DE BAIN
                icon: mdi:bathtub
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_salle_de_bain_temperature
                  card_title: Carte des TÂ° de la SALLE DE BAIN
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#chambre'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: SUIVI DES TÂ° DE LA CHAMBRE
                icon: mdi:bed
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: carte_des_temperatures
                variables:
                  entity: sensor.th_chambre_temperature
                  card_title: Carte des TÂ° de la CHAMBRE
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tcourbe'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Tendance (TÂ°)
                icon: mdi:thermometer-check
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: horizontal-stack
                cards:
                  - type: custom:vertical-stack-in-card
                    cards:
                      - type: custom:mushroom-template-card
                        entity: sensor.th_balcon_nord_temperature
                        icon: >
                          {% if
                          is_state('sensor.th_balcon_nord_temperature_trend',
                          'increasing') %}
                            mdi:arrow-top-right-thick
                          {% elif
                          is_state('sensor.th_balcon_nord_temperature_trend',
                          'decreasing') %}
                            mdi:arrow-bottom-right-thick
                          {% else %}
                            mdi:arrow-right-thick
                          {% endif %}
                        primary: ''
                        secondary: '{{ states(''sensor.th_balcon_nord_temperature'') }}Â°C'
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        color: >
                          {% if
                          is_state('sensor.th_balcon_nord_temperature_trend',
                          'increasing') %}
                            red
                          {% elif
                          is_state('sensor.th_balcon_nord_temperature_trend',
                          'decreasing') %}
                            blue
                          {% else %}
                            #df6366
                          {% endif %}
                        features_position: bottom
                        card_mod:
                          style: |
                            ha-card {
                              background-color: transparent !important;
                              border: none !important;
                            }
                            mushroom-state-info$: |
                              .primary {
                                font-size: 12px !important;
                                color: lightgrey !important;
                                position: relative;
                                bottom: 5px;
                                left: 5px;
                                overflow: visible !important;
                                white-space: normal !important;
                              }
                              .secondary {
                                font-size: 19px !important;
                                position: relative;
                                overflow: visible !important;
                                top: 0px;
                                left: 5px;
                              }
                            mushroom-shape-icon$: |
                              .shape {
                                position: relative;
                                left: 0px;
                                top: 0px;
                              }
                            .: |
                              :host {
                                --mush-icon-size: 50px;
                              }
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.th_balcon_nord_temperature
                            name: TempÃ©rature
                            color: '#df6366'
                        height: 300
                        hours_to_show: 24
                        decimals: 1
                        points_per_hour: 1
                        line_width: 2
                        font_size: 85
                        hour24: true
                        animate: true
                        show:
                          labels: true
                          name: false
                          icon: false
                          state: true
                          legend: true
                          extrema: true
                          fill: fade
                          points: true
                          loading_indicator: false
                        card_mod:
                          style: |
                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                            }
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      height: 300px;
                      margin-left: auto;
                      margin-right: auto;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#hcourbe'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Tendance (HumitidÃ©e %)
                icon: mdi:water-check
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: horizontal-stack
                cards:
                  - type: custom:vertical-stack-in-card
                    cards:
                      - type: custom:mushroom-template-card
                        entity: sensor.th_balcon_nord_humidity
                        icon: >
                          {% if is_state('sensor.th_balcon_nord_humidity_trend',
                          'increasing') %}
                            mdi:arrow-top-right-thick
                          {% elif
                          is_state('sensor.th_balcon_nord_humidity_trend',
                          'decreasing') %}
                            mdi:arrow-bottom-right-thick
                          {% else %}
                            mdi:arrow-right-thick
                          {% endif %}
                        primary: ''
                        secondary: '{{ states(''sensor.th_balcon_nord_humidity'') }}Â°C'
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        color: >
                          {% if is_state('sensor.th_balcon_nord_humidity_trend',
                          'increasing') %}
                            blue
                          {% elif
                          is_state('sensor.th_balcon_nord_humidity_trend',
                          'decreasing') %}
                            #ADD8E6
                          {% else %}
                            #00CED1
                          {% endif %}
                        features_position: bottom
                        card_mod:
                          style: |
                            ha-card {
                              background-color: transparent !important;
                              border: none !important;
                            }
                            mushroom-state-info$: |
                              .primary {
                                font-size: 12px !important;
                                color: lightgrey !important;
                                position: relative;
                                bottom: 5px;
                                left: 5px;
                                overflow: visible !important;
                                white-space: normal !important;
                              }
                              .secondary {
                                font-size: 19px !important;
                                position: relative;
                                overflow: visible !important;
                                top: 0px;
                                left: 5px;
                              }
                            mushroom-shape-icon$: |
                              .shape {
                                position: relative;
                                left: 0px;
                                top: 0px;
                              }
                            .: |
                              :host {
                                --mush-icon-size: 50px;
                              }
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.th_balcon_nord_humidity
                            name: TempÃ©rature
                            color: '#00CED1'
                        height: 300
                        hours_to_show: 24
                        decimals: 1
                        points_per_hour: 1
                        line_width: 2
                        font_size: 85
                        hour24: true
                        animate: true
                        show:
                          labels: true
                          name: false
                          icon: false
                          state: true
                          legend: true
                          extrema: true
                          fill: fade
                          points: true
                          loading_indicator: false
                        card_mod:
                          style: |
                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                            }
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      height: 300px;
                      margin-left: auto;
                      margin-right: auto;
                    }
    cards: []
  - type: sections
    path: clim
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-snowflake
            heading: CLIM.  / RADIATEUR
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta_affichage
                tap_action:
                  action: navigate
                  navigation_path: '#calcul'
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: conditional
            conditions:
              - condition: or
                conditions:
                  - condition: state
                    entity: sensor.salon_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.cuisine_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.bureau_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.sdb_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.sdb_seche_serviettes_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.chambre_power_status_affichage
                    state_not: 'off'
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: Consomation TOTAL Climatisations & Radiateurs
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: sensor.salon_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: >-
                    {% if is_state('sensor.clim_salon_etat', 'Cool') %} #87CEEB

                    {% elif is_state('sensor.clim_salon_etat', 'Heat') %}
                    #ff6100

                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %} #40E0D0

                    {% else %} #FF0000 {% endif %}
                  content: 'Salon: {{ states(''sensor.clim_salon_etat'') }}'
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.cuisine_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: >-
                    {% if is_state('sensor.radiateur_cuisine_etat', 'Heat') %}
                    #ff6100

                    {% else %} #FF0000 {% endif %}
                  content: 'Cuisine: {{ states(''sensor.radiateur_cuisine_etat'') }}'
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.bureau_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: >-
                    {% if is_state('sensor.clim_bureau_etat', 'Cool') %} #87CEEB

                    {% elif is_state('sensor.clim_bureau_etat', 'Heat') %}
                    #ff6100

                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                    #40E0D0

                    {% else %} #FF0000 {% endif %}
                  content: 'Bureau: {{ states(''sensor.clim_bureau_etat'') }}'
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.sdb_soufflant_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heat-wave
                  icon_color: >-
                    {% if is_state('sensor.sdb_soufflant_power_etat', 'Heat') %}
                    #ff6100

                    {% else %} #FF0000 {% endif %}
                  content: >-
                    SdB Soufflant: {{ states('sensor.sdb_soufflant_power_etat')
                    }}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - condition: state
                    entity: sensor.sdb_seche_serviette_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: >-
                    {% if is_state('sensor.sdb_seche_serviette_etat', 'Heat') %}
                    #ff6100

                    {% else %} #FF0000 {% endif %}
                  content: >-
                    SdB Serviette: {{ states('sensor.sdb_seche_serviette_etat')
                    }}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.chambre_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: >-
                    {% if is_state('sensor.clim_chambre_etat', 'Cool') %}
                    #87CEEB

                    {% elif is_state('sensor.clim_chambre_etat', 'Heat') %}
                    #ff6100

                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                    #40E0D0

                    {% else %} #FF0000 {% endif %}
                  content: 'Chambre: {{ states(''sensor.clim_chambre_etat'') }}'
                  tap_action:
                    action: none
            alignment: center
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt-outline
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.conso_clim_rad_total
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.conso_clim_rad_total
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur du SALON
          - type: custom:stack-in-card
            mode: vertical
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            cards:
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_salon_arret_securise_en_cours
                    state: 'on'
                  - entity: sensor.salon_power_lock
                    state: 'on'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: rgb(234, 67, 53);
                          --text-divider-line-size: 5px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: âš ï¸ Clim SALON en cours d'arrÃªt âš ï¸
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_salon_arret_securise_en_cours
                    state: 'off'
                  - entity: switch.clim_salon_nous
                    state: 'off'
                  - entity: sensor.salon_power_status_affichage
                    state: 'off'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: #FFA000; /* EMBER */
                          --text-divider-line-size: 3px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: La prise extÃ©rieur "CLIM SALON" est coupÃ©e
          - type: heading
            icon: mdi:sofa
            heading: Clim. Salon
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: remote.clim_salon
                color: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_salon_week
                name: Sem.
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_salon_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_salon_nous
                icon: mdi:power
                color: state
                tap_action:
                  action: call-service
                  service: script.j_1_routeur_clim_on_off_intelligent
                  service_data:
                    piece: salon
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog-clim-salon
          - type: thermostat
            entity: climate.clim_salon_rm4_mini
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: dropdown
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - quiet
                  - high
                  - med
                  - low
            name: Clim SALON (+1Â°)
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_salon_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_salon_nous_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Radiateur Ã©lectrique de la CUISINE
          - type: heading
            icon: mdi:fridge
            heading: Rad. Cuisine
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                color: state
                icon: mdi:power
                tap_action:
                  action: toggle
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_radiateur_cuisine_week
                color: state
                state_content: name
                name: Sem.
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_radiateur_cuisine_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                icon: mdi:power
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog-radiateur-cuisine
          - type: thermostat
            entity: climate.radiateur_cuisine
            features:
              - type: climate-hvac-modes
            show_current_as_primary: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.radiateur_elec_cuisine_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.radiateur_elec_cuisine_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur du BUREAU
          - type: custom:stack-in-card
            mode: vertical
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            cards:
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_bureau_arret_securise_en_cours
                    state: 'on'
                  - entity: sensor.bureau_power_lock
                    state: 'on'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: rgb(234, 67, 53);
                          --text-divider-line-size: 5px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: âš ï¸ Clim BUREAU en cours d'arrÃªt âš ï¸
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_bureau_arret_securise_en_cours
                    state: 'off'
                  - entity: switch.clim_bureau_nous
                    state: 'off'
                  - entity: sensor.bureau_power_status_affichage
                    state: 'off'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: #FFA000;
                          --text-divider-line-size: 3px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: La prise extÃ©rieur "CLIM BUREAU" est coupÃ©e
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading: clim. Bureau
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: remote.clim_bureau
                color: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_bureau_week
                name: Sem.
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_bureau_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_bureau_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_bureau_nous
                icon: mdi:power
                color: state
                tap_action:
                  action: call-service
                  service: script.j_1_routeur_clim_on_off_intelligent
                  service_data:
                    piece: bureau
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog-clim-bureau
          - type: thermostat
            entity: climate.clim_bureau_rm4_mini
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: dropdown
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - comfort
                  - breeze
                  - level1
                  - level2
                  - level3
                  - level4
                  - level5
                  - powerful
            name: Clim du BUREAU (-1Â°)
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_bureau_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_bureau_nous_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Chauffage Salle de Bain
          - type: heading
            icon: mdi:bathtub
            heading: Radiateur SdB
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: remote.soufflant_sdb_rm4_mini
                color: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_soufflant_salle_de_bain_week
                name: Sem.
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_soufflant_salle_de_bain_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.prise_soufflant_salle_de_bain_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.prise_soufflant_salle_de_bain_nous
                color: state
                icon: mdi:power
                tap_action:
                  action: toggle
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog-soufflant-sdb
          - type: thermostat
            entity: climate.soufflant_salle_de_bain
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - heat
            show_current_as_primary: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:button-card
            entity: sensor.statut_soufflant_sdb
            triggers_update:
              - sensor.statut_soufflant_sdb
              - switch.inter_soufflant_salle_de_bain
              - input_select.etat_resistance_soufflant_sdb
              - sensor.th_salle_de_bain_temperature
            show_name: true
            show_icon: true
            show_state: true
            show_label: true
            name: Soufflant SDB
            visible: |
              [[[
                return states['switch.inter_soufflant_salle_de_bain'].state === 'on';
              ]]]
            icon: |
              [[[
                const power = states['input_select.etat_resistance_soufflant_sdb'].state;
                if (power === '2000W') return 'mdi:radiator';
                if (power === '1000W') return 'mdi:radiator';
                if (power === '0W') return 'mdi:fan';
                return 'mdi:radiator-off';
              ]]]
            styles:
              card:
                - background: rgba(68, 115, 158, 0.1)
                - border-radius: 12px
                - padding: 12px
                - box-shadow: none
              grid:
                - grid-template-areas: '"i n" "i s" "i l"'
                - grid-template-columns: 50px 1fr
                - grid-template-rows: min-content min-content min-content
              icon:
                - width: 40px
                - color: |
                    [[[
                      const power = states['input_select.etat_resistance_soufflant_sdb'].state;
                      if (power === '2000W') return '#ff9800';
                      if (power === '1000W') return '#fdd835';
                      if (power === '0W') return '#2196f3';
                      return '#44739e';
                    ]]]
                - animation: |
                    [[[
                      const power = states['input_select.etat_resistance_soufflant_sdb'].state;
                      if (power !== '0W') return 'blink 2s ease infinite';
                      return 'none';
                    ]]]
              name:
                - font-size: 14px
                - font-weight: 500
                - color: var(--primary-text-color)
                - justify-self: start
                - align-self: center
              state:
                - font-size: 16px
                - font-weight: bold
                - justify-self: start
                - color: |
                    [[[
                      const power = states['input_select.etat_resistance_soufflant_sdb'].state;
                      if (power === '2000W') return '#ff9800';
                      if (power === '1000W') return '#fdd835';
                      if (power === '0W') return '#2196f3';
                      return '#44739e';
                    ]]]
              label:
                - font-size: 12px
                - color: var(--secondary-text-color)
                - justify-self: start
            state_display: |
              [[[
                return states['input_select.etat_resistance_soufflant_sdb'].state;
              ]]]
            label: |
              [[[
                const temp = parseFloat(states['sensor.th_salle_de_bain_temperature'].state).toFixed(1);
                const target = parseFloat(states['climate.soufflant_salle_de_bain'].attributes.temperature).toFixed(1);
                const delta = (temp - target).toFixed(1);
                const sign = delta >= 0 ? '+' : '';
                return `${temp}Â°C (${sign}${delta}Â°C)`;
              ]]]
            tap_action:
              action: more-info
            extra_styles: |
              @keyframes blink {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.4; }
              }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.prise_soufflant_salle_de_bain_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.prise_soufflant_salle_de_bain_nous_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  margin-top: 25px;
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur de la CHAMBRE
          - type: custom:stack-in-card
            mode: vertical
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            cards:
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_chambre_arret_securise_en_cours
                    state: 'on'
                  - entity: sensor.chambre_power_lock
                    state: 'on'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: rgb(234, 67, 53);
                          --text-divider-line-size: 5px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: âš ï¸ Clim CHAMBRE en cours d'arrÃªt âš ï¸
              - type: conditional
                conditions:
                  - entity: input_boolean.clim_chambre_arret_securise_en_cours
                    state: 'off'
                  - entity: switch.clim_chambre_nous
                    state: 'off'
                  - entity: sensor.chambre_power_status_affichage
                    state: 'off'
                card:
                  type: custom:mod-card
                  card_mod:
                    style:
                      .: |
                        :host {
                          --text-divider-color: #FFA000; /* EMBER */
                          --text-divider-line-size: 3px;
                        }
                  card:
                    type: custom:text-divider-row
                    text: La prise extÃ©rieur "CLIM CHAMBRE" est coupÃ©e
          - type: heading
            icon: mdi:bed
            heading: clim. Chambre
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: remote.clim_chambre
                color: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_de_la_chambre_week
                color: state
                name: Sem.
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_de_la_chambre_week_end
                state_content: name
                color: state
                name: Week-End
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_chambre_nous
                icon: mdi:power
                color: state
                tap_action:
                  action: call-service
                  service: script.j_1_routeur_clim_on_off_intelligent
                  service_data:
                    piece: chambre
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog-clim-chambre
          - type: thermostat
            entity: climate.clim_chambre_rm4_mini
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: dropdown
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - breeze
                  - powerful
                  - level1
                  - level2
                  - level3
                  - level4
                  - level5
            name: Clim de la CHAMBRE
            show_current_as_primary: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_chambre_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_chambre_nous_power
                above: 0.1
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#calcul'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CALCUL DU DELTA IntÃ©rieur <-> ExtÃ©rieur
                icon: mdi:delta
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: calcule_temp_cible
          - type: custom:streamline-card
            template: nav_bar
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Seuil de Non Chauffage Bas
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: 25% 25% 25% 25%
              grid-template-rows: auto
              grid-template-areas: |
                "zone1 zone2 zone3 zone4"
            cards:
              - type: custom:button-card
                view_layout:
                  grid-area: zone1
                entity: input_number.seuil_non_chauffage_bas
                name: 15Â°
                show_name: true
                show_icon: true
                icon: mdi:thermometer-low
                tap_action:
                  action: call-service
                  service: input_number.set_value
                  service_data:
                    entity_id: input_number.seuil_non_chauffage_bas
                    value: 15
                styles:
                  card:
                    - aspect-ratio: 1/0.5
                    - border-width: 1px
                    - border-color: |
                        [[[
                          if (entity.state == 15) return "green";
                          else return "grey";
                        ]]]
                    - background-color: |
                        [[[
                          if (entity.state == 15) return "rgba(0, 255, 0, 0.1)";
                          else return "transparent";
                        ]]]
                  icon:
                    - color: |
                        [[[
                          if (entity.state == 15) return "green";
                          else return "grey";
                        ]]]
                  name:
                    - font-weight: bold
                    - color: |
                        [[[
                          if (entity.state == 15) return "green";
                          else return "grey";
                        ]]]
              - type: custom:button-card
                view_layout:
                  grid-area: zone2
                entity: input_number.seuil_non_chauffage_bas
                name: 16Â°
                show_name: true
                show_icon: true
                icon: mdi:thermometer
                tap_action:
                  action: call-service
                  service: input_number.set_value
                  service_data:
                    entity_id: input_number.seuil_non_chauffage_bas
                    value: 16
                styles:
                  card:
                    - aspect-ratio: 1/0.5
                    - border-width: 1px
                    - border-color: |
                        [[[
                          if (entity.state == 16) return "green";
                          else return "grey";
                        ]]]
                    - background-color: |
                        [[[
                          if (entity.state == 16) return "rgba(0, 255, 0, 0.1)";
                          else return "transparent";
                        ]]]
                  icon:
                    - color: |
                        [[[
                          if (entity.state == 16) return "green";
                          else return "grey";
                        ]]]
                  name:
                    - font-weight: bold
                    - color: |
                        [[[
                          if (entity.state == 16) return "green";
                          else return "grey";
                        ]]]
              - type: custom:button-card
                view_layout:
                  grid-area: zone3
                entity: input_number.seuil_non_chauffage_bas
                name: 17Â°
                show_name: true
                show_icon: true
                icon: mdi:thermometer
                tap_action:
                  action: call-service
                  service: input_number.set_value
                  service_data:
                    entity_id: input_number.seuil_non_chauffage_bas
                    value: 17
                styles:
                  card:
                    - aspect-ratio: 1/0.5
                    - border-width: 1px
                    - border-color: |
                        [[[
                          if (entity.state == 17) return "green";
                          else return "grey";
                        ]]]
                    - background-color: |
                        [[[
                          if (entity.state == 17) return "rgba(0, 255, 0, 0.1)";
                          else return "transparent";
                        ]]]
                  icon:
                    - color: |
                        [[[
                          if (entity.state == 17) return "green";
                          else return "grey";
                        ]]]
                  name:
                    - font-weight: bold
                    - color: |
                        [[[
                          if (entity.state == 17) return "green";
                          else return "grey";
                        ]]]
              - type: custom:button-card
                view_layout:
                  grid-area: zone4
                entity: input_number.seuil_non_chauffage_bas
                name: 18Â°
                show_name: true
                show_icon: true
                icon: mdi:thermometer-high
                tap_action:
                  action: call-service
                  service: input_number.set_value
                  service_data:
                    entity_id: input_number.seuil_non_chauffage_bas
                    value: 18
                styles:
                  card:
                    - aspect-ratio: 1/0.5
                    - border-width: 1px
                    - border-color: |
                        [[[
                          if (entity.state == 18) return "green";
                          else return "grey";
                        ]]]
                    - background-color: |
                        [[[
                          if (entity.state == 18) return "rgba(0, 255, 0, 0.1)";
                          else return "transparent";
                        ]]]
                  icon:
                    - color: |
                        [[[
                          if (entity.state == 18) return "green";
                          else return "grey";
                        ]]]
                  name:
                    - font-weight: bold
                    - color: |
                        [[[
                          if (entity.state == 18) return "green";
                          else return "grey";
                        ]]]
    title: Clim
    cards: []
  - type: sections
    max_columns: 2
    title: prog clim salon
    path: prog-clim-salon
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sofa
            heading: CLIM. DU SALON
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                name:
                  type: area
                color: green
                state_content:
                  - name
                  - state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - climate.clim_salon_rm4_mini
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Salon
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Salon Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_salon_week', 'weekdays') |
                  join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_salon_week
                    name: Programmation Climatisation Salon Semaine
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week' %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week' %} {%
                  set current_slot = state_attr(entity_id, 'current_slot') %} {%
                  set next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement** {% if next_trigger is not none
                  %} Ã  {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Salon Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_salon_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_salon_week_end
                    name: Programmation Climatisation Salon Week-end
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week_end' %}
                  {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                   <br> <br> <br>
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week_end' %}
                  {% set current_slot = state_attr(entity_id, 'current_slot') %}
                  {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} Ã  {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 2
    title: PROG RADIATEUR CUISINE
    path: prog-radiateur-cuisine
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:fridge
            heading: RADIATEUR CUISINE
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                name:
                  type: area
                color: green
                state_content:
                  - name
                  - state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - person
              - person.eric
              - climate.radiateur_cuisine
            exclude: []
            discover_existing: true
            title: Planificateur Radiateur Cuisine
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Radiateur de la Cuisine Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_radiateur_cuisine_week',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_radiateur_cuisine_week
                    name: Programmation Radiateur Cuisine Semaine
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_radiateur_cuisine_week' %}
                  {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {% if actions[i].data is defined and actions[i].data.temperature is defined %} {{ actions[i].data.temperature }}Â°C {% else %} Non dÃ©fini {% endif %} -> Mode: {% if actions[i].data is defined and actions[i].data.hvac_mode is defined %} {{ actions[i].data.hvac_mode }} {% else %} Non dÃ©fini {% endif %} {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_radiateur_cuisine_week' %}
                  {% set current_slot = state_attr(entity_id, 'current_slot') %}
                  {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {% if actions[current_slot].data
                  is defined and actions[current_slot].data.temperature is
                  defined %} {{ actions[current_slot].data.temperature }}Â°C {%
                  else %} Non dÃ©fini {% endif %} -> Mode: {% if
                  actions[current_slot].data is defined and
                  actions[current_slot].data.hvac_mode is defined %} {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %} {% else %} Non dÃ©fini {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {% if actions[next_slot].data is
                  defined and actions[next_slot].data.temperature is defined %}
                  {{ actions[next_slot].data.temperature }}Â°C {% else %} Non
                  dÃ©fini {% endif %} -> Mode: {% if actions[next_slot].data is
                  defined and actions[next_slot].data.hvac_mode is defined %} {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %} {% else %} Non dÃ©fini {% endif %}

                  <br> **Prochain dÃ©clenchement** {% if next_trigger is not none
                  %} Ã  {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Radiateur Cuisine Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_radiateur_cuisine_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_radiateur_cuisine_week_end
                    name: Programmation radiateur Cuisine Week-end
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_radiateur_cuisine_week_end' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :**  {% for i in
                  range(timeslots | length)%} 

                  - **{{ timeslots[i] }}** -> {% if actions[i].data is defined
                  and actions[i].data.temperature is defined %} {{
                  actions[i].data.temperature }}Â°C {% else %} Non dÃ©fini {%
                  endif %} -> Mode: {% if actions[i].data is defined and
                  actions[i].data.hvac_mode is defined %} {{
                  actions[i].data.hvac_mode }} {% else %} Non dÃ©fini {% endif %}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_radiateur_cuisine_week_end' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {% if actions[current_slot].data
                  is defined and actions[current_slot].data.temperature is
                  defined %} {{ actions[current_slot].data.temperature }}Â°C {%
                  else %} Non dÃ©fini {% endif %} -> Mode: {% if
                  actions[current_slot].data is defined and
                  actions[current_slot].data.hvac_mode is defined %} {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %} {% else %} Non dÃ©fini {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {% if actions[next_slot].data is
                  defined and actions[next_slot].data.temperature is defined %}
                  {{ actions[next_slot].data.temperature }}Â°C {% else %} Non
                  dÃ©fini {% endif %} -> Mode: {% if actions[next_slot].data is
                  defined and actions[next_slot].data.hvac_mode is defined %} {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %} {% else %} Non dÃ©fini {% endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} Ã  {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 2
    title: prog clim bureau
    path: prog-clim-bureau
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading: CLIM. DU BUREAU
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                name:
                  type: area
                color: green
                state_content:
                  - name
                  - state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - person
              - person.eric
              - climate.clim_bureau_rm4_mini
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Bureau
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Bureau Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_bureau_week', 'weekdays')
                  | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_bureau_week
                    name: Programmation Climatisation Bureau Semaine
                show_header_toggle: false
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }    
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week' %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week' %} {%
                  set current_slot = state_attr(entity_id, 'current_slot') %} {%
                  set next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non     
                  dÃ©fini {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement** {% if next_trigger is not none
                  %} Ã  {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Bureau Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_bureau_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_bureau_week_end
                    name: Programmation Climatisation Bureau Week-end
                state_color: true
                show_header_toggle: false
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }    
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week_end'
                  %} {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                   <br> <br> <br>
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week_end'
                  %} {% set current_slot = state_attr(entity_id, 'current_slot')
                  %} {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %} 

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} Ã  {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 4
    title: prog soufflant sdb
    path: prog-soufflant-sdb
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:bathtub
            heading: Soufflant Salle de Bain
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                name:
                  type: area
                color: green
                state_content:
                  - name
                  - state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - climate.soufflant_salle_de_bain
            exclude: []
            discover_existing: true
            title: Planificateur Soufflant Salle de Bain
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Soufflant SdB Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_soufflant_salle_de_bain_week',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_soufflant_salle_de_bain_week
                    name: Programmation Soufflant SdB Semaine
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_soufflant_salle_de_bain_week' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_soufflant_salle_de_bain_week' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} Ã  {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Soufflant SdB Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_soufflant_salle_de_bain_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_soufflant_salle_de_bain_week_end
                    name: Programmation Souflant SdB Week-End
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }   
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_soufflant_salle_de_bain_week_end' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_soufflant_salle_de_bain_week_end' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  <br><br><br> **CrÃ©neau actuel :** {% if current_slot is not
                  none %} {{ timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} Ã  {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
        column_span: 2
  - type: sections
    max_columns: 2
    title: prog clim chambre
    path: prog-clim-chambre
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:bed
            heading: CLIM. DE LA CHAMBRE
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                name:
                  type: area
                color: green
                state_content:
                  - name
                  - state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - climate.clim_chambre_rm4_mini
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Chambre
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim de la Chambre Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_de_la_chambre_week',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_de_la_chambre_week
                    name: Programmation Climatisation Chambre Semaine
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_de_la_chambre_week'
                  %} {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_de_la_chambre_week'
                  %} {% set current_slot = state_attr(entity_id, 'current_slot')
                  %} {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} Ã  {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim de la Chambre Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_de_la_chambre_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_de_la_chambre_week_end
                    name: Programmation Climatisation Chambre Week-End
                state_color: true
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }   
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_clim_de_la_chambre_week_end' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **CrÃ©neaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}Â°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_clim_de_la_chambre_week_end' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  <br><br><br> **CrÃ©neau actuel :** {% if current_slot is not
                  none %} {{ timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}Â°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non dÃ©fini
                  {% endif %}

                  <br> **Prochain crÃ©neau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}Â°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non dÃ©fini {%
                  endif %}

                  <br> **Prochain dÃ©clenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} Ã  {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  dÃ©fini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
        column_span: 2
    cards: []
  - title: Stores
    path: stores
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:window-shutter
            heading: STORES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0px 0px -20px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: CONDITIONS
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: ''
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_temperature
                color: green
            heading: Auto close at +34Â°
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -18px 0px 0px 165px;

                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: STORE SALON
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -40px 0px 0px 0px;
                  padding: 0;
                }
            type: heading
            icon: phu:sliding-window-door-close
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.contact_fenetre_salon_sonoff_contact
                color: green
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.contact_fenetre_salon_sonoff_battery
                color: state
                tap_action:
                  action: more-info
            heading: FenÃªtre Salon
          - type: vertical-stack
            cards:
              - type: custom:enhanced-shutter-card
                entities:
                  - entity: cover.store_salon
                    name: Salon
                    name_disabled: true
                    opening_disabled: true
                    passive_mode: false
                    resize_height_pct: 100
                    resize_width_pct: 130
                    title_position: bottom
                    opening_position: bottom
                    inline_header: true
                    view_image: ' '
                    buttons_position: left
                    signal_entity: sensor.store_salon_signal_strength
                    shutter_slat_image: esc-shutter-slat.png
                    shutter_bottom_image: esc-shutter-bottom.png
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: -55px 0px 0px 0px;
                    }
              - type: custom:button-card
                entity: sensor.store_salon_status
                entities:
                  - sensor.store_salon_status
                  - cover.store_salon
                triggers_update:
                  - sensor.store_salon_status
                  - cover.store_salon
                show_name: false
                show_icon: false
                show_state: true
                styles:
                  card:
                    - background: transparent
                    - border: none
                    - box-shadow: none
                    - margin-top: '-40px'
                    - height: 30px
                  state:
                    - font-size: 14px
                    - justify-self: center
                state_display: |
                  [[[
                    return 'Salon : ' + entity.state;
                  ]]]
              - type: horizontal-stack
                cards:
                  - type: custom:button-card
                    name: 100%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 100
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid white
                        - border-radius: 5px
                        - padding: 10px
                        - height: 40px
                      name:
                        - color: white
                        - font-size: 12px
                        - font-weight: bold
                  - type: custom:button-card
                    name: 75%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 85
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid white
                        - border-radius: 5px
                        - padding: 10px
                        - height: 40px
                      name:
                        - color: white
                        - font-size: 12px
                        - font-weight: bold
                  - type: custom:button-card
                    name: 50%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 70
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid white
                        - border-radius: 5px
                        - padding: 10px
                        - height: 40px
                      name:
                        - color: white
                        - font-size: 12px
                        - font-weight: bold
                  - type: custom:button-card
                    name: 25%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 49
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid white
                        - border-radius: 5px
                        - padding: 10px
                        - height: 40px
                      name:
                        - color: white
                        - font-size: 12px
                        - font-weight: bold
                  - type: custom:button-card
                    name: 10%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 20
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid white
                        - border-radius: 5px
                        - padding: 10px
                        - height: 40px
                      name:
                        - color: white
                        - font-size: 12px
                        - font-weight: bold
          - type: custom:mushroom-light-card
            entity: light.smart_roller_shutter_2309261223820570080348e1e9dc6401_dnd
            grid_options:
              columns: full
              rows: 1
            primary_info: name
            secondary_info: state
            fill_container: true
            use_light_color: false
            tap_action:
              action: toggle
            icon: phu:roller-shutter-switch
            icon_color: green
            icon_type: icon
            hold_action:
              action: none
            double_tap_action:
              action: none
            name: Store Salon (Voyants commandes)
            card_mod:
              style: |
                ha-card {
                  background: transparent;
                  border: transparent;
                }
          - type: heading
            icon: mdi:window-shutter
            heading: STORES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0px 0px -20px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: CONDITIONS
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: ''
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_temperature
                color: green
            heading: Auto open at +18Â° or auto close at +25Â°
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 90px;
                  padding: 0;
                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: STORE BUREAU
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: phu:sliding-window-door-close
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.contact_fenetre_bureau_sonoff_contact
                color: green
                state_content: state
                icon: mdi:door-open
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.contact_fenetre_bureau_sonoff_battery
                color: state
                tap_action:
                  action: more-info
            heading: FenÃªtre Bureau
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -40px 0px 0px 0px;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: custom:enhanced-shutter-card
                entities:
                  - entity: cover.store_bureau
                    name: Bureau
                    name_disabled: true
                    opening_disabled: true
                    passive_mode: false
                    resize_height_pct: 100
                    resize_width_pct: 130
                    title_position: bottom
                    opening_position: bottom
                    inline_header: true
                    view_image: ' '
                    buttons_position: left
                    signal_entity: sensor.store_bureau_signal_strength
                    shutter_slat_image: esc-shutter-slat.png
                    shutter_bottom_image: esc-shutter-bottom.png
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      border: none !important;
                      box-shadow: none !important;
                      margin: -55px 0px 0px 0px;
                    }
              - type: custom:button-card
                entity: sensor.store_bureau_status
                entities:
                  - sensor.store_bureau_status
                  - cover.store_bureau
                triggers_update:
                  - sensor.store_bureau_status
                  - cover.store_bureau
                show_name: false
                show_icon: false
                show_state: true
                styles:
                  card:
                    - background: transparent
                    - border: none
                    - box-shadow: none
                    - margin-top: '-40px'
                    - height: 30px
                  state:
                    - font-size: 14px
                    - justify-self: center
                state_display: |
                  [[[
                    return 'Bureau : ' + entity.state;
                  ]]]
              - type: horizontal-stack
                cards:
                  - type: custom:button-card
                    name: 100%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 100
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 75%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 90
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 50%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 60
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 25%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 45
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 10%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 25
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
          - type: custom:mushroom-light-card
            entity: light.smart_roller_shutter_2309266337793570080348e1e9dc5a17_dnd
            grid_options:
              columns: full
              rows: 1
            primary_info: name
            secondary_info: state
            fill_container: true
            use_light_color: false
            tap_action:
              action: toggle
            icon: phu:roller-shutter-switch
            icon_color: green
            icon_type: icon
            hold_action:
              action: none
            double_tap_action:
              action: none
            name: Store Bureau (Voyants commandes)
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
          - type: custom:streamline-card
            template: nav_bar
    cards: []
  - type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE HOME
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.ecojoko_consommation_temps_reel
                color: green
                state_content:
                  - name
                  - state
                name: RÃ©el
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie-temps-reel
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.ecojoko_consommation_reseau
                color: green
                state_content:
                  - name
                  - state
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie-mensuel
                name: Cumul Jrs
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: Appartement
            icon: mdi:home-assistant
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - square: false
            type: grid
            columns: 3
            cards:
              - type: custom:ring-tile
                entity: sensor.conso_mini
                name: Conso. Mini.
                ring_entity: sensor.conso_mini
                ring_type: open
                ring_size: 3
                scale: ticks_with_labels
                middle_element: value_with_unit
                bottom_element: name
                colorize_icon: true
                indicator: dot
                min: 0
                max: 100
                max_decimals: 0
                colour:
                  '0': green
                  '40': green
                  '50': orange
                  '65': orange
                  '75': red
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      align-items: center;
                      justify-content: center;      
                      transform: scale(0.90);
                      margin: 0px 0px 0px 0px;
                    }        
              - type: custom:ring-tile
                entity: sensor.ecojoko_consommation_temps_reel
                name: Conso. Temps RÃ©el
                ring_entity: sensor.ecojoko_consommation_temps_reel
                ring_type: open
                ring_size: 3
                scale: ticks_with_labels
                middle_element: value_with_unit
                bottom_element: name
                colorize_icon: true
                indicator: dot
                min: 0
                max: 6000
                max_decimals: 0
                colour:
                  '0': green
                  '1700': green
                  '2000': orange
                  '3700': orange
                  '4000': red
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      align-items: center;
                      justify-content: center;      
                      transform: scale(0.90);
                      margin: 0px 0px 0px 0px;
                    }
              - type: custom:ring-tile
                entity: sensor.conso_maxi
                name: Conso. Maxi.
                ring_entity: sensor.conso_maxi
                ring_type: open
                ring_size: 3
                scale: ticks_with_labels
                middle_element: value_with_unit
                bottom_element: name
                colorize_icon: true
                indicator: dot
                min: 0
                max: 6000
                max_decimals: 0
                colour:
                  '0': green
                  '1700': green
                  '2000': orange
                  '3700': orange
                  '4000': red
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      align-items: center;
                      justify-content: center;      
                      transform: scale(0.90);
                      margin: 0px 0px 0px 0px;
                    }  
          - type: vertical-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:energy-overview-card
                    entities:
                      - power: sensor.ecojoko_consommation_reseau
                        current: sensor.ecojoko_consommation_temps_reel
                        label_leading: Enedis
                        label_trailing: Maison
                        icon_leading: mdi:transmission-tower
                        icon_trailing: mdi:home-lightning-bolt
                        color: '#488fc2'
                        animation:
                          power: 1000
                          min_duration: 1
                          max_duration: 5
                    card_mod:
                      style: |
                        :host {
                          --card-mod-icon-color: #488fc2;
                          --mdc-icon-size: 20px;
                        }
                        ha-card {
                          font-weight: bold;
                          background: transparent;
                        }
                card_mod:
                  style: |
                    ha-card {
                      --text-divider-color: rgb(68, 115, 158);
                      --text-divider-line-size: 3px;
                      --text-divider-font-size: 15px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            grid_options:
              columns: 24
              rows: auto
          - type: custom:bubble-card
            card_type: separator
            name: Ratio Mois A-1 / Semaine derniÃ¨re  / A-1
            icon: mdi:percent
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: true
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: false
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: false
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            grid_options:
              columns: 4
              rows: auto
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: false
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: true
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: false
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            grid_options:
              columns: 4
              rows: auto
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: false
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: false
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: true
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            grid_options:
              columns: 4
              rows: auto
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: CoÃ»t Mensuel et Quotidien
            icon: mdi:currency-eur
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: sensor.ecojoko_consommation_reseau
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: Total Mois
                icon: mdi:lightning-bolt-outline
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hp_reseau_cost
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: H.P. Mois
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hc_reseau_cost
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: H.C. Mois
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                    .icon {
                      color: white !important;
                    }

                     
            grid_options:
              columns: 36
              rows: auto
          - type: custom:apexcharts-card
            chart_type: pie
            graph_span: 24h
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 200px
              legend:
                show: false
            header:
              show: true
              title: Conso. journaliÃ¨re H.P./H.C. sur 24h.
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.ecojoko_consommation_hp_reseau
                name: Heure pleine
                color: rgb(211, 58, 79)
              - entity: sensor.ecojoko_consommation_hc_reseau
                name: Heure creuse
                color: rgb(72, 132, 213)
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: sensor.ecojoko_consommation_reseau
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: Total Jours
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hp_reseau_cost
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: H.P. Jours
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hc_reseau_cost
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: H.C. Jours
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                    .icon {
                      color: white !important;
                    }

                     
          - type: custom:bubble-card
            card_type: separator
            name: Conso. rÃ©el sur 24 Heures
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: false
            apex_config:
              chart:
                height: 400px
              legend:
                show: true
            span:
              start: day
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: TempsReel
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 20
              - id: Minuit
                min: 0
                max: '|+30|'
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 20
            all_series_config:
              group_by:
                func: last
                duration: 10m
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.ecojoko_consommation_temps_reel
                yaxis_id: TempsReel
                name: conso. en temps rÃ©el
                color: green
                type: area
                stroke_width: 1
              - entity: sensor.ecojoko_consommation_temps_reel
                name: Moy. glissante (24h)
                yaxis_id: TempsReel
                unit: W
                color: red
                type: line
                stroke_width: 1
                group_by:
                  func: avg
                  duration: 24h
              - entity: sensor.ecojoko_avg_watts_daily
                yaxis_id: Minuit
                name: Moy. depuis minuit
                unit: Wh
                color: '#FF5252'
                type: line
                stroke_width: 1.5
              - entity: sensor.ecojoko_avg_watts_monthly
                name: Moy. 1er du mois
                unit: Wh
                show:
                  in_chart: false
                  in_header: true
                opacity: 0
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: Energie Totale consommÃ©e sur 7 Jours
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 24h
            cache: true
            span:
              end: day
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              show_states: true
              colorize_states: true
              title: ' '
            apex_config:
              chart:
                height: 450px
                type: area
              stroke:
                show: true
              dataLabels:
                enabled: true
              legend:
                show: true
              fill:
                type: gradient
                gradient:
                  inverseColors: true
                  type: vertical
                  shadeIntensity: 0.1
                  opacityFrom: 0.5
                  opacityTo: 0.15
                  stops:
                    - 0
                    - 50
                    - 100
              grid:
                show: true
              tooltip:
                'y':
                  formatter: >
                    EVAL:(val) => (val === null || isNaN(val)) ? '' :
                    `${Number(val).toFixed(1)} kWh`
            all_series_config:
              group_by:
                func: last
                duration: 10m
              curve: smooth
              type: area
            yaxis:
              - id: kWh
                min: 0
                max: auto
                decimals: 1
                opposite: true
                apex_config:
                  tickAmount: 20
            series:
              - entity: sensor.ecojoko_consommation_reseau
                color: gainsboro
                extend_to: false
                name: (Aujourd'hui)
                unit: kWh
                stroke_width: 3
                float_precision: 2
                show:
                  legend_value: false
                  extremas: max
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(204, 255, 204)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-1d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(153, 255, 153)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-2d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(102, 255, 102)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-3d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(51, 204, 51)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-4d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 153, 0)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-5d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 102, 0)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-6d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 70, 0)
                extend_to: false
                name: ' '
                unit: kWh
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-7d'
            card_mod:
              style: |
                div#state__value {
                  font-size: 8.5px;
                }
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: CoÃ»t totale par Jours (hors Abo.)
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            type: custom:flex-table-card
            entities:
              - entity: sensor.linky_jour_0
              - entity: sensor.linky_jour_1
              - entity: sensor.linky_jour_2
              - entity: sensor.linky_jour_3
              - entity: sensor.linky_jour_4
              - entity: sensor.linky_jour_5
              - entity: sensor.linky_jour_6
              - entity: sensor.linky_jour_7
            columns:
              - name: Jour
                data: jour
                align: left
              - name: Total (kWh)
                data: total_kwh
                align: center
              - name: CoÃ»t (â‚¬)
                data: cout
                align: center
              - name: HP (kWh)
                data: hp_kwh
                align: center
              - name: HC (kWh)
                data: hc_kwh
                align: center
          - type: custom:bubble-card
            card_type: separator
            name: Conso. Mensuel par Jours
            icon: mdi:lightning-bolt-outline
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            graph_span: 31d
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 400px
              legend:
                show: true
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: daily
                min: ~0
                max: auto
                apex_config:
                  tickAmount: 10
              - id: moyenne
                min: ~0
                max: ~500
                decimals: 0
                show: false
                opposite: true
            all_series_config:
              group_by:
                func: last
                duration: 24h
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.ecojoko_energy_daily
                yaxis_id: daily
                name: Conso. ce jour
                color: rgb(68,115,158)
                type: column
                unit: kWh
                group_by:
                  func: max
                  duration: 24h
              - entity: sensor.ecojoko_consommation_reseau
                yaxis_id: daily
                type: line
                color: red
                stroke_width: 3
                name: Moy. glissante (Mois)
                group_by:
                  func: avg
                  duration: 730h
              - entity: sensor.ecojoko_avg_watts_daily
                yaxis_id: moyenne
                type: line
                color: '#FF5252'
                stroke_width: 1.5
                name: Moy. depuis minuit
                unit: Wh
              - entity: sensor.ecojoko_avg_watts_monthly
                name: Moy. 1er du Mois
                unit: Wh
                show:
                  in_chart: false
                  in_header: true
                opacity: 0
                yaxis_id: daily
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:auto-entities
            card:
              type: custom:bar-card
              title: SYNTHÃˆSE USAGES ( Jour en cours )
              height: 35px
              decimal: 2
              unit_of_measurement: kWh
              min: 0
              max: sensor.max_conso_quotidien_dynamique
              positions:
                icon: inside
                indicator: inside
                name: inside
                value: inside
              card_mod:
                style: |
                  bar-card-value {
                    font-size: 14px;
                    font-weight: bold;
                    margin-right: 10px;
                  }
                  bar-card-title {
                    font-size: 15px;
                    font-weight: bold;
                    padding-bottom: 10px;
                    text-align: left;
                    padding-left: 10px;
                  }
                  bar-card-currentbar, bar-card-backgroundbar {
                      height: 4px !important;
                      border-radius: 4px;
                      margin-top: 24px;
                  }
                  ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      border-radius: 10px !important;
                      padding: 10px !important;
                  }
                  ha-icon {
                    color: white !important;
                    padding-bottom: 15px;
                  }
                  bar-card-name {
                    padding-bottom: 15px;
                    font-weight: bold;
                  }
            filter:
              include:
                - entity_id: sensor.diag_poste_1_hygiene_quotidien
                  options:
                    name: HygiÃ¨ne
                    icon: mdi:water
                    color: '#00BFFF'
                - entity_id: sensor.diag_poste_2_cuisson_quotidien
                  options:
                    name: Cuisson
                    icon: mdi:stove
                    color: '#FF4500'
                - entity_id: sensor.diag_poste_3_froid_quotidien
                  options:
                    name: Froid
                    icon: mdi:snowflake
                    color: '#87CEEB'
                - entity_id: sensor.diag_poste_4_chauffage_quotidien
                  options:
                    name: Chauffage
                    icon: mdi:fire
                    color: '#FFA500'
                - entity_id: sensor.diag_poste_5_multimedia_quotidien
                  options:
                    name: Multimedia
                    icon: mdi:desktop-tower-monitor
                    color: '#9370DB'
                - entity_id: sensor.diag_poste_6_lumiere_quotidien
                  options:
                    name: LumiÃ¨re
                    icon: mdi:lightbulb
                    color: '#ADFF2F'
                - entity_id: sensor.diag_poste_7_autres_quotidien
                  options:
                    name: Autres
                    icon: mdi:account
                    color: lightgrey
            sort:
              method: state
              numeric: true
              reverse: true
          - type: custom:auto-entities
            card:
              type: custom:apexcharts-card
              chart_type: donut
              graph_span: 24h
              header:
                show: true
                title: RÃ©partition consommation aujourd'hui
                show_states: true
                colorize_states: true
              apex_config:
                chart:
                  height: 400px
                legend:
                  show: false
                dataLabels:
                  enabled: true
                  formatter: |
                    EVAL:function(val) {
                      return val.toFixed(1) + "%";
                    }
                tooltip:
                  'y':
                    formatter: |
                      EVAL:function(val) {
                        return val.toFixed(2) + " kWh";
                      }
              card_mod:
                style: |
                  div#state__value {
                  font-size: 10px;
                  }
                  ha-card {
                    background: none !important;
                    box-shadow: none !important;
                    border: none !important;
                  }
            filter:
              include:
                - entity_id: sensor.diag_poste_1_hygiene_quotidien
                  options:
                    name: HygiÃ¨ne
                    color: '#00BFFF'
                - entity_id: sensor.diag_poste_2_cuisson_quotidien
                  options:
                    name: Cuisson
                    color: '#FF4500'
                - entity_id: sensor.diag_poste_3_froid_quotidien
                  options:
                    name: Froid
                    color: '#87CEEB'
                - entity_id: sensor.diag_poste_4_chauffage_quotidien
                  options:
                    name: Chauffage
                    color: '#FFA500'
                - entity_id: sensor.diag_poste_5_multimedia_quotidien
                  options:
                    name: Multimedia
                    color: '#9370DB'
                - entity_id: sensor.diag_poste_6_lumiere_quotidien
                  options:
                    name: LumiÃ¨re
                    color: '#ADFF2F'
                - entity_id: sensor.diag_poste_7_autres_quotidien
                  options:
                    name: Autres
                    color: lightgrey
              options:
                group_by:
                  func: last
                  duration: 24h
            sort:
              method: state
              reverse: true
              numeric: true
          - type: custom:auto-entities
            card:
              type: custom:bar-card
              title: SYNTHÃˆSE USAGES ( Mois en cours )
              height: 35px
              decimal: 2
              unit_of_measurement: kWh
              min: 0
              max: sensor.max_conso_mensuelle_dynamique
              positions:
                icon: inside
                indicator: inside
                name: inside
                value: inside
              card_mod:
                style: |
                  bar-card-value {
                    font-size: 14px;
                    font-weight: bold;
                    margin-right: 10px;
                  }
                  bar-card-title {
                    font-size: 15px;
                    font-weight: bold;
                    padding-bottom: 10px;
                    text-align: left;
                    padding-left: 10px;
                    color: white;
                  }
                  bar-card-currentbar, bar-card-backgroundbar {
                      height: 4px !important;
                      border-radius: 4px;
                      margin-top: 24px;
                  }
                  ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      border-radius: 10px !important;
                      padding: 10px !important;
                  }
                  ha-icon {
                    color: white !important;
                    padding-bottom: 15px;
                  }
                  bar-card-name {
                    padding-bottom: 15px;
                    font-weight: bold;
                    color: white;
                  }
            filter:
              include:
                - entity_id: sensor.diag_poste_1_hygiene_mensuel
                  options:
                    name: HygiÃ¨ne
                    icon: mdi:water
                    color: '#00BFFF'
                - entity_id: sensor.diag_poste_2_cuisson_mensuel
                  options:
                    name: Cuisson
                    icon: mdi:stove
                    color: '#FF4500'
                - entity_id: sensor.diag_poste_3_froid_mensuel
                  options:
                    name: Froid
                    icon: mdi:snowflake
                    color: '#87CEEB'
                - entity_id: sensor.diag_poste_4_chauffage_mensuel
                  options:
                    name: Chauffage
                    icon: mdi:fire
                    color: '#FFA500'
                - entity_id: sensor.diag_poste_5_multimedia_mensuel
                  options:
                    name: Multimedia
                    icon: mdi:desktop-tower-monitor
                    color: '#9370DB'
                - entity_id: sensor.diag_poste_6_lumiere_mensuel
                  options:
                    name: LumiÃ¨re
                    icon: mdi:lightbulb
                    color: '#ADFF2F'
                - entity_id: sensor.diag_poste_7_autres_mensuel
                  options:
                    name: Autres
                    icon: mdi:account
                    color: lightgrey
            sort:
              method: state
              numeric: true
              reverse: true
          - type: custom:auto-entities
            card:
              type: custom:apexcharts-card
              chart_type: donut
              graph_span: 24h
              header:
                show: true
                title: RÃ©partition Consommation mois en cours
                show_states: true
                colorize_states: true
              apex_config:
                chart:
                  height: 400px
                legend:
                  show: false
                dataLabels:
                  enabled: true
                  formatter: |
                    EVAL:function(val) {
                      return val.toFixed(1) + "%";
                    }
                tooltip:
                  'y':
                    formatter: |
                      EVAL:function(val) {
                        return val.toFixed(2) + " kWh";
                      }
              card_mod:
                style: |
                  div#state__value {
                  font-size: 10px;
                  }
                  ha-card {
                    background: none !important;
                    box-shadow: none !important;
                    border: none !important;
                  }
            filter:
              include:
                - entity_id: sensor.diag_poste_1_hygiene_mensuel
                  options:
                    name: HygiÃ¨ne
                    color: '#00BFFF'
                - entity_id: sensor.diag_poste_2_cuisson_mensuel
                  options:
                    name: Cuisson
                    color: '#FF4500'
                - entity_id: sensor.diag_poste_3_froid_mensuel
                  options:
                    name: Froid
                    color: '#87CEEB'
                - entity_id: sensor.diag_poste_4_chauffage_mensuel
                  options:
                    name: Chauffage
                    color: '#FFA500'
                - entity_id: sensor.diag_poste_5_multimedia_mensuel
                  options:
                    name: Multimedia
                    color: '#9370DB'
                - entity_id: sensor.diag_poste_6_lumiere_mensuel
                  options:
                    name: LumiÃ¨re
                    color: '#ADFF2F'
                - entity_id: sensor.diag_poste_7_autres_mensuel
                  options:
                    name: Autres
                    color: lightgrey
              options:
                group_by:
                  func: diff
                  duration: 24h
            sort:
              method: state
              reverse: true
              numeric: true
        column_span: 1
    title: Energie HOME
    cards: []
    path: energie
  - type: sections
    max_columns: 1
    title: Energie HOME Temps RÃ©el
    path: energie-temps-reel
    sections:
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:lightning-bolt
                heading: Temps RÃ©Ã©l
                heading_style: title
                badges:
                  - type: entity
                    show_state: true
                    show_icon: true
                    entity: sensor.ecojoko_consommation_temps_reel
                    name: RÃ©el
                    color: green
                    state_content:
                      - name
                      - state
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: 1
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: >
                      :host {
                        --ha-card-border-color: transparent !important;
                        --card-background-color: none !important;
                      }

                      ha-card {
                          font-weight: bold;
                          --mdc-icon-size: 25px;
                          --paper-item-icon-color: white;
                      }

                      bar-card-currentbar {
                          border-radius: 10px;
                      }

                      bar-card-currentbar, bar-card-current,
                      bar-card-backgroundbar {

                      height: 6px !important;

                      margin-top: 34px;

                      }
                filter:
                  exclude:
                    - options: {}
                      entity_id: ^sensor.oneplus*power$
                    - options: {}
                      entity_id: ^sensor.eclairage*$
                    - options: {}
                      entity_id: ^sensor.lampe*ikea*power$
                    - options: {}
                      entity_id: ^*hue*$
                    - options: {}
                      entity_id: ^*poco*$
                    - options: {}
                      entity_id: ^*device*$
                    - options: {}
                      entity_id: ^*relais*$
                    - options: {}
                      entity_id: sensor.entree_freebox_pop_power
                    - options: {}
                      entity_id: sensor.freebox_v8_r1_power
                    - options: {}
                      entity_id: sensor.nvidia_nvidia_geforce_rtx_3060_gpu_package_power
                    - options: {}
                      state: unavailable
                    - options: {}
                      state: unknown
                    - options: {}
                      state: <= 0.999
                  include:
                    - options: {}
                      entity_id: ^sensor.*power$
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightbulb-outline
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: 1
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 0.99
                    - color: rgb(102, 255, 102)
                      from: 1
                      to: 4.99
                    - color: rgb(0, 102, 0)
                      from: 5
                      to: 9.99
                    - color: orange
                      from: 10
                      to: 14.99
                    - color: red
                      from: 15
                      to: 19.99
                  card_mod:
                    style: >
                      :host {
                        --ha-card-border-color: transparent !important;
                        --card-background-color: none !important;
                      }

                      ha-card {
                          font-weight: bold;
                          --mdc-icon-size: 25px;
                          --paper-item-icon-color: white;
                      }

                      bar-card-currentbar {
                          border-radius: 10px;
                      }

                      bar-card-currentbar, bar-card-current,
                      bar-card-backgroundbar {

                      height: 6px !important;

                      margin-top: 34px;

                      }
                filter:
                  exclude:
                    - options: {}
                      last_updated: 1m ago
                    - options: {}
                      state: <= 1
                    - options: {}
                      state: unavailable
                  include:
                    - options: {}
                      entity_id: ^*relais*power$
                    - options: {}
                      entity_id: sensor.lampe_salle_de_bain_hue_power
                    - options: {}
                      entity_id: ^sensor.hue*power$
                    - options: {}
                      entity_id: ^sensor.lampe*ikea*power$
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                show_empty: true
          - type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                chart_type: donut
                cache: true
                apex_config:
                  chart:
                    height: 580px
                header:
                  show: true
                  title: Conso. journaliÃ¨re (Cumul depuis Minuit )
                  show_states: true
                  colorize_states: true
                all_series_config:
                  show:
                    legend_value: false
                    extremas: false
                show:
                  loading: true
                  last_updated: false
                series:
                  - entity: sensor.prise_box_internet_ikea_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Box (+)
                    color: gainsboro
                  - entity: sensor.prise_horloge_ikea_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Horloge (+)
                    color: rgb(183, 183, 183)
                  - entity: sensor.prise_pc_s_gege_ikea_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: PCg
                    color: rgb(202, 135, 135)
                  - entity: sensor.prise_salon_chargeur_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Charge (+)
                    color: rgb(174, 68, 90)
                  - entity: sensor.prise_four_micro_ondes_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Four M.O. (+)
                    color: rgb(98, 78, 136)
                  - entity: sensor.prise_petit_dejeune_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: P'tit Dej. (+)
                    color: rgb(118, 93, 160)
                  - entity: sensor.prise_lave_linge_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Linge
                    color: rgb(137, 103, 179)
                  - entity: sensor.prise_lave_vaisselle_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Vaisselle
                    color: rgb(129, 116, 180)
                  - entity: sensor.prise_airfryer_ninja_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Airfryer (+)
                    color: rgb(142, 122, 181)
                  - entity: sensor.four_et_plaque_de_cuisson_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Four/Plq.
                    color: rgb(162, 148, 249)
                  - entity: sensor.prise_frigo_cuisine_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Frigo
                    color: cyan
                  - entity: sensor.prise_congelateur_cuisine_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: CongÃ©l.
                    color: rgb(19, 160, 255)
                  - entity: sensor.prise_bureau_pc_ikea_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: PCe
                    color: orange
                  - entity: sensor.prise_bureau_fer_a_repasser_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: FÃ R (+)
                    color: gold
                  - entity: sensor.prise_tete_de_lit_chambre_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: TÃªtes L. (+)
                    color: rgb(177, 194, 158)
                  - entity: sensor.prise_tv_chambre_nous_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: TV (+)
                    color: rgb(30, 81, 40)
                  - entity: sensor.all_standby_quotidien_kwh_um
                    transform: return x * 1000;
                    unit: Wh
                    name: Veilles
                    color: grey
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                graph_span: 24h
                cache: false
                update_interval: 1m
                apex_config:
                  chart:
                    height: 300px
                header:
                  show: true
                  title: Conso. InstantanÃ©e
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Watts
                    min: 0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: last
                    duration: 10m
                  show:
                    legend_value: false
                    extremas: true
                series:
                  - entity: sensor.prise_box_internet_ikea_power
                    name: Box (+)
                    color: gainsboro
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_horloge_ikea_power
                    name: Horloge (+)
                    color: rgb(183, 183, 183)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_pc_s_gege_ikea_power
                    name: PCg
                    color: rgb(202, 135, 135)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_salon_chargeur_nous_power
                    name: Charge (+)
                    color: rgb(174,68,90)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_four_micro_ondes_nous_power
                    name: Four M.O. (+)
                    color: rgb(98, 78, 136)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_petit_dejeune_nous_power
                    name: P'tit Dej. (+)
                    color: rgb(118, 93, 160)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_lave_linge_nous_power
                    name: Linge
                    color: rgb(137, 103, 179)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_lave_vaisselle_nous_power
                    name: Vaisselle
                    color: rgb(129,116,180)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_airfryer_ninja_nous_power
                    name: Airfryer (+)
                    color: rgb(142, 122, 181)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.four_et_plaque_de_cuisson_power
                    name: Four Plq Cui.
                    color: rgb(162, 148, 249)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_frigo_cuisine_nous_power
                    name: Frigo
                    color: cyan
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_congelateur_cuisine_nous_power
                    name: CongÃ©l
                    color: rgb(19, 160, 255)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_bureau_pc_ikea_power
                    name: PCe
                    color: orange
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_bureau_fer_a_repasser_nous_power
                    name: FÃ R (+)
                    color: gold
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_tete_de_lit_chambre_power
                    name: TÃªtes L. (+)
                    color: rgb(177,194,158)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_tv_chambre_nous_power
                    name: TV (+)
                    color: rgb(30, 81,40)
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.all_standby_power
                    name: Veilles
                    color: grey
                    yaxis_id: Watts
                    unit: W
                    stroke_width: 2
                    fill_raw: last
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:bubble-card
                    card_type: separator
                    name: 'SÃ©lectionner une piÃ¨ce :'
                    icon: mdi:arrow-right-bottom-bold
                    rows: 2
                    styles: |-
                      .bubble-line {
                        background: var(--primary-text-color);
                        opacity: 1;
                      }
                  - type: custom:tabbed-card
                    styles:
                      '--mdc-theme-primary': white
                      '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.25)
                    options: {}
                    tabs:
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Box Internet (Hue)
                                - energy_entity: sensor.prise_box_internet_ikea_power
                                - energy_color: gainsboro
                                - current_entity: sensor.prise_box_internet_ikea_current
                                - avg_daily_entity: sensor.box_internet_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_box_internet_ikea_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Horloge EntrÃ©e (Chargeur)
                                - energy_entity: sensor.prise_horloge_ikea_power
                                - energy_color: rgb(183, 183, 183)
                                - current_entity: sensor.prise_horloge_ikea_current
                                - avg_daily_entity: sensor.horloge_avg_watts_quotidien
                                - conso_daily_kwh_entity: sensor.prise_horloge_ikea_quotidien_kwh_um
                        attributes:
                          label: EntrÃ©e
                          icon: mdi:door
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: PC's GÃ©raldine
                                - energy_entity: sensor.prise_pc_s_gege_ikea_power
                                - energy_color: rgb(202, 135, 135)
                                - current_entity: sensor.prise_pc_s_gege_ikea_current
                                - avg_daily_entity: sensor.pc_gege_avg_watts_quotidien
                                - conso_daily_kwh_entity: sensor.prise_pc_s_gege_ikea_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: >-
                                    Prise Salon (Chargeurs, Vapote, Aspi. &
                                    iRobot)
                                - energy_entity: sensor.prise_salon_chargeur_nous_power
                                - energy_color: rgb(174, 68, 90)
                                - current_entity: sensor.prise_salon_chargeur_nous_current
                                - avg_daily_entity: sensor.chargeurs_salon_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_salon_chargeur_nous_quotidien_kwh_um
                        attributes:
                          label: Salon
                          icon: mdi:sofa
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Four Micro-Ondes (Alexa)
                                - energy_entity: sensor.prise_four_micro_ondes_nous_power
                                - energy_color: rgb(98, 78, 136)
                                - current_entity: sensor.prise_four_micro_ondes_nous_current
                                - avg_daily_entity: sensor.four_mo_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_four_micro_ondes_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: >-
                                    Petit DÃ©jeuner (grille pain, ThÃ©iÃ¨re,
                                    machine Ã  cafÃ©)
                                - energy_entity: sensor.prise_petit_dejeune_nous_power
                                - energy_color: rgb(118, 93, 160)
                                - current_entity: sensor.prise_petit_dejeune_nous_current
                                - avg_daily_entity: sensor.petit_dej_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_petit_dejeune_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Lave-Linge
                                - energy_entity: sensor.prise_lave_linge_nous_power
                                - energy_color: rgb(137, 103, 179)
                                - current_entity: sensor.prise_lave_linge_nous_current
                                - avg_daily_entity: sensor.lave_linge_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_lave_linge_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Lave-Vaisselle
                                - energy_entity: sensor.prise_lave_vaisselle_nous_power
                                - energy_color: rgb(129, 116, 180)
                                - current_entity: sensor.prise_lave_vaisselle_nous_current
                                - avg_daily_entity: sensor.lave_vaisselle_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_lave_vaisselle_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Airfryer (CookÃ©o, mixer, ect...)
                                - energy_entity: sensor.prise_airfryer_ninja_nous_power
                                - energy_color: rgb(142, 122, 181)
                                - current_entity: sensor.prise_airfryer_ninja_nous_current
                                - avg_daily_entity: sensor.airfryer_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_airfryer_ninja_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Four et plaque de Cuisson
                                - energy_entity: sensor.four_et_plaque_de_cuisson_power
                                - energy_color: rgb(162, 148, 249)
                                - current_entity: sensor.four_et_plaque_de_cuisson_current
                                - avg_daily_entity: sensor.plaques_cuisson_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.four_et_plaque_de_cuisson_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Frigo
                                - energy_entity: sensor.prise_frigo_cuisine_nous_power
                                - energy_color: cyan
                                - current_entity: sensor.prise_frigo_cuisine_nous_current
                                - avg_daily_entity: sensor.frigo_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_frigo_cuisine_nous_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: CongÃ©lateur
                                - energy_entity: sensor.prise_congelateur_cuisine_nous_power
                                - energy_color: rgb(19, 160, 255)
                                - current_entity: >-
                                    sensor.prise_congelateur_cuisine_nous_current
                                - avg_daily_entity: sensor.congelateur_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_congelateur_cuisine_nous_quotidien_kwh_um
                        attributes:
                          label: Cuisine
                          icon: mdi:fridge
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: PCe Bureau
                                - energy_entity: sensor.prise_bureau_pc_ikea_power
                                - energy_color: orange
                                - current_entity: sensor.prise_bureau_pc_ikea_current
                                - avg_daily_entity: sensor.pc_bureau_avg_watts_quotidien
                                - conso_daily_kwh_entity: sensor.prise_bureau_pc_ikea_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Fer Ã  Repasser Bureau (Store)
                                - energy_entity: >-
                                    sensor.prise_bureau_fer_a_repasser_nous_power
                                - energy_color: gold
                                - current_entity: >-
                                    sensor.prise_bureau_fer_a_repasser_nous_current
                                - avg_daily_entity: sensor.fer_repasser_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_bureau_fer_a_repasser_nous_quotidien_kwh_um
                        attributes:
                          label: BUREAU
                          icon: mdi:desktop-tower-monitor
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: >-
                                    TÃªtes de Lit chambre (Chargeurs, Alexa,
                                    etc...)
                                - energy_entity: sensor.prise_tete_de_lit_chambre_power
                                - energy_color: rgb(177, 194, 158)
                                - current_entity: sensor.prise_tete_de_lit_chambre_current
                                - avg_daily_entity: sensor.tetes_lit_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_tete_de_lit_chambre_quotidien_kwh_um
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: TV Chambre (Casques, TireTV, ect...)
                                - energy_entity: sensor.prise_tv_chambre_nous_power
                                - energy_color: rgb(30, 81, 40)
                                - current_entity: sensor.prise_tv_chambre_nous_current
                                - avg_daily_entity: sensor.tv_chambre_avg_watts_quotidien
                                - conso_daily_kwh_entity: >-
                                    sensor.prise_tv_chambre_nous_quotidien_kwh_um
                        attributes:
                          label: Chambre
                          icon: mdi:bed
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Veilles
                                - energy_entity: sensor.all_standby_power
                                - energy_color: grey
                                - current_entity: sensor.all_standby_current
                                - avg_daily_entity: sensor.veilles_avg_watts_quotidien
                                - conso_daily_kwh_entity: sensor.all_standby_quotidien_kwh_um
                        attributes:
                          label: Veilles
                          icon: mdi:sleep
    cards: []
  - type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE MENSUEL (Start Month)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/energie
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            apex_config:
              chart:
                height: 580px
            header:
              show: true
              title: Conso. mensuel (kWh)
              show_states: true
              colorize_states: true
            all_series_config:
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.prise_box_internet_ikea_mensuel_kwh_um
                name: Box (+)
                color: gainsboro
              - entity: sensor.prise_horloge_ikea_mensuel_kwh_um
                name: Horloge (+)
                color: rgb(183, 183, 183)
              - entity: sensor.prise_pc_s_gege_ikea_mensuel_kwh_um
                name: PCg
                color: rgb(202, 135, 135)
              - entity: sensor.prise_salon_chargeur_nous_mensuel_kwh_um
                name: Chargeurs (+)
                color: rgb(174, 68, 90)
              - entity: sensor.prise_four_micro_ondes_nous_mensuel_kwh_um
                name: Four M-O (+)
                color: rgb(98, 78, 136)
              - entity: sensor.prise_petit_dejeune_nous_mensuel_kwh_um
                name: P'tit Dej. (+)
                color: rgb(118, 93, 160)
              - entity: sensor.prise_lave_linge_nous_mensuel_kwh_um
                name: Linge
                color: rgb(137, 103, 179)
              - entity: sensor.prise_lave_vaisselle_nous_mensuel_kwh_um
                name: Vaisselle
                color: rgb(129, 116, 180)
              - entity: sensor.prise_airfryer_ninja_nous_mensuel_kwh_um
                name: Airfryer (+)
                color: rgb(142, 122, 181)
              - entity: sensor.four_et_plaque_de_cuisson_mensuel_kwh_um
                name: Four & Plq Cui.
                color: rgb(162, 148, 249)
              - entity: sensor.prise_frigo_cuisine_nous_mensuel_kwh_um
                name: frigo
                color: cyan
              - entity: sensor.prise_congelateur_cuisine_nous_mensuel_kwh_um
                name: congÃ©l.
                color: rgb(19, 160, 255)
              - entity: sensor.prise_bureau_pc_ikea_mensuel_kwh_um
                name: PCe
                color: orange
              - entity: sensor.prise_bureau_fer_a_repasser_nous_mensuel_kwh_um
                name: FÃ R (+)
                color: gold
              - entity: sensor.prise_tete_de_lit_chambre_mensuel_kwh_um
                name: TÃªtes L. (+)
                color: rgb(177, 194, 158)
              - entity: sensor.prise_tv_chambre_nous_mensuel_kwh_um
                name: TV (+)
                color: rgb(30, 81, 40)
              - entity: sensor.all_standby_mensuel_kwh_um
                name: Veilles
                color: grey
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: phu:rooms-hallway
            heading: EntrÃ©e
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Box Internet (Hue)
              energy_entity: sensor.prise_box_internet_ikea_energie_totale_kwh
              color: gainsboro
              avg_monthly_entity: sensor.box_internet_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_box_internet_ikea_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Horloge EntrÃ©e (Chargeur)
              energy_entity: sensor.prise_horloge_ikea_energie_totale_kwh
              color: rgb(183, 183, 183)
              avg_monthly_entity: sensor.horloge_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_horloge_ikea_mensuel_kwh_um
          - type: heading
            icon: mdi:sofa
            heading: Salon
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: PC's GÃ©raldine
              energy_entity: sensor.prise_pc_s_gege_ikea_energie_totale_kwh
              color: rgb(202, 135, 135)
              avg_monthly_entity: sensor.pc_gege_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_pc_s_gege_ikea_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Prise Salon (Chargeurs, Vapote, Aspi. & iRobot)
              energy_entity: sensor.prise_salon_chargeur_nous_energie_totale_kwh
              color: rgb(174, 68, 90)
              avg_monthly_entity: sensor.chargeurs_salon_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_salon_chargeur_nous_mensuel_kwh_um
          - type: heading
            icon: mdi:fridge
            heading: Cuisine
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Four Micro-Ondes (Alexa)
              energy_entity: sensor.prise_four_micro_ondes_nous_energie_totale_kwh
              color: rgb(98, 78, 136)
              avg_monthly_entity: sensor.four_mo_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_four_micro_ondes_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: P'tit Dej. (grille pain, ThÃ©iÃ¨re, machine Ã  cafÃ©)
              energy_entity: sensor.prise_petit_dejeune_nous_energie_totale_kwh
              color: rgb(118, 93, 160)
              avg_monthly_entity: sensor.petit_dej_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_petit_dejeune_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Lave-Linge
              energy_entity: sensor.prise_lave_linge_nous_energie_totale_kwh
              color: rgb(137, 103, 179)
              avg_monthly_entity: sensor.lave_linge_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_lave_linge_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Lave-Vaisselle
              energy_entity: sensor.prise_lave_vaisselle_nous_energie_totale_kwh
              color: rgb(129, 116, 180)
              avg_monthly_entity: sensor.lave_vaisselle_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_lave_vaisselle_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Airfryer (CookÃ©o, mixer, ect...)
              energy_entity: sensor.prise_airfryer_ninja_nous_energie_totale_kwh
              color: rgb(142, 122, 181)
              avg_monthly_entity: sensor.airfryer_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_airfryer_ninja_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Four et plaque de Cuisson
              energy_entity: sensor.four_et_plaque_de_cuisson_energie_totale_kwh
              color: rgb(162, 148, 249)
              avg_monthly_entity: sensor.plaques_cuisson_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.four_et_plaque_de_cuisson_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Frigo
              energy_entity: sensor.prise_frigo_cuisine_nous_energie_totale_kwh
              color: cyan
              avg_monthly_entity: sensor.frigo_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_frigo_cuisine_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: CongÃ©lateur
              energy_entity: sensor.prise_congelateur_cuisine_nous_energie_totale_kwh
              color: rgb(19, 160, 255)
              avg_monthly_entity: sensor.congelateur_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_congelateur_cuisine_nous_mensuel_kwh_um
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading: Bureau
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: PCe Bureau
              energy_entity: sensor.prise_bureau_pc_ikea_energie_totale_kwh
              color: orange
              avg_monthly_entity: sensor.pc_bureau_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_bureau_pc_ikea_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Fer Ã  Repasser Bureau (Store)
              energy_entity: sensor.prise_bureau_fer_a_repasser_nous_energie_totale_kwh
              color: gold
              avg_monthly_entity: sensor.fer_repasser_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_bureau_fer_a_repasser_nous_mensuel_kwh_um
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: TÃªtes de Lit chambre (Chargeurs, Alexa, etc...)
              energy_entity: sensor.prise_tete_de_lit_chambre_energie_totale_kwh
              color: rgb(177, 194, 158)
              avg_monthly_entity: sensor.tetes_lit_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_tete_de_lit_chambre_mensuel_kwh_um
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: TV Chambre (Casques, FireTV, ect...)
              energy_entity: sensor.prise_tv_chambre_nous_energie_totale_kwh
              color: rgb(30, 81, 40)
              avg_monthly_entity: sensor.tv_chambre_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.prise_tv_chambre_nous_mensuel_kwh_um
          - type: heading
            icon: mdi:sleep
            heading: All Standby
            heading_style: title
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              title: Veilles
              energy_entity: sensor.all_standby_energie_totale_kwh
              color: grey
              avg_monthly_entity: sensor.veilles_avg_watts_mensuel
              conso_monthly_kwh_entity: sensor.all_standby_mensuel_kwh_um
    title: Energie HOME Mensuel
    cards: []
    path: energie-mensuel
  - type: sections
    path: energie-clim
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE (C)LIM / (R)ADIATEUR
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta_affichage
                tap_action:
                  action: navigate
                  navigation_path: '#tendances'
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: conditional
            conditions:
              - condition: or
                conditions:
                  - condition: state
                    entity: sensor.salon_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.cuisine_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.bureau_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.sdb_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.sdb_seche_serviettes_power_status_affichage
                    state_not: 'off'
                  - condition: state
                    entity: sensor.chambre_power_status_affichage
                    state_not: 'off'
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: Consomation TOTAL Climatisations & Radiateurs
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-chips-card
                alignment: center
                chips:
                  - type: template
                    entity: sensor.dut_clim_salon
                    content: |
                      Salon: {% set t = states(entity) | float(0) %}
                      {% set h = t | int %}{% set m = ((t - h) * 60) | int %}
                      {{ h }}h{{ '{:02d}'.format(m) }}
                    icon: |-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %}
                        mdi:snowflake
                      {% else %}
                        mdi:fire
                      {% endif %}
                    icon_color: >-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %} #03a9f4 {%
                      else %} #ff9800 {% endif %}
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: transparent;
                        }
                  - type: template
                    entity: sensor.dut_radiateur_cuisine
                    content: |
                      Cuisine: {% set t = states(entity) | float(0) %}
                      {% set h = t | int %}{% set m = ((t - h) * 60) | int %}
                      {{ h }}h{{ '{:02d}'.format(m) }}
                    icon: mdi:radiator
                    icon_color: '#f44336'
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: transparent;
                        }
                  - type: template
                    entity: sensor.dut_clim_bureau
                    content: |
                      Bureau: {% set t = states(entity) | float(0) %}
                      {% set h = t | int %}{% set m = ((t - h) * 60) | int %}
                      {{ h }}h{{ '{:02d}'.format(m) }}
                    icon: |-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %}
                        mdi:snowflake
                      {% else %}
                        mdi:fire
                      {% endif %}
                    icon_color: >-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %} #03a9f4 {%
                      else %} #ff9800 {% endif %}
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: transparent;
                        }
                  - type: template
                    entity: sensor.dut_clim_chambre
                    content: |
                      Chambre: {% set t = states(entity) | float(0) %}
                      {% set h = t | int %}{% set m = ((t - h) * 60) | int %}
                      {{ h }}h{{ '{:02d}'.format(m) }}
                    icon: |-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %}
                        mdi:snowflake
                      {% else %}
                        mdi:fire
                      {% endif %}
                    icon_color: >-
                      {% if is_state('sensor.ete_hiver', 'Ã‰tÃ©') %} #03a9f4 {%
                      else %} #ff9800 {% endif %}
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: transparent;
                        }
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: sensor.salon_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_salon_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_salon_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Salon: {% if is_state('sensor.clim_salon_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.cuisine_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: |
                    {% if is_state('sensor.radiateur_cuisine_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Cuisine: {% if is_state('sensor.radiateur_cuisine_etat',
                    'Heat') %}
                      Heat
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.bureau_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_bureau_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_bureau_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Bureau: {% if is_state('sensor.clim_bureau_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.sdb_soufflant_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heat-wave
                  icon_color: |
                    {% if is_state('sensor.soufflant_sdb_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.soufflant_sdb_etat', 'off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Salle de Bain: {% if is_state('sensor.soufflant_sdb_etat',
                    'Heat') %}
                      Heat
                    {% else %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.sdb_seche_serviette_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: >
                    {% if is_state('sensor.sdb_seche_serviette_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.sdb_seche_serviette_etat', 'off')
                    %}
                      #FF0000
                    {% endif %}
                  content: >
                    Salle de Bain: {% if
                    is_state('sensor.sdb_seche_serviette_etat', 'Heat') %}
                      Heat
                    {% else %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.chambre_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_chambre_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_chambre_etat', 'Heat') %}
                      #ff6100
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Chambre: {% if is_state('sensor.clim_chambre_etat', 'Heat')
                    %}
                      Heat
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
            alignment: center
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt-outline
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.conso_clim_rad_total
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
                visibility:
                  - condition: numeric_state
                    entity: sensor.conso_clim_rad_total
                    above: 0.1
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: Consomation Total JournaliÃ¨re
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 600px
            header:
              show: true
              title: Conso. journaliÃ¨re (Start Day)
              show_states: true
              colorize_states: true
            all_series_config:
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.clim_salon_daily
                name: SALON (C)
                color: rgb(174,68,90)
                float_precision: 2
              - entity: sensor.radiateur_cuisine_daily
                name: CUISINE (R)
                color: rgb(168, 136, 181)
                float_precision: 2
              - entity: sensor.clim_bureau_daily
                name: BUREAU (C)
                color: orange
                float_precision: 2
              - entity: sensor.soufflant_sdb_daily
                name: Souff. SdB (R)
                color: magenta
                float_precision: 2
              - entity: sensor.seche_serv_sdb_daily
                name: SÃ¨che-Serv. SdB (R)
                color: purple
                float_precision: 2
              - entity: sensor.clim_chambre_daily
                name: CHAMBRE (C)
                color: rgb(30,81,40)
                float_precision: 2
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  font-size: 11px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: Consomation Total Mensuel
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel (Start Month)
              show_states: true
              colorize_states: true
            all_series_config:
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.clim_salon_monthly
                name: SALON (C)
                color: rgb(174,68,90)
                float_precision: 2
              - entity: sensor.radiateur_cuisine_monthly
                name: CUISINE (R)
                color: rgb(168, 136, 181)
                float_precision: 2
              - entity: sensor.clim_bureau_monthly
                name: BUREAU (C)
                color: orange
                float_precision: 2
              - entity: sensor.soufflant_sdb_monthly
                name: Souff. SdB (R)
                color: magenta
                float_precision: 2
              - entity: sensor.seche_serv_sdb_monthly
                name: SÃ¨che-Serv. SdB (R)
                color: purple
                float_precision: 2
              - entity: sensor.clim_chambre_monthly
                name: CHAMBRE (C)
                color: rgb(30,81,40)
                float_precision: 2
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  font-size: 11px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: Tendance
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: mdi:thermometer-lines
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Tendances
            tap_action:
              action: none
          - type: horizontal-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_temperature
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    icon_color: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        red
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        blue
                      {% else %}
                        #df6366
                      {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_temperature'') }}Â°C'
                    layout: horizontal
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_mod:
                      style: |
                        ha-card {
                          background-color: transparent !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_temperature
                        name: TempÃ©rature
                        color: '#df6366'
                    height: 200
                    hours_to_show: 24
                    decimals: 1
                    points_per_hour: 6
                    line_width: 2
                    font_size: 80
                    hour24: true
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      extrema: true
                      fill: fade
                      points: false
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  height: 228px;
                  margin-left: auto;
                  margin-right: auto;
                }
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: true
            span:
              start: day
              offset: '-0h'
            apex_config:
              chart:
                height: 400px
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: temperature
                min: ~5
                max: ~32
                decimals: 2
                apex_config:
                  tickAmount: 10
              - id: conso_clim
                min: ~150
                max: auto
                opposite: true
                decimals: 2
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 60m
              show:
                legend_value: false
            series:
              - entity: sensor.temperature_moyenne_interieure
                name: TÌ„ Appart.
                yaxis_id: temperature
                stroke_width: 4
                fill_raw: last
                color: orange
                show:
                  extremas: true
              - entity: sensor.th_balcon_nord_temperature
                name: TÂ° Bal.Nrd
                yaxis_id: temperature
                stroke_width: 4
                fill_raw: last
                color: green
                show:
                  extremas: true
              - entity: sensor.conso_clim_rad_total
                name: Conso. Instan.
                yaxis_id: conso_clim
                type: column
                opacity: 0.6
                fill_raw: last
                color: rgb(68,115,158)
                unit: W
                group_by:
                  func: max
                  duration: 1h
                  start_with_last: true
              - entity: sensor.conso_clim_rad_total_quotidien
                name: Conso. Total
                color: rgb(68,115,158)
                unit: kWh
                show:
                  in_brush: false
                  in_chart: false
              - entity: sensor.clim_rad_total_avg_watts_daily
                name: Moy.depuis Minuit
                yaxis_id: conso_clim
                type: line
                stroke_width: 2
                color: '#F44336'
                unit: W
                show:
                  in_brush: false
                  in_chart: true
                  extremas: true
              - entity: sensor.conso_clim_rad_total_mensuel
                name: Mois en cours
                color: red
                show:
                  in_brush: false
                  in_chart: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;   
                  box-shadow: none !important;
                  border: none !important;
                  font-size: 12px;
                }
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 24h
            cache: true
            span:
              start: day
              offset: +0m
            apex_config:
              chart:
                height: 340px
            now:
              show: true
              color: '#f44336'
              label: V
            header:
              show: true
              title: D.U.T. PiÃ¨ces vs Performance Totale
              show_states: true
              colorize_states: true
            yaxis:
              - id: temp
                max: ~9
                decimals: 0
                opposite: false
              - id: hours
                min: 0
                max: ~6
                decimals: 0
                opposite: true
                apex_config:
                  tickAmount: 12
              - id: perf
                show: false
                min: 0
                max: ~1
            all_series_config:
              curve: smooth
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_balcon_nord_temperature
                yaxis_id: temp
                name: Temp. Ext.
                type: area
                opacity: 0.2
                color: '#44739e'
                stroke_width: 1
              - entity: sensor.dut_clim_salon
                name: Salon
                yaxis_id: hours
                color: rgb(174,68,90)
                stroke_width: 3
              - entity: sensor.dut_radiateur_cuisine
                name: Cuisine
                yaxis_id: hours
                color: rgb(168, 136, 181)
                stroke_width: 3
              - entity: sensor.dut_clim_bureau
                name: Bureau
                yaxis_id: hours
                color: orange
                stroke_width: 3
              - entity: sensor.dut_sdb_total
                name: SdB
                yaxis_id: hours
                color: magenta
                stroke_width: 3
              - entity: sensor.dut_clim_chambre
                name: Chambre
                yaxis_id: hours
                color: rgb(30,81,40)
                stroke_width: 3
              - entity: sensor.performance_thermique_totale_stable
                name: Perf. Appart.
                yaxis_id: perf
                type: line
                stroke_width: 1
                color: '#FFFFFF'
                show:
                  legend_value: true
                group_by:
                  func: avg
                  duration: 30m
            card_mod:
              style: |
                ha-card {
                  background: transparent !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 24h
            cache: true
            span:
              start: day
            now:
              show: true
              color: '#f44336'
              label: v
            header:
              show: true
              title: Comparatif Performances Thermiques (DPE)
              show_states: true
              colorize_states: true
            apex_config:
              chart:
                height: 380px
              annotations:
                yaxis:
                  - 'y': 0
                    y2: 0.5
                    yAxisId: perf
                    fillColor: '#008055'
                    opacity: 0.1
                    label:
                      text: A
                      style:
                        color: '#008055'
                        background: transparent
                  - 'y': 0.51
                    y2: 1.5
                    yAxisId: perf
                    fillColor: '#2FB044'
                    opacity: 0.1
                    label:
                      text: B
                      style:
                        color: '#2FB044'
                        background: transparent
                  - 'y': 1.51
                    y2: 2.5
                    yAxisId: perf
                    fillColor: '#BED100'
                    opacity: 0.1
                    label:
                      text: C
                      style:
                        color: '#BED100'
                        background: transparent
                  - 'y': 2.51
                    y2: 4
                    yAxisId: perf
                    fillColor: '#FFD100'
                    opacity: 0.1
                    label:
                      text: D
                      style:
                        color: '#FFD100'
                        background: transparent
                  - 'y': 4.1
                    y2: 6
                    yAxisId: perf
                    fillColor: '#FFB300'
                    opacity: 0.1
                    label:
                      text: E
                      style:
                        color: '#FFB300'
                        background: transparent
                  - 'y': 6.1
                    y2: 8.5
                    yAxisId: perf
                    fillColor: '#F44336'
                    opacity: 0.1
                    label:
                      text: F
                      style:
                        color: '#F44336'
                        background: transparent
                  - 'y': 8.6
                    y2: 15
                    yAxisId: perf
                    fillColor: '#8B0000'
                    opacity: 0.1
                    label:
                      text: G
                      style:
                        color: '#8B0000'
                        background: transparent
            yaxis:
              - id: perf
                min: 0
                max: 10
                decimals: 1
                opposite: false
                apex_config:
                  tickAmount: 5
              - id: tempint
                min: ~0
                max: ~21
                decimals: 0
                opposite: true
                apex_config:
                  tickAmount: 5
              - id: tempext
                min: ~0
                max: ~18
                decimals: 0
                show: false
            all_series_config:
              stroke_width: 2
              curve: smooth
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.temperature_moyenne_interieure
                name: TÌ„ Appart.
                yaxis_id: tempint
                color: orange
                stroke_width: 1.5
                fill_raw: last
                show:
                  in_chart: true
                  legend_value: true
              - entity: sensor.th_balcon_nord_temperature
                name: Temp. Ext.
                yaxis_id: tempext
                color: '#44739e'
                type: line
                stroke_width: 1.5
                fill_raw: last
                show:
                  in_chart: true
                  legend_value: false
              - entity: sensor.temperature_delta_valeur
                name: Î”T
                color: red
                show:
                  in_chart: false
                  legend_value: false
              - entity: sensor.performance_thermique_totale_stable
                name: Score DEP
                color: white
                yaxis_id: perf
                stroke_width: 2
                fill_raw: last
                show:
                  in_chart: true
                  legend_value: true
                color_threshold:
                  - value: 0
                    color: '#008055'
                  - value: 0.6
                    color: '#2FB044'
                  - value: 1.6
                    color: '#BED100'
                  - value: 2.6
                    color: '#FFD100'
                  - value: 4.1
                    color: '#FFB300'
                  - value: 6.1
                    color: '#F44336'
                  - value: 8.6
                    color: '#8B0000'
            card_mod:
              style: |
                ha-card {
                  background: transparent !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: SALON
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_salon_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
                state_content:
                  - name
                  - state
                name: Salon
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_salon_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_salon_rm4_mini
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: Clim. Salon (V)
              entity: sensor.clim_salon_nous_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: Clim. Salon (A)
              entity: sensor.clim_salon_nous_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el Clim. Salon
                    energy_entity: sensor.clim_salon_nous_power
                    energy_color: rgb(174,68,90)
                    current_entity: sensor.clim_salon_nous_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.clim_salon_avg_watts_daily
                    conso_daily_kwh_entity: sensor.clim_salon_daily
                    span_offset: '-1m'
                    group_duration: 1m
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel Clim Salon
                    energy_entity: sensor.clim_salon_nous_energy
                    energy_name: Conso. jours en cours
                    energy_color: rgb(174,68,90)
                    avg_monthly_entity: sensor.clim_salon_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    temp_color: rgb(126, 24, 145)
                    conso_monthly_kwh_entity: sensor.clim_salon_monthly
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.1
                          label:
                            text: Zone Critique
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance Salon
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~2
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_clim_salon
                      name: D.U.T. Salon
                      yaxis_id: hours
                      type: area
                      color: rgb(174,68,90)
                      stroke_width: 1
                      opacity: 0.4
                      group_by:
                        func: last
                        duration: 5m
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_salon
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_salon_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_salon_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: CUISINE
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.radiateur_cuisine
                icon: mdi:power
                color: state
                tap_action:
                  action: more-info
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
                name: Cuisine
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CUISINE  (RADIATEUR)
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: custom:bubble-card
            card_type: climate
            entity: climate.radiateur_cuisine
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.radiateur_cuisine
            icon: ''
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Radiateur de la Cuisine
            styles: |
              ha-card {
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: Rad. Cuisine (V)
              entity: sensor.radiateur_elec_cuisine_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: Rad. Cuisine (A)
              entity: sensor.radiateur_elec_cuisine_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el Radiateur Cuisine
                    energy_entity: sensor.radiateur_elec_cuisine_power
                    energy_color: rgb(168, 136, 181)
                    current_entity: sensor.radiateur_elec_cuisine_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.radiateur_cuisine_avg_watts_daily
                    conso_daily_kwh_entity: sensor.radiateur_cuisine_daily
                    power_entity: sensor.radiateur_elec_cuisine_power
                    power_color: rgb(168, 136, 181)
                    span_offset: +3m
                    group_duration: 1s
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel Radiateur Cuisine
                    energy_entity: sensor.radiateur_elec_cuisine_energy
                    energy_name: Conso. jours en cours
                    energy_color: rgb(168, 136, 181)
                    avg_monthly_entity: sensor.radiateur_cuisine_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    temp_color: rgb(126, 24, 145)
                    conso_monthly_kwh_entity: sensor.radiateur_cuisine_monthly
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          yAxisId: perf
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.1
                          label:
                            text: Performance Faible
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance Cuisine
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~0.5
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_radiateur_cuisine
                      name: D.U.T. Cuisine
                      yaxis_id: hours
                      type: area
                      color: rgb(168, 136, 181)
                      stroke_width: 1
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_cuisine
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_cuisine_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.radiateur_elec_cuisine_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: BUREAU
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_bureau_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
                name: Bureau
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: BUREAU
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_bureau_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_bureau_rm4_mini
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
            name: ''
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: Clim. Bureau (V)
              entity: sensor.clim_bureau_nous_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: Clim. Bureau (A)
              entity: sensor.clim_bureau_nous_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el Clim. Bureau
                    energy_entity: sensor.clim_bureau_nous_power
                    energy_color: orange
                    current_entity: sensor.clim_bureau_nous_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.clim_bureau_avg_watts_daily
                    conso_daily_kwh_entity: sensor.clim_bureau_daily
                    power_entity: sensor.clim_bureau_nous_power
                    power_color: orange
                    span_offset: +3m
                    group_duration: 1s
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel Clim Bureau
                    energy_entity: sensor.clim_bureau_nous_energy
                    energy_name: Conso. jours en cours
                    energy_color: orange
                    avg_monthly_entity: sensor.clim_bureau_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    temp_color: rgb(126, 24, 145)
                    conso_monthly_kwh_entity: sensor.clim_bureau_monthly
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          yAxisId: perf
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.1
                          label:
                            text: Zone Critique
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance Bureau
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~10
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_clim_bureau
                      name: D.U.T. Bureau
                      yaxis_id: hours
                      type: area
                      color: orange
                      stroke_width: 1
                      opacity: 0.4
                      group_by:
                        func: last
                        duration: 5m
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_bureau
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_bureau_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_bureau_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_bureau_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_bureau_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_bureau_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: SALLE DE BAIN
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: hue:room-bathroom
            heading: SALLE DE BAIN
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.soufflant_salle_de_bain
                icon: mdi:power
                color: state
                tap_action:
                  action: more-info
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                color: green
                state_content:
                  - name
                  - state
                name:
                  type: area
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 0px;
                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Soufflant de la Salle de Bain
          - type: custom:bubble-card
            card_type: climate
            entity: climate.soufflant_salle_de_bain
            sub_button:
              main:
                - name: HVAC modes menu
                  select_attribute: hvac_modes
                  state_background: false
                  show_arrow: true
                  show_background: true
                  show_attribute: false
                  entity: climate.soufflant_salle_de_bain
                  sub_button_type: select
              bottom: []
            icon: mdi:heat-wave
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            name: Soufflant de la Salle de Bain
            styles: |
              ha-card {
                --bubble-state-climate-heat-color: #ff6100;
              }
            step: 1
            hide_temperature: false
            state_color: false
            min_temp: 21
            max_temp: 23
            show_last_changed: false
            show_last_updated: false
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: Souffl. SdB (V)
              entity: sensor.prise_soufflant_salle_de_bain_nous_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: Souffl. SdB (A)
              entity: sensor.prise_soufflant_salle_de_bain_nous_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el Soufflant Salle de Bain
                    energy_color: magenta
                    current_entity: sensor.prise_soufflant_salle_de_bain_nous_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.soufflant_sdb_avg_watts_daily
                    conso_daily_kwh_entity: sensor.soufflant_sdb_daily
                    power_entity: sensor.prise_soufflant_salle_de_bain_nous_power
                    power_color: rgb(126, 24, 145)
                    span_offset: +15m
                    group_duration: 1m
                    energy_entity: sensor.prise_soufflant_salle_de_bain_nous_power
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel Soufflant SdB
                    energy_entity: sensor.prise_soufflant_salle_de_bain_nous_energy
                    energy_name: Conso. jours en cours
                    energy_color: magenta
                    avg_monthly_entity: sensor.soufflant_sdb_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    conso_monthly_kwh_entity: sensor.soufflant_sdb_monthly
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    stroke:
                      dashArray:
                        - 0
                        - 0
                        - 0
                        - 4
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.1
                          label:
                            text: Pic de conso
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance SdB
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~2
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_sdb_total
                      name: D.U.T. SdB
                      yaxis_id: hours
                      type: area
                      color: rgb(218, 112, 214)
                      stroke_width: 1
                      opacity: 0.4
                      group_by:
                        func: last
                        duration: 5m
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_sdb
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_sdb_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:heat-wave
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.soufflant_sdb_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.soufflant_sdb_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.soufflant_sdb_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.soufflant_sdb_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: SÃ¨che-Serviettes Salle de Bain
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: SÃ¨che-serv. SdB (V)
              entity: sensor.prise_seche_serviette_salle_de_bain_nous_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: SÃ¨che-Serv. SdB (A)
              entity: sensor.prise_seche_serviette_salle_de_bain_nous_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el SÃ¨che-Serv. Salle de Bain
                    energy_entity: sensor.prise_seche_serviette_salle_de_bain_nous_power
                    energy_color: rgb(218, 112, 214)
                    current_entity: sensor.prise_seche_serviette_salle_de_bain_nous_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.seche_serv_avg_watts_daily
                    conso_daily_kwh_entity: sensor.seche_serv_sdb_daily
                    power_entity: sensor.prise_radiateur_salle_de_bain_inspelning_ikea_power
                    power_color: rgb(255, 215, 0)
                    span_offset: +15m
                    group_duration: 1m
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel SÃ¨che-serviettes SdB
                    energy_entity: sensor.prise_seche_serviette_salle_de_bain_nous_energy
                    energy_name: Conso. jours en cours
                    energy_color: rgb(218, 112, 214)
                    avg_monthly_entity: sensor.seche_serv_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    temp_color: rgb(126, 24, 145)
                    conso_monthly_kwh_entity: sensor.seche_serv_sdb_monthly
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    stroke:
                      dashArray:
                        - 0
                        - 0
                        - 0
                        - 4
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.1
                          label:
                            text: Pic de conso
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance SdB
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~2
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_sdb_total
                      name: D.U.T. SdB
                      yaxis_id: hours
                      type: area
                      color: rgb(218, 112, 214)
                      stroke_width: 1
                      opacity: 0.4
                      group_by:
                        func: last
                        duration: 5m
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_sdb
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_sdb_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:heating-coil
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.seche_serviette_sdb_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.seche_serviette_sdb_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.seche_serviette_sdb_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.seche_serviette_sdb_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: conditional
            conditions: []
            card:
              type: custom:stack-in-card
              mode: vertical
              cards:
                - type: horizontal-stack
                  cards:
                    - type: custom:mod-card
                      card_mod:
                        style:
                          .: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 5px;
                            }
                      card:
                        type: custom:text-divider-row
                        text: CHAMBRE
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    box-shadow: none !important;
                    background: none !important;
                  }
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_chambre_rm4_mini
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: RÃ©glÃ© Ã 
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                name: Chambre
                state_content:
                  - name
                  - state
                color: green
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CHAMBRE
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_chambre_rm4_mini
            state_color: true
            icon: mdi:air-conditioner
            show_icon: true
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_chambre_rm4_mini
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            styles: |
              ha-card {
                --bubble-state-climate-fan-only-color: #008B8B;
                --bubble-state-climate-heat-color: #ff6100;
              }
          - type: custom:streamline-card
            template: clim_voltage_ring-tile
            variables:
              card_name: Clim. chambre (V)
              entity: sensor.clim_chambre_nous_voltage
            grid_options:
              columns: 6
              rows: 3
          - type: custom:streamline-card
            template: clim_ampere_ring-tile
            variables:
              card_name: Clim. chambre (A)
              entity: sensor.clim_chambre_nous_current
            grid_options:
              columns: 6
              rows: 3
          - type: custom:tabbed-card
            styles:
              '--mdc-theme-primary': rgb(174,68,90)
              '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.6)
              max-width: 100%
            attributes:
              animated: true
              swipeable: true
            tabs:
              - attributes:
                  label: INSTANTANÃ‰
                  icon: mdi:flash
                card:
                  type: custom:streamline-card
                  template: conso_temps_reel_clim_rad
                  variables:
                    card_title: Conso. Temps RÃ©el Clim. Chambre
                    energy_entity: sensor.clim_chambre_nous_power
                    energy_color: rgb(30,81,40)
                    current_entity: sensor.clim_chambre_nous_current
                    current_color: rgb(255, 41, 41)
                    avg_daily_entity: sensor.clim_chambre_avg_watts_daily
                    conso_daily_kwh_entity: sensor.clim_chambre_daily
                    power_entity: sensor.clim_chambre_nous_power
                    power_color: rgb(30,81,40)
                    span_offset: +3m
                    group_duration: 1s
              - attributes:
                  label: MENSUEL
                  icon: mdi:calendar-month
                card:
                  type: custom:streamline-card
                  template: conso_mensuelle_clim
                  variables:
                    title: Conso. mensuel Clim de la Chambre
                    energy_entity: sensor.clim_chambre_nous_energy
                    energy_name: Conso. jours en cours
                    energy_color: rgb(30,81,40)
                    avg_monthly_entity: sensor.clim_chambre_avg_watts_monthly
                    temp_entity: sensor.th_balcon_nord_temperature
                    temp_color: rgb(126, 24, 145)
                    conso_monthly_kwh_entity: sensor.clim_chambre_monthly
              - attributes:
                  label: PERF / DUT
                  icon: mdi:chart-line
                card:
                  type: custom:apexcharts-card
                  experimental:
                    color_threshold: true
                  graph_span: 24h
                  cache: true
                  span:
                    start: day
                    offset: +0m
                  apex_config:
                    chart:
                      height: 340px
                    annotations:
                      yaxis:
                        - 'y': 5
                          y2: 50
                          yAxisId: perf
                          borderColor: '#f44336'
                          fillColor: '#f44336'
                          opacity: 0.7
                          label:
                            text: Zone de dÃ©perdition
                            style:
                              color: '#f44336'
                              background: transparent
                  now:
                    show: true
                    color: '#f44336'
                    label: Now
                  header:
                    show: true
                    title: D.U.T. & Performance Chambre
                    show_states: true
                    colorize_states: true
                  yaxis:
                    - id: temp
                      decimals: 0
                    - id: hours
                      min: 0
                      max: 24
                      decimals: 0
                      opposite: true
                      apex_config:
                        tickAmount: 12
                    - id: perf
                      show: false
                      min: 0
                      max: ~10
                  all_series_config:
                    show:
                      legend_value: false
                      extremas: true
                    curve: smooth
                  series:
                    - entity: sensor.th_balcon_nord_temperature
                      yaxis_id: temp
                      name: Temp. ExtÃ©rieure
                      type: area
                      stroke_width: 1
                      color: '#44739e'
                      opacity: 0.2
                    - entity: sensor.dut_clim_chambre
                      name: D.U.T. Chambre
                      yaxis_id: hours
                      type: area
                      color: rgb(30,81,40)
                      stroke_width: 1
                      opacity: 0.4
                      group_by:
                        func: last
                        duration: 5m
                      color_threshold:
                        - value: 0
                          color: '#0f9d58'
                        - value: 4
                          color: '#fdd835'
                        - value: 6
                          color: '#ff9800'
                        - value: 10
                          color: '#f44336'
                    - entity: sensor.performance_thermique_chambre
                      name: Perf. RÃ©elle (30 min.)
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: red
                      group_by:
                        func: avg
                        duration: 30m
                    - entity: sensor.performance_chambre_moyenne_jour
                      name: Perf. Moy. 24h
                      yaxis_id: perf
                      type: line
                      stroke_width: 2
                      color: '#f44336'
                  card_mod:
                    style: |
                      ha-card {
                        background: transparent !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_chambre_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -22px 0px 0px 0px;
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tendances'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CALCUL DU DELTA IntÃ©rieur <-> ExtÃ©rieur
                icon: mdi:delta
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: calcule_temp_cible
    title: Energie Clim
    cards: []
  - type: sections
    path: reserve
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:cog
            heading: SystÃ¨me
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /lovelace/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: GitHub
            icon: mdi:github
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: vertical-stack
            cards:
              - type: custom:mushroom-chips-card
                alignment: center
                chips:
                  - type: template
                    entity: sensor.backup_github_status
                    icon: mdi:github
                    content: >-
                      {{ iif(states('sensor.backup_github_status')=='OK','Backup
                      OK','Backup KO') }} Â· {{
                      state_attr('sensor.backup_github_status','ts') or 'jamais'
                      }}
                    icon_color: >-
                      {{
                      iif(states('sensor.backup_github_status')=='OK','green','red')
                      }}
                    tap_action:
                      action: url
                      url_path: >-
                        https://github.com/BerrySwann/home-assistant-config/commits/main
                      new_tab: true
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
              - type: custom:mushroom-chips-card
                alignment: center
                chips:
                  - type: template
                    entity: sensor.git_last_weekly_tag
                    icon: mdi:tag
                    content: '{{ states(''sensor.git_last_weekly_tag'') or ''no tag'' }}'
                    icon_color: >-
                      {% set tag = states('sensor.git_last_weekly_tag') %} {%
                      set iso = now().isocalendar() %} {% set current =
                      "weekly-%04d-W%02d" | format(iso[0], iso[1]) %} {{ 'green'
                      if (tag and tag.startswith(current)) else 'amber' }}
                    tap_action:
                      action: url
                      url_path: https://github.com/BerrySwann/home-assistant-config/tags
                      new_tab: true
                    hold_action:
                      action: call-service
                      service: script.git_backup_weekly_refresh
                      confirmation:
                        text: Voulez-vous crÃ©er un Tag Hebdomadaire ?
                  - type: template
                    entity: sensor.github_default_branch
                    icon: mdi:source-branch
                    content: >-
                      Branche: {{ states('sensor.github_default_branch') or
                      'unknown' }}
                    icon_color: >-
                      {% set b = states('sensor.github_default_branch') %} {{
                      'green' if b == 'main' else 'amber' }}
                    tap_action:
                      action: url
                      url_path: >-
                        https://github.com/BerrySwann/home-assistant-config/branches
                      new_tab: true
                  - type: template
                    icon: mdi:cloud-upload-outline
                    content: Push
                    icon_color: deep-orange
                    tap_action:
                      action: call-service
                      service: script.git_backup_and_update
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
              - type: custom:mushroom-title-card
                title: Journal Backup (10 derniers)
                alignment: center
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
              - type: markdown
                content: |-
                  ```
                  {{ state_attr('sensor.backup_github_journal','text') or 'â€”' }}
                  ```
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
              - type: custom:apexcharts-card
                header:
                  title: Backup GitHub â€” OK/KO
                graph_span: 7d
                span:
                  end: day
                yaxis:
                  - min: 0
                    max: 1
                    decimals: 0
                series:
                  - entity: sensor.backup_github_status
                    name: Statut
                    type: column
                    transform: 'EVAL: return x === ''OK'' ? 1 : 0;'
                    group_by:
                      duration: 6h
                      func: last
                apex_config:
                  yaxis:
                    tickAmount: 2
                    labels:
                      formatter: >
                        EVAL: function (value) { return value === 1 ? 'OK' :
                        'KO'; }
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
          - type: custom:bubble-card
            card_type: separator
            name: Restart VSCode
            icon: mdi:check-bold
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:button-card
            entity: automation.systeme_economie_energie_vs_code
            name: RedÃ©marrer Studio Code Server
            icon: mdi:restart
            tap_action:
              action: call-service
              service: automation.trigger
              service_data:
                entity_id: automation.systeme_economie_energie_vs_code
            styles:
              card:
                - background: transparent
                - border: 0.1px solid white
                - border-radius: 12px
                - color: white
                - font-size: 14px
                - padding: 4px
              icon:
                - width: 40px
                - height: 40px
                - color: white
              name:
                - font-size: 16px
                - margin-top: 12px
          - type: custom:bubble-card
            card_type: separator
            name: MariaDB
            icon: mdi:database-cog-outline
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:button-card
            entity: automation.db_purge_mariadb_repack
            name: Nettoyer MariaDB
            icon: mdi:database-sync
            tap_action:
              action: call-service
              service: automation.trigger
              service_data:
                entity_id: automation.db_purge_mariadb_repack
            styles:
              card:
                - background: transparent
                - border: 1px solid white
                - border-radius: 12px
                - color: white
                - padding: 4px
              icon:
                - width: 40px
                - color: >
                    [[[ if (states['automation.db_purge_mariadb_repack'].state
                    == 'on') return 'gold'; return 'white'; ]]]
    title: reserve
    cards: []
  - type: sections
    max_columns: 3
    path: energie-lampes
    title: Lampes
    sections:
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-filament-hung
            heading: LAMPES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.salon
                color: state
                icon: hue:flourish-alt
                tap_action:
                  action: more-info
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: light.table
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES SALON CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_ambiance_lamp_salon_1_quotidien_kwh_um
                name: Salon 1A (B1)
                color: C9DABF
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_2_quotidien_kwh_um
                name: Salon 2A (B2)
                color: 9CA986
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_3_quotidien_kwh_um
                name: Salon 3A (L1)
                color: 808D7C
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_salon_1_quotidien_kwh_um
                name: Salon 1C (L1)
                color: 5F6F65
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_table_quotidien_kwh_um
                name: Table
                color: 677D6A
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES SALON CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_ambiance_lamp_salon_1_mensuel_kwh_um
                name: Salon 1A (B1)
                color: C9DABF
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_2_mensuel_kwh_um
                name: Salon 2A (B2)
                color: 9CA986
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_3_mensuel_kwh_um
                name: Salon 3A (L1)
                color: 808D7C
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_salon_1_mensuel_kwh_um
                name: Salon 1C (L1)
                color: 5F6F65
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_table_mensuel_kwh_um
                name: Table
                color: 677D6A
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes Salon
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: 0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_salon_5_mensuel_kwh_um
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: C9DABF
                type: column
              - entity: sensor.eclairage_salon_5_mensuel_kwh_um
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: W
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_salon_5_quotidien_kwh_um
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_5_hebdomadaire_kwh_um
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_5_mensuel_kwh_um
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_5_annuel_kwh_um
                name: A
                color: red
                state_content:
                  - name
                  - state
            grid_options:
              columns: 36
              rows: 1
          - type: heading
            icon: mdi:home
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.entree
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.cuisine
                icon: mdi:ceiling-light
                color: state
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.couloir
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
            heading: ENTREE - CUISINE - COULOIR
          - type: custom:apexcharts-card
            chart_type: donut
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes EntrÃ©e - Cuisine - Couloir Conso. / Jrs
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_entree_quotidien_kwh_um
                name: EntrÃ©e
                color: rgb(255, 207, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_cuisine_quotidien_kwh_um
                name: Cuisine
                color: rgb(222, 143, 95)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_couloir_quotidien_kwh_um
                name: Couloir
                color: rgb(255, 178, 111)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes EntrÃ©e - Cuisine - Couloir Conso. / Mois
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_entree_mensuel_kwh_um
                name: EntrÃ©e
                color: rgb(255, 207, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_cuisine_mensuel_kwh_um
                name: Cuisine
                color: rgb(222, 143, 95)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_couloir_mensuel_kwh_um
                name: Couloir
                color: rgb(255, 178, 111)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes EntrÃ©e, Cuisine & Couloir
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: 0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_appart_3_mensuel_kwh_um
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(222, 143, 95)
                type: column
              - entity: sensor.eclairage_appart_3_mensuel_kwh_um
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: W
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:home-lightbulb-outline
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_appart_3_quotidien_kwh_um
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_3_hebdomadaire_kwh_um
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_3_mensuel_kwh_um
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_3_annuel_kwh_um
                name: A
                color: red
                state_content:
                  - name
                  - state
            grid_options:
              columns: 36
              rows: 1
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau
                color: state
                state_content: name
                icon: mdi:desktop-tower-monitor
                name: Pc
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau_z2m
                name: Bureau
                icon: hue:wellner-solid
                color: state
                state_content: name
                tap_action:
                  action: more-info
            heading: BUREAU
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES BUREAU CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_play_1_pc_bureau_quotidien_kwh_um
                name: play 1
                color: rgb(22, 72, 99)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_2_pc_bureau_quotidien_kwh_um
                name: play 2
                color: rgb(66, 125, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_3_pc_bureau_quotidien_kwh_um
                name: play 3
                color: rgb(155, 190, 200)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_bureau_1_quotidien_kwh_um
                name: Bureau HUE 1
                color: rgb(122, 178, 211)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_bureau_2_quotidien_kwh_um
                name: Bureau HUE 2
                color: rgb(74, 98, 138)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES BUREAU CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_play_1_pc_bureau_mensuel_kwh_um
                name: play 1
                color: rgb(22, 72, 99)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_2_pc_bureau_mensuel_kwh_um
                name: play 2
                color: rgb(66, 125, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_3_pc_bureau_mensuel_kwh_um
                name: play 3
                color: rgb(155, 190, 200)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_bureau_1_mensuel_kwh_um
                name: Bureau HUE 1
                color: rgb(122, 178, 211)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_bureau_2_mensuel_kwh_um
                name: Bureau HUE 2
                color: rgb(74, 98, 138)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel Lampes Bureau
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: 0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_bureau_5_mensuel_kwh_um
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(22, 72, 99)
                type: column
              - entity: sensor.eclairage_bureau_5_mensuel_kwh_um
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: W
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_bureau_5_quotidien_kwh_um
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_5_hebdomadaire_kwh_um
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_5_mensuel_kwh_um
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_5_annuel_kwh_um
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:shower
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lampe_salle_de_bain_hue
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.relais_lumiere_sdb_sonoff
                icon: hue:adore-alt
                color: state
                tap_action:
                  action: more-info
            heading: SALLE DE BAIN
          - type: custom:apexcharts-card
            chart_type: donut
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Salle de bain Conso. / Jrs
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.lampe_salle_de_bain_hue_quotidien_kwh_um
                name: Salle de bain
                color: rgb(127, 85, 177)
                transform: return x * 1000;
                unit: W
              - entity: sensor.relais_lumiere_sdb_sonoff_quotidien_kwh_um
                name: Miroir
                color: rgb(155, 126, 189)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Salle de Bain Conso. / Mois
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.lampe_salle_de_bain_hue_mensuel_kwh_um
                name: Salle de bain
                color: rgb(127, 85, 177)
                transform: return x * 1000;
                unit: W
              - entity: sensor.relais_lumiere_sdb_sonoff_mensuel_kwh_um
                name: Miroir
                color: rgb(155, 126, 189)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes Salle de Bain
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: 0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_sdb_2_mensuel_kwh_um
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(127, 85, 177)
                type: column
              - entity: sensor.eclairage_sdb_2_mensuel_kwh_um
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: W
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:shower
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_sdb_2_quotidien_kwh_um
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_sdb_2_hebdomadaire_kwh_um
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_sdb_2_mensuel_kwh_um
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_sdb_2_annuel_kwh_um
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.chambre
                color: state
                icon: hue:flourish-alt
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lit
                icon: mdi:bed
                color: state
                tap_action:
                  action: more-info
            heading: CHAMBRE
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES CHAMBRE CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_chambre_1_quotidien_kwh_um
                name: Chambre 1 (B1)
                color: rgb(255, 198, 198)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_chambre_2_quotidien_kwh_um
                name: Chambre 2 (B2)
                color: rgb(217, 171, 171)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_gege_quotidien_kwh_um
                name: GÃ©raldine (TL1)
                color: rgb(199, 91, 122)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_eric_quotidien_kwh_um
                name: Eric (TL2)
                color: rgb(146, 26, 64)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES CHAMBRE CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_chambre_1_mensuel_kwh_um
                name: Chambre 1 (B1)
                color: rgb(255, 198, 198)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_chambre_2_mensuel_kwh_um
                name: Chambre 2 (B2)
                color: rgb(217, 171, 171)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_gege_mensuel_kwh_um
                name: GÃ©raldine (TL1)
                color: rgb(199, 91, 122)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_eric_mensuel_kwh_um
                name: Eric (TL2)
                color: rgb(146, 26, 64)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel Lampes Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: 0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: 0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_chambre_4_mensuel_kwh_um
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(146, 26, 64)
                type: column
              - entity: sensor.eclairage_chambre_4_mensuel_kwh_um
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: W
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:bed
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_chambre_4_quotidien_kwh_um
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_4_hebdomadaire_kwh_um
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_4_mensuel_kwh_um
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_4_annuel_kwh_um
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
        column_span: 3
    cards: []
  - title: Portable
    path: phone
    cards: []
    type: sections
    max_columns: 2
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:cellphone-nfc
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Xiaomi POCO X7 Pro
          - type: conditional
            conditions:
              - entity: sensor.poco_x7_pro_battery_level
                state_not: unavailable
              - entity: sensor.poco_x7_pro_battery_level
                state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:streamline-card
                  template: portable
                  variables:
                    entity: sensor.poco_x7_pro_battery_level
                - type: entities
                  entities:
                    - entity: sensor.poco_x7_pro_battery_level
                    - entity: sensor.poco_x7_pro_battery_state
                      name: Battery state
                    - entity: sensor.poco_x7_pro_charger_type
                      name: Charger type
                      secondary_info: none
                    - entity: sensor.poco_x7_pro_battery_health
                    - entity: sensor.poco_x7_pro_battery_temperature
                    - entity: sensor.poco_x7_pro_network_type
                    - entity: sensor.poco_x7_pro_wi_fi_connection
                  state_color: true
                  show_header_toggle: true
                  card_mod:
                    style: |
                      ha-card {
                        background: none !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 10Pro NE2213 (E)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: conditional
            conditions:
              - entity: sensor.ne2213_eric_battery_level
                state_not: unavailable
              - entity: sensor.ne2213_eric_battery_level
                state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:streamline-card
                  template: portable
                  variables:
                    entity: sensor.ne2213_eric_battery_level
                - type: entities
                  entities:
                    - entity: sensor.ne2213_eric_battery_level
                    - entity: sensor.ne2213_eric_battery_state
                      name: Battery state
                    - entity: sensor.ne2213_eric_charger_type
                      name: Charger type
                      secondary_info: none
                    - entity: sensor.ne2213_eric_battery_health
                      name: Battery health
                      secondary_info: none
                    - entity: sensor.ne2213_eric_battery_temperature
                    - entity: sensor.ne2213_eric_network_type
                    - entity: sensor.ne2213_eric_wi_fi_connection
                  state_color: true
                  show_header_toggle: true
                  card_mod:
                    style: |
                      ha-card {
                        background: none !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Samsung A8 SM-A530F
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: conditional
            conditions:
              - entity: sensor.sm_a530f_battery_level
                state_not: unavailable
              - entity: sensor.sm_a530f_battery_level
                state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:streamline-card
                  template: portable
                  variables:
                    entity: sensor.sm_a530f_battery_level
                - type: entities
                  entities:
                    - entity: sensor.sm_a530f_battery_level
                    - entity: sensor.sm_a530f_battery_state
                      name: Battery state
                    - entity: sensor.sm_a530f_charger_type
                      name: Charger type
                      secondary_info: none
                    - entity: sensor.sm_a530f_battery_health
                    - entity: sensor.sm_a530f_battery_temperature
                  state_color: true
                  show_header_toggle: true
                  card_mod:
                    style: |
                      ha-card {
                        background: none !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Tablette
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: conditional
            conditions:
              - entity: sensor.tablette_battery_level
                state_not: unavailable
              - entity: sensor.tablette_battery_level
                state_not: unknown
            card:
              type: vertical-stack
              cards:
                - type: custom:streamline-card
                  template: portable
                  variables:
                    entity: sensor.tablette_battery_level
                - type: entities
                  entities:
                    - entity: sensor.tablette_battery_level
                    - entity: sensor.tablette_battery_state
                      name: Battery state
                    - entity: sensor.tablette_charger_type
                      name: Charger type
                      secondary_info: none
                    - entity: sensor.tablette_battery_health
                    - entity: sensor.tablette_battery_temperature
                  state_color: true
                  show_header_toggle: true
                  card_mod:
                    style: |
                      ha-card {
                        background: none !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
      - type: grid
        cards:
          - type: heading
            icon: mdi:cellphone-nfc
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Xiaomi POCO X7 Pro Mamour
          - type: vertical-stack
            cards:
              - type: custom:streamline-card
                template: portable
                variables:
                  entity: sensor.poco_x7_pro_mamour_battery_level
          - type: entities
            entities:
              - entity: sensor.poco_x7_pro_mamour_battery_level
              - entity: sensor.poco_x7_pro_mamour_battery_state
                name: Battery state
              - entity: sensor.poco_x7_pro_mamour_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.poco_x7_pro_mamour_battery_health
              - entity: sensor.poco_x7_pro_mamour_battery_temperature
              - entity: sensor.poco_x7_pro_mamour_network_type
              - entity: sensor.poco_x7_pro_mamour_wi_fi_connection
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 10Pro NE2213 (M)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:streamline-card
                template: portable
                variables:
                  entity: sensor.ne2213_mamour_battery_level
          - type: entities
            entities:
              - entity: sensor.ne2213_mamour_battery_level
              - entity: sensor.ne2213_mamour_battery_state
                name: Battery state
              - entity: sensor.ne2213_mamour_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.ne2213_mamour_battery_health
                name: Battery health
                secondary_info: none
              - entity: sensor.ne2213_mamour_battery_temperature
              - entity: sensor.ne2213_mamour_network_type
              - entity: sensor.ne2213_mamour_wi_fi_connection
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 7 GM1901
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:streamline-card
                template: portable
                variables:
                  entity: sensor.gm1901_battery_level
          - type: entities
            entities:
              - entity: sensor.gm1901_battery_level
              - entity: sensor.gm1901_battery_state
                name: Battery state
              - entity: sensor.gm1901_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.gm1901_battery_health
              - entity: sensor.gm1901_battery_temperature
              - entity: sensor.gm1901_network_type
              - entity: sensor.gm1901_wi_fi_connection
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
  - type: sections
    path: prises
    max_columns: 1
    title: Prises
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:power-standby
            heading: PRISES Ã©CO.
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: phu:rooms-hallway
            heading: EntrÃ©e
            heading_style: title
            badges: []
          - type: custom:mushroom-entity-card
            entity: switch.prise_horloge_ikea
            name: Prise Eco. Horloge
            icon: mdi:power-socket-fr
            primary_info: name
            secondary_info: none
            tap_action:
              action: toggle
            layout: horizontal
            fill_container: false
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 2500 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 2500W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.prise_horloge_ikea_power' %}
                    {% set sensor_voltage = 'sensor.prise_horloge_ikea_voltage' %}
                    {% set sensor_current = 'sensor.prise_horloge_ikea_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% set color_plug = '76, 175, 80' %} 
                    {% set color_bar  = '76, 175, 80' %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                         
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges: []
            heading: Salon
          - type: custom:mushroom-entity-card
            entity: light.hue_smart_salon
            name: Prise Eco. Salon
            icon: mdi:power-socket-fr
            primary_info: name
            secondary_info: none
            tap_action:
              action: toggle
            layout: horizontal
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 2500 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 2500W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.prise_salon_chargeur_nous_power' %}
                    {% set sensor_voltage = 'sensor.prise_salon_chargeur_nous_voltage' %}
                    {% set sensor_current = 'sensor.prise_salon_chargeur_nous_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% set color_plug = '76, 175, 80' %} 
                    {% set color_bar  = '76, 175, 80' %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: heading
            icon: cil:tv
            heading_style: title
            badges: []
            heading: TV Salon
          - type: custom:mushroom-entity-card
            entity: light.hue_smart_tv_salon
            name: Prise Eco. TV Salon
            icon: mdi:power-socket-fr
            primary_info: name
            secondary_info: none
            tap_action:
              action: toggle
            layout: horizontal
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 2500 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 2500W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.light.hue_smart_tv_salon_power' %}
                    {% set sensor_voltage = 'sensor.light.hue_smart_tv_salon_voltage' %}
                    {% set sensor_current = 'sensor.light.hue_smart_tv_salon_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% set color_plug = '76, 175, 80' %} 
                    {% set color_bar  = '76, 175, 80' %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges: []
            heading: Bureau
          - type: custom:mushroom-entity-card
            entity: switch.hue_smart_eco_pc_bureau
            name: Prise PC Bureau
            icon: mdi:power-socket-fr
            primary_info: name
            tap_action:
              action: toggle
            layout: horizontal
            secondary_info: state
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 500 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 500W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.prise_bureau_pc_ikea_power' %}
                    {% set sensor_voltage = 'sensor.prise_bureau_pc_ikea_voltage' %}
                    {% set sensor_current = 'sensor.prise_bureau_pc_ikea_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% if is_state(config.entity, 'on') %}
                      {% set color_plug = '76, 175, 80' %}  {# Vert #}
                      {% set color_bar  = '76, 175, 80' %}
                    {% else %}
                      {% set color_plug = '158, 158, 158' %} {# Gris (Etat OFF) #}
                      {% set color_bar  = '158, 158, 158' %}
                    {% endif %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
            badges: []
          - type: custom:mushroom-entity-card
            entity: light.hue_smart_tv_chambre
            name: Prise Eco. TV Chambre
            icon: mdi:power-socket-fr
            primary_info: name
            secondary_info: none
            tap_action:
              action: toggle
            layout: horizontal
            fill_container: false
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 500 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 500W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.prise_tv_chambre_nous_power' %}
                    {% set sensor_voltage = 'sensor.prise_tv_chambre_nous_voltage' %}
                    {% set sensor_current = 'sensor.prise_tv_chambre_nous_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% set color_plug = '76, 175, 80' %} 
                    {% set color_bar  = '76, 175, 80' %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                         
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: heading
            icon: mdi:bed
            heading: TÃªte de Lit
            heading_style: title
            badges: []
          - type: custom:mushroom-entity-card
            entity: switch.prise_tete_de_lit_chambre
            name: Prise Eco. TÃªtes de Lit
            icon: mdi:power-socket-fr
            primary_info: name
            secondary_info: none
            tap_action:
              action: toggle
            layout: horizontal
            fill_container: false
            card_mod:
              style:
                .: |
                  ha-card {
                    /* ================================ */
                    /* USER CONFIG                      */
                    /* ================================ */
                    
                    /* --- MAIN SETTINGS --- */
                    {% set max_watts = 50 %}           {# The maximum W your device supports #}
                    {% set show_ma = false %}            {# Set to true for mA, false for A #}
                    {% set custom_msg = "MAX: 50W" %}  {# Text shown bottom right #}

                    {% set theme_mode = 'dark' %}        {# 'dark' or 'light' #}
                    {% set card_height = '90px' %}      {# card Height #}
                    
                    /* --- SENSORS --- */
                    {% set sensor_power =   'sensor.prise_tete_de_lit_chambre_power' %}
                    {% set sensor_voltage = 'sensor.prise_tete_de_lit_chambre_voltage' %}
                    {% set sensor_current = 'sensor.prise_tete_de_lit_chambre_current' %}

                    /* --- COLORS (RGB Triplets) --- */
                    /* Electric Green for Power/Plug */
                    {% set color_plug = '76, 175, 80' %} 
                    {% set color_bar  = '76, 175, 80' %} 

                    /* Colors (Badges W, A, V) - Converted from Hex to RGB */
                    {% set color_watts = '255, 152, 0' %}   {# Orange #}
                    {% set color_amps  = '33, 150, 243' %}  {# Blue #}
                    {% set color_volts = '76, 175, 80' %}   {# Green #}

                    /* --- FONT SIZES --- */
                    {% set fs_icon   = '65px' %} 
                    {% set fs_main   = '14px' %} 
                    {% set fs_sec    = '11px' %} 
                    {% set fs_badges = '11px' %} 
                    {% set fs_custom = '11px' %} 

                    /* ============================= */

                    /* Background Logic (From Card 1) */
                    {% if theme_mode == 'dark' %}
                       {% set card_bg_color = '28, 28, 28' %}
                       {% set color_text_main = '255, 255, 255' %} 
                       {% set color_text_sec  = '255, 255, 255' %}
                       {% set color_text_msg  = '255, 255, 255' %}
                    {% else %}
                       {% set card_bg_color = '255, 255, 255' %}
                       {% set color_text_main = '33, 33, 33' %} 
                       {% set color_text_sec  = '114, 114, 114' %} 
                       {% set color_text_msg  = '33, 33, 33' %}
                    {% endif %}

                    /* --- SENSOR LOGIC --- */
                    {% set watts = states(sensor_power) | float(0) | int %}
                    {% set volts = states(sensor_voltage) | float(0) | int %}
                    {% set amps  = states(sensor_current) | float(0) %}

                    /* --- mA vs A LOGIC --- */
                    {% if show_ma %}
                        {% set str_amps = amps | int ~ " mA" %}
                    {% else %}
                        {% set str_amps = amps | round(2) ~ " A" %}
                    {% endif %}

                    /* --- ANIMATION LOGIC --- */
                    {% set pct = (watts / max_watts * 100) | int %}
                    {% set pct = 100 if pct > 100 else pct %}
                    
                    /* Calculate Speed based on Load (Unique to Plug) */
                    {% set dur = 2.0 - (watts / max_watts * 1.5) %}
                    {% set dur = 0.4 if dur < 0.4 else dur %}

                    /* Define Animation Strings (Active only if Watts > 0) */
                    {% if watts > 0 %}
                        {% set anim_shake = 'ultra-plug-on ' ~ dur ~ 's ease-in-out infinite' %}
                        {% set anim_glow  = 'ultra-plug-glow 1.8s ease-in-out infinite' %}
                        {% set anim_arcs  = 'ultra-plug-arcs 1.2s linear infinite' %}
                        {% set glow_bg    = 'inset 0 0 60px rgba(' ~ color_bar ~ ', 0.1)' %}
                    {% else %}
                        {% set anim_shake = 'none' %}
                        {% set anim_glow  = 'none' %}
                        {% set anim_arcs  = 'none' %}
                        {% set glow_bg    = 'none' %}
                    {% endif %}

                    /* Strings */
                    {% set str_watts = watts ~ " W" %}
                    {% set str_volts = volts ~ " V" %}

                    /* --- CSS VARIABLES --- */
                    --c-plug:  {{ color_plug }};
                    --c-watts: {{ color_watts }};
                    --c-amps:  {{ color_amps }};
                    --c-volts: {{ color_volts }};
                    --c-bar:   {{ color_bar }};
                    
                    --c-txt-m: {{ color_text_main }};
                    --c-txt-s: {{ color_text_sec }};
                    --c-txt-c: {{ color_text_msg }};

                    --v-watts: "{{ str_watts }}";
                    --v-volts: "{{ str_volts }}";
                    --v-amps:  "{{ str_amps }}";    
                    --v-custom: "{{ custom_msg }}";

                    /* --- PASS ANIMATIONS DOWN --- */
                    --anim-shake: {{ anim_shake }};
                    --anim-glow:  {{ anim_glow }};
                    --anim-arcs:  {{ anim_arcs }};

                    /* --- FONT SIZE VARIABLES --- */
                    --fs-main:   {{ fs_main }};
                    --fs-sec:    {{ fs_sec }};
                    --fs-badges: {{ fs_badges }};
                    --fs-custom: {{ fs_custom }};
                    --fs-icon:   {{ fs_icon }};
                    
                    --bar-width: {{ pct }}%;
                    --card-h: {{ card_height }};
                    --card-b: {{ card_bg_color }};
                    --card-in-glow: {{ glow_bg }};

                    /* Badge Positioning */
                    --badge-bg-opacity: 0.15;
                    --badge-width: 58px;
                    --badge-height: 20px;
                    --badge-gap: 6px;
                    --pos-1: 12px;
                    --pos-2: calc(12px + var(--badge-width) + var(--badge-gap));
                    --pos-3: calc(12px + (var(--badge-width) * 2) + (var(--badge-gap) * 2));
                    
                    /* Card Styling */
                    background: rgb(var(--card-b)) !important;
                    height: var(--card-h) !important;
                    box-shadow: var(--card-in-glow);
                    overflow: hidden !important;
                         
                    width: auto !important;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                  }

                  /* BADGES (Top Right) */
                  ha-card::after {
                    content: var(--v-watts);
                    background: color-mix(in srgb, rgb(var(--c-watts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-watts));
                    color: rgb(var(--c-watts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-watts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-1);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }

                  ha-card::before {
                    content: var(--v-amps);
                    background: color-mix(in srgb, rgb(var(--c-amps)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-amps));
                    color: rgb(var(--c-amps));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-amps)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-2);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-shape-icon$: |
                  .shape {
                    --icon-size: var(--fs-icon) !important;
                    --shape-color: rgba(var(--c-plug), 0.2) !important;
                    --icon-color: rgb(var(--c-plug)) !important;
                    background: radial-gradient(circle, rgba(var(--c-plug), 0.1) 0%, transparent 70%) !important;
                    overflow: visible !important;
                    transform-origin: 50% 50%;
                    
                    /* Consume Variables from Top */
                    animation: var(--anim-shake);
                  }

                  .shape::before,
                  .shape::after {
                    content: '';
                    position: absolute; inset: -4px; border-radius: 50%;
                    pointer-events: none;
                  }

                  .shape::before {
                    /* Glow Animation */
                    animation: var(--anim-glow);
                    z-index: 0;
                  }

                  .shape::after {
                    /* Arcs Animation */
                    animation: var(--anim-arcs);
                    z-index: 1;
                  }

                  /* --- KEYFRAMES (Using RGB vars) --- */
                  @keyframes ultra-plug-on {
                    0%   { transform: scale(1); }
                    25%  { transform: scale(1.05) translateY(-1px); }
                    50%  { transform: scale(1.08) translateY(-2px); }
                    75%  { transform: scale(1.04) translateY(-1px); }
                    100% { transform: scale(1); }
                  }

                  @keyframes ultra-plug-glow {
                    0% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                    50% {
                      box-shadow: 0 0 18px 6px rgba(var(--c-plug), 0.9), 0 0 32px 12px rgba(var(--c-plug), 0.4);
                    }
                    100% {
                      box-shadow: 0 0 10px 3px rgba(var(--c-plug), 0.6), 0 0 20px 8px rgba(var(--c-plug), 0.3);
                    }
                  }

                  @keyframes ultra-plug-arcs {
                    0% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                    25% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.7), 12px 4px 0 -4px rgba(var(--c-plug), 0.4);
                    }
                    50% {
                      box-shadow: -6px 2px 0 -4px rgba(var(--c-plug), 0.3), 10px -8px 0 -4px rgba(var(--c-plug), 0.7);
                    }
                    75% {
                      box-shadow: -12px 4px 0 -4px rgba(var(--c-plug), 0.5), 8px 0 0 -4px rgba(var(--c-plug), 0.2);
                    }
                    100% {
                      box-shadow: -10px -6px 0 -4px rgba(var(--c-plug), 0.0), 12px 4px 0 -4px rgba(var(--c-plug), 0.0);
                    }
                  }

                  ha-icon {
                    z-index: 2;
                    filter: drop-shadow(0 0 5px rgba(var(--c-plug), 0.8));
                  }
                mushroom-state-item$: |
                  .container::before {
                    /* PROGRESS BAR */
                    content: '';
                    position: absolute; 
                    bottom: 0px; left: 0; 
                    width: var(--bar-width);
                    height: 4px;
                    background: rgb(var(--c-bar));
                    box-shadow: 0 -1px 8px rgba(var(--c-bar), 0.5);
                    border-bottom-left-radius: var(--ha-card-border-radius, 12px);
                    border-bottom-right-radius: 0; 
                    transition: width 0.5s ease; z-index: 2;
                  }
                  .container::after {
                    /* VOLTS BADGE */
                    content: var(--v-volts);
                    background: color-mix(in srgb, rgb(var(--c-volts)), transparent calc(100% - (var(--badge-bg-opacity) * 100)));
                    border: 1px solid rgb(var(--c-volts));
                    color: rgb(var(--c-volts));
                    box-shadow: 0 0 6px 0 color-mix(in srgb, rgb(var(--c-volts)), transparent 70%);
                    position: absolute; top: 12px; right: var(--pos-3);
                    width: var(--badge-width); height: var(--badge-height);
                    display: flex; align-items: center; justify-content: center;
                    font-size: var(--fs-badges);
                    font-weight: 700; border-radius: 4px; z-index: 5;
                  }
                mushroom-state-info$: |
                  /* MAIN NAME SIZE & COLOR */
                  .primary {
                    font-size: var(--fs-main) !important;
                    color: rgb(var(--c-txt-m)) !important;
                  }
                  .secondary {
                    font-size: var(--fs-sec) !important;
                    color: rgb(var(--c-txt-s)) !important;
                  }
                  .container::after {
                    /* CUSTOM msg */
                    content: var(--v-custom);
                    position: absolute; bottom: 8px; right: 12px; 
                    width: 200px; text-align: right;
                    font-size: var(--fs-custom);
                    font-weight: 600; 
                    color: rgba(var(--c-txt-c), 0.4); 
                    letter-spacing: 1px; z-index: 6;
                  }
          - type: custom:streamline-card
            template: nav_bar
  - title: BATTERY (BP)
    path: battery-bp
    cards: []
    type: sections
    max_columns: 1
    sections:
      - type: grid
        columns: 1
        square: false
        cards:
          - type: heading
            icon: mdi:battery-high
            heading: BATTERIES (Boutons / Thermostats / DÃ©tecteursâ€¦)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries des boutons-poussoirs HUE
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Boutons HUE (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:light-switch
                icon_color: first
                entities:
                  - sensor.hue_smart_button_entee_1_battery
                  - sensor.hue_smart_button_entee_2_battery
                  - sensor.hue_smart_button_eco_battery
                  - sensor.hue_smart_button_table_battery
                  - sensor.hue_smart_button_cuisine_battery
                  - sensor.hue_smart_button_couloir_battery
                  - sensor.hue_smart_button_batterie
                  - sensor.boutton_salle_de_bain_hue_battery
                  - sensor.hue_smart_button_chambre_battery
                  - sensor.eric_hue_smart_button_chambre_battery
                  - sensor.gege_hue_smart_button_chambre_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries â€” boutons & dÃ©tecteurs IKEA
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Capteurs IKEA (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:hammer-screwdriver
                icon_color: first
                entities:
                  - sensor.inter_tv_chambre_ikea_rodret_battery
                  - sensor.inter_bureau_rodret_battery
                  - sensor.inter_somrig_battery
                  - sensor.inter_salon_4_ikea_battery
                  - sensor.detecteur_de_fuite_ikea_battery
                  - sensor.detecteur_vallhorn_battery
                  - sensor.poussoir_ikea_tradfri_battery
                  - sensor.inter_radiateur_salle_de_bain_ikea_rodret_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries â€” contacts de fenÃªtres IKEA
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Contacts de fenÃªtres IKEA (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:window-closed-variant
                icon_color: first
                entities:
                  - sensor.contact_fenetre_salon_ikea_battery
                  - sensor.contact_fenetre_cuisine_ikea_battery
                  - sensor.contact_fenetre_bureau_ikea_battery
                  - sensor.contact_fenetre_chambre_ikea_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries â€” contacts de fenÃªtres SONOFF
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: >-
                  Contacts de fenÃªtres SONOFF (Total : {count} / Mini. : {min}
                  %)
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:window-closed-variant
                icon_color: first
                entities:
                  - sensor.contact_fenetre_salon_sonoff_battery
                  - sensor.contact_fenetre_cuisine_sonoff_battery
                  - sensor.contact_fenetre_bureau_sonoff_battery
                  - sensor.contact_fenetre_chambre_sonoff_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries â€” thermostats SONOFF
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Thermostats SONOFF (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:thermometer
                icon_color: first
                entities:
                  - sensor.th_balcon_nord_battery
                  - sensor.th_salon_battery
                  - sensor.th_cellier_battery
                  - sensor.th_cuisine_battery
                  - sensor.th_bureau_battery
                  - sensor.th_salle_de_bain_battery
                  - sensor.th_chambre_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
  - title: SystÃ¨me Mini PC
    path: systeme-mini-pc
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: phu:intel-nuc
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Mini - P.C.
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: picture
                    image: /local/images/mini pc.png
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                          }
                  - type: custom:stack-in-card
                    mode: horizontal
                    cards:
                      - type: custom:mushroom-template-card
                        primary: 'IP Int. / Ext.:'
                        secondary: ' '
                        icon: mdi:ip
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: '{{ states(''sensor.local_ip'') }}'
                        secondary: ' '
                        icon: mdi:ip-network
                        icon_color: white
                        tap_action:
                          action: navigate
                          navigation_path: '#temp'
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -20px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: '{{ states(''sensor.myip'') }}'
                        secondary: ''
                        icon: mdi:wan
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -20px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:stack-in-card
                    mode: horizontal
                    cards:
                      - type: custom:mushroom-template-card
                        primary: 'Uptime:'
                        secondary: ' '
                        icon: mdi:clock-outline
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: >-
                          {% set uptime = (now()|as_timestamp -
                          states('sensor.system_monitor_dernier_demarrage')|as_timestamp)
                          %} {% set jours = (uptime / 86400) | int(0) %} {%- if
                          jours > 0 -%} {{ jours }}d {{ (uptime - (jours *
                          86400)) | int(0) | timestamp_custom('%Hh %Mm', false)
                          }} {%- else -%} {{ uptime | int(0) |
                          timestamp_custom('%Hh %Mm', false) }} {%- endif -%}
                        secondary: ''
                        icon: mdi:clock-start
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -100px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                    card_mod:
                      style: |
                        ha-card {
                          margin-top: -15px;
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -15px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_utilisation_du_processeur
                            name: CPU USED
                            icon: mdi:cpu-64-bit
                            color: rgb(68,115,158)
                            height: 40px
                            min: 0
                            max: 100
                            target: 82
                        animation:
                          state: 'off'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        double_tap_action:
                          action: none
                        severity:
                          - color: rgb(68,115,158)
                            from: 0
                            to: 74
                          - color: rgb(255,193,7)
                            from: 75
                            to: 79
                          - color: rgb(244,67,54)
                            from: 90
                            to: 100
                        card_mod:
                          style: >
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }

                            bar-card-currentbar { border: none !important;
                            box-shadow: none !important; }

                            bar-card-backgroundbar { border: none !important;
                            box-shadow: none !important; }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_temperature_du_processeur
                            name: CPU Temp.
                            icon: mdi:thermometer
                            color: rgb(255,193,7)
                            height: 40px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        double_tap_action:
                          action: none
                        severity:
                          - color: rgb(255,193,7)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: >
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white !important;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }

                            bar-card-currentbar { border: none !important;
                            box-shadow: none !important; }

                            bar-card-backgroundbar { border: none !important;
                            box-shadow: none !important; }
                card_mod:
                  style: >
                    ha-card { background: none !important; box-shadow: none
                    !important; border: none !important; }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_utilisation_de_la_memoire
                            name: Mem.
                            icon: mdi:memory
                            color: rgb(81,140,67)
                            height: 40px
                            min: 0
                            max: 100
                            target: 65
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 74
                          - color: rgb(255,152,1)
                            from: 75
                            to: 79
                          - color: rgb(244,67,54)
                            from: 80
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_memoire_utilisee
                            name: USED
                            color: rgb(244,67,54)
                            height: 40px
                            min: 0
                            max: 16384
                            target: 7500
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_memoire_libre
                            name: FREE
                            color: rgb(68,115,158)
                            height: 40px
                            min: 0
                            max: 16384
                            target: 7500
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#disk'
                        entities:
                          - entity: sensor.system_monitor_utilisation_du_disque
                            name: SSD SATA 512Go
                            icon: mdi:harddisk
                            color: rgb(142,142,142)
                            height: 40px
                            min: 0
                            max: 524
                            target: 470
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: >-
                              sensor.system_monitor_debit_du_reseau_entrant_via_enp1s0
                            name: Download
                            icon: mdi:download
                            color: rgb(81,140,67)
                            height: 40px
                            min: 0
                            max: 130
                            target: 20
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: >-
                              sensor.system_monitor_debit_du_reseau_sortant_via_enp1s0
                            name: Upload
                            icon: mdi:upload
                            color: rgb(244,67,54)
                            height: 40px
                            min: 0
                            max: 130
                            target: 20
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: custom:ring-tile
                    icon_tap_action:
                      action: navigate
                      navigation_path: '#speed'
                    entity: sensor.system_monitor_utilisation_du_processeur
                    name: Utilisation CPU
                    ring_entity: sensor.system_monitor_utilisation_du_processeur
                    ring_type: open
                    ring_size: 3
                    scale: ticks_with_labels
                    middle_element: value_with_unit
                    bottom_element: name
                    colorize_icon: true
                    indicator: dot
                    min: 0
                    max: 100
                    max_decimals: 0
                    colour:
                      '0': ha_green
                      '69': ha_green
                      '70': ha_orange
                      '79': ha_orange
                      '80': ha_red
                      '100': ha_red
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                          cursor: pointer; /* confort visuel */
                        }
                  - type: custom:mini-graph-card
                    tap_action:
                      action: navigate
                      navigation_path: '#speed'
                    entities:
                      - entity: sensor.system_monitor_utilisation_du_processeur
                        color: rgb(68,115,158)
                        name: CPU Use
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 2
                    points_per_hour: 6
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: rgb(68,115,158) !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        icon_tap_action:
                          action: navigate
                          navigation_path: '#speed'
                        entities:
                          - entity: sensor.cpu_speed
                            name: CPU SPEED
                            icon: mdi:waveform
                            color: rgb(81,140,67)
                            height: 20px
                            min: 0
                            max: 4
                            target: 3.125
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 2.9
                          - color: rgb(255,152,1)
                            from: 3
                            to: 3.3
                          - color: rgb(244,67,54)
                            from: 3.4
                            to: 4
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_1m
                            name: Charge 1m
                            color: rgb(81,140,67)
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 2
                          - color: rgb(255,152,1)
                            from: 2
                            to: 3
                          - color: rgb(244,67,54)
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_5m
                            name: Charge 5m
                            color: rgb(81,140,67)
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 2
                          - color: rgb(255,152,1)
                            from: 2
                            to: 3
                          - color: rgb(244,67,54)
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_15m
                            name: Charge 15m
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 2
                          - color: rgb(255,152,1)
                            from: 2
                            to: 3
                          - color: rgb(244,67,54)
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: custom:ring-tile
                    icon_tap_action:
                      action: navigate
                      navigation_path: '#temp'
                    entity: sensor.temperature_cpu_package_sys
                    name: TempÃ©rature CPU
                    ring_entity: sensor.temperature_cpu_package_sys
                    ring_type: open
                    ring_size: 3
                    scale: ticks_with_labels
                    middle_element: value_with_unit
                    bottom_element: name
                    colorize_icon: true
                    indicator: dot
                    min: 0
                    max: 100
                    max_decimals: 0
                    colour:
                      '0': ha_green
                      '60': ha_green
                      '65': ha_orange
                      '70': ha_orange
                      '75': ha_red
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                          cursor: pointer; /* confort visuel */
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.temperature_cpu_package_sys
                        color: rgb(255,193,7)
                        name: TempÃ©rature CPU
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 2
                    points_per_hour: 6
                    tap_action:
                      action: navigate
                      navigation_path: '#temp'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: rgb(255,193,7) !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.temperature_core_0_sys
                            name: Core 0
                            color: rgb(81,140,67)
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.temperature_core_1_sys
                            name: Core 1
                            color: rgb(81,140,67)
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.temperature_core_2_sys
                            name: Core 2
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.temperature_core_3_sys_2
                            name: Core 3
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#temp'
                        entities:
                          - entity: sensor.temperature_cpu_package_sys
                            name: TempÃ©rature CPU
                            icon: mdi:thermometer
                            color: rgb(81,140,67)
                            height: 20px
                            min: 0
                            max: 100
                            target: 88
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#temp'
                        entities:
                          - entity: sensor.temperature_carte_mere_sys
                            name: TempÃ©rature Carte MÃ¨re
                            icon: mdi:thermometer
                            color: rgb(81,140,67)
                            height: 20px
                            min: 0
                            max: 100
                            target: 88
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 64
                          - color: rgb(255,152,1)
                            from: 65
                            to: 74
                          - color: rgb(244,67,54)
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: custom:ring-tile
                    icon_tap_action:
                      action: navigate
                      navigation_path: '#conso'
                    entity: sensor.prise_mini_pc_ikea_power
                    name: Conso. CPU
                    ring_entity: sensor.prise_mini_pc_ikea_power
                    ring_type: open
                    ring_size: 3
                    scale: ticks_with_labels
                    middle_element: value_with_unit
                    bottom_element: name
                    colorize_icon: true
                    indicator: dot
                    min: 0
                    max: 30
                    colour:
                      '0': ha_green
                      '13': ha_green
                      '14': ha_orange
                      '18': ha_orange
                      '19': ha_red
                      '30': ha_red
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.prise_mini_pc_ikea_power
                        color: gainsboro
                        name: Conso. CPU
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 2
                    points_per_hour: 6
                    tap_action:
                      action: navigate
                      navigation_path: '#conso'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: gainsboro !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#conso'
                        entities:
                          - entity: sensor.prise_mini_pc_ikea_power
                            name: POWER
                            icon: mdi:lightning-bolt-outline
                            color: rgb(81,140,67)
                            height: 20px
                            min: 0
                            max: 25
                            target: 22
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(81,140,67)
                            from: 0
                            to: 13
                          - color: rgb(255,152,1)
                            from: 14
                            to: 18
                          - color: rgb(244,67,54)
                            from: 19
                            to: 30
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            grid_options:
              columns: 12
              rows: auto
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#speed'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Utilisation du CPU
                icon: mdi:cpu-64-bit
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                cache: true
                span:
                  offset: +1m
                now:
                  show: true
                  color: '#F44336'
                  label: Now
                header:
                  show: true
                  title: ' '
                  show_states: true
                  colorize_states: true
                apex_config:
                  chart:
                    height: 320px
                    toolbar:
                      show: true
                  legend:
                    show: false
                  tooltip:
                    shared: true
                    intersect: false
                all_series_config:
                  show:
                    legend_value: false
                    extremas: true
                yaxis:
                  - id: Use
                    min: 0
                    max: ~30
                    decimals: 0
                    opposite: true
                    apex_config:
                      tickAmount: 5
                series:
                  - entity: sensor.system_monitor_utilisation_du_processeur
                    name: InstantanÃ©
                    yaxis_id: Use
                    type: area
                    curve: stepline
                    stroke_width: 1
                    opacity: 0.3
                    fill_raw: last
                    color: rgb(68,115,158)
                    color_threshold:
                      - value: 0
                        color: rgb(68,115,158)
                      - value: 65
                        color: '#FFC107'
                      - value: 85
                        color: '#F44336'
                  - entity: sensor.system_monitor_utilisation_du_processeur
                    name: Moy.(24h)
                    yaxis_id: Use
                    type: line
                    curve: smooth
                    stroke_dash: 5
                    stroke_width: 2.5
                    color: red
                    group_by:
                      func: avg
                      duration: 1h
                  - entity: sensor.system_monitor_utilisation_du_processeur
                    name: Moy.(730hrs)
                    color: '#FF5252'
                    fill_raw: last
                    group_by:
                      func: avg
                      duration: 730h
                    show:
                      in_brush: false
                      in_chart: false
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#temp'
                name: TempÃ©rature du processeur
                icon: mdi:thermometer
                button_type: name
                show_header: true
                show_icon: true
                show_name: true
                show_state: false
                show_last_changed: false
                show_attribute: false
                force_icon: false
                card_layout: normal
                close_on_click: false
                hide_backdrop: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                cache: true
                span:
                  offset: +1m
                now:
                  show: true
                  color: '#F44336'
                  label: Now
                header:
                  show: true
                  title: ' '
                  show_states: true
                  colorize_states: true
                apex_config:
                  chart:
                    height: 320px
                    toolbar:
                      show: true
                  legend:
                    show: false
                  tooltip:
                    shared: true
                    intersect: false
                all_series_config:
                  show:
                    legend_value: false
                    extremas: true
                yaxis:
                  - id: Temp
                    min: auto
                    max: auto
                    decimals: 0
                    opposite: true
                    apex_config:
                      tickAmount: 6
                series:
                  - entity: sensor.system_monitor_temperature_du_processeur
                    name: InstantanÃ©
                    yaxis_id: Temp
                    type: area
                    stroke_width: 1
                    opacity: 0.3
                    fill_raw: last
                    color_threshold:
                      - value: 0
                        color: '#4CAF50'
                      - value: 55
                        color: '#FFC107'
                      - value: 70
                        color: '#F44336'
                  - entity: sensor.system_monitor_temperature_du_processeur
                    name: Moy.(24h)
                    yaxis_id: Temp
                    type: line
                    stroke_dash: 5
                    stroke_width: 2.5
                    color: red
                    group_by:
                      func: avg
                      duration: 1h
                  - entity: sensor.system_monitor_temperature_du_processeur
                    name: Moy.(730hrs)
                    color: '#FF5252'
                    fill_raw: last
                    group_by:
                      func: avg
                      duration: 730h
                    show:
                      in_brush: false
                      in_chart: false
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#conso'
                name: Consommation Mini-PC
                icon: mdi:lightning-bolt-circle
                button_type: name
                show_header: true
                show_icon: true
                show_name: true
                bg_opacity: '0'
              - type: custom:streamline-card
                template: conso_temps_reel_appareil
                variables:
                  card_title: Prise Mini P.C.
                  energy_entity: sensor.prise_mini_pc_ikea_power
                  energy_color: gainsboro
                  current_entity: sensor.prise_mini_pc_ikea_current
                  avg_daily_entity: sensor.mini_pc_avg_watts_daily
                  conso_daily_kwh_entity: sensor.mini_pc_daily
              - type: custom:streamline-card
                template: conso_mensuelle_appareil
                variables:
                  title: Conso. mensuelle Mini P.C.
                  energy_entity: sensor.prise_mini_pc_ikea_energy
                  color: gainsboro
                  avg_monthly_entity: sensor.mini_pc_avg_watts_monthly
                  conso_monthly_kwh_entity: sensor.mini_pc_monthly
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#disk'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Espace disque utilisÃ© (SSD SATA)
                icon: mdi:harddisk
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                brush:
                  selection_span: 6h
                  apex_config: null
                header:
                  show: true
                  title: Disque (512Go)
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: disk
                    min: 0
                    max: auto
                    opposite: true
                    apex_config:
                      tickAmount: 10
                series:
                  - entity: sensor.system_monitor_espace_utilise
                    name: Espace disque utilisÃ©
                    color: green
                    type: area
                    show:
                      legend_value: false
                      extremas: true
                    stroke_width: 1
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 7500
                        color: orange
                      - value: 10000
                        color: red
                  - entity: sensor.system_monitor_espace_utilise
                    color: green
                    stroke_width: 1
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#memory'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: MÃ©moire utilisÃ©
                icon: mdi:memory
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                brush:
                  selection_span: 3h
                  apex_config: null
                header:
                  show: true
                  title: MEMOIRE (16Go)
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: disk
                    min: 0
                    max: auto
                    opposite: true
                    apex_config:
                      tickAmount: 10
                series:
                  - entity: sensor.system_monitor_memoire_utilisee
                    name: MÃ©moire utilisÃ©
                    color: green
                    type: area
                    stroke_width: 0.01
                    show:
                      legend_value: false
                      extremas: true
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 14000
                        color: orange
                      - value: 15000
                        color: red
                  - entity: sensor.system_monitor_memoire_utilisee
                    color: green
                    stroke_width: 0.01
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
    badges: []
    cards: []
  - path: systeme-freebox
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:server-network
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: FREEBOX
          - type: custom:bubble-card
            card_type: separator
            name: Speedtest
            icon: phu:speedtest
            card_layout: normal
            rows: 1
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
              ha-card {
                border-radius: 0px !important;
                padding-top: 10px !important;
                padding-bottom: 20px !important;
                bottom: 0 !important;
              }
            sub_button:
              - entity: sensor.speedtest_cli_data
                icon: mdi:clock-time-four-outline
                show_last_changed: true
                tap_action:
                  action: none
                show_icon: true
                show_background: true
                show_attribute: false
          - type: custom:bubble-card
            card_type: button
            button_type: name
            name: DÃ©marrer Speedtest
            icon: phu:speedtest
            show_last_changed: true
            show_attribute: false
            double_tap_action:
              action: none
            hold_action:
              action: none
            card_layout: normal
            tap_action:
              action: perform-action
              target:
                entity_id: sensor.speedtest_cli_data
              perform_action: homeassistant.update_entity
              data:
                entity_id:
                  - sensor.speedtest_cli_data
            button_action:
              tap_action:
                action: call-service
                service: homeassistant.update_entity
                service_data:
                  entity_id: sensor.speedtest_cli_data
                target: {}
            sub_button:
              - icon: mdi:play
                show_background: false
                show_last_changed: false
                show_attribute: false
                tap_action:
                  action: perform-action
                  target:
                    entity_id: sensor.speedtest_cli_data
                  perform_action: homeassistant.update_entity
                  data:
                    entity_id:
                      - sensor.speedtest_cli_data
                show_name: false
                entity: sensor.speedtest_cli_data
            columns: 2
            styles: |-
              .bubble-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-icon-container{
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }

              .bubble-button-background {
                opacity: 0.75 !important;
                background-color: rgba(34, 163, 220) !important

              }


              .bubble-sub-button-1 > ha-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-sub-button-1 {
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            name: Afficher Historique
            icon: mdi:chart-histogram
            entity: sensor.speedtest_cli_data
            show_state: false
            show_last_changed: false
            show_attribute: false
            tap_action:
              action: navigate
              navigation_path: '#speedtest_details'
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#speedtest_details'
              double_tap_action:
                action: none
              hold_action:
                action: none
            columns: 2
            card_layout: normal
            styles: |-
              .bubble-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-icon-container{
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }

              .bubble-button-background {
                opacity: 0.75 !important;
                background-color: rgba(34, 163, 220) !important

              }


              .bubble-sub-button-1 > ha-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-sub-button-1 {
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }
          - type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: true
              border_radius: true
              background: true
              outer_padding: false
            cards:
              - type: entities
                header:
                  type: picture
                  image: /local/images/free-1.jpeg
                entities:
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: 'External IPv4:'
                    icon: mdi:ip
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: IPv4
                        name: ' '
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: 'External IPv6:'
                    icon: mdi:ip
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: IPv6
                        name: ' '
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: Uptime
                    icon: mdi:web-clock
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: uptime
                        format: total
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: Connection
                    icon: mdi:wan
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: connection_type
                        name: Type
                      - entity: device_tracker.freebox_v8_r1
                        attribute: firmware_version
                        name: firmware
                  - entity: sensor.freebox_download_speed
                    name: Freebox download speed
                    icon: mdi:arrow-down-thick
                    show_state: true
                  - entity: sensor.freebox_upload_speed
                    name: Freebox upload speed
                    icon: mdi:arrow-up-thick
                    show_state: null
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:apexcharts-card
                graph_span: 24h
                update_interval: 1m
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: TempÃ©rature 1, 2 & CPU B
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: TH
                    min: auto
                    max: auto
                    opposite: true
                    decimals: 2
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: last
                    duration: 1h
                  show:
                    legend_value: false
                    extremas: true
                series:
                  - entity: sensor.freebox_temperature_1
                    name: TempÃ©rature 1
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.freebox_temperature_1
                    name: TempÃ©rature 2
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.freebox_temperature_cpu_b
                    name: TempÃ©rature CPU B
                    color: green
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#speedtest_details'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Historique du Speedtest
                icon: phu:speedtest
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: true
                bg_opacity: 0
              - type: custom:bubble-card
                card_type: separator
                name: Historique des Speedtest
                icon: mdi:chart-histogram
                sub_button:
                  - entity: sensor.speedtest_cli_data
                    show_last_changed: true
                    show_icon: true
                    icon: mdi:clock-time-two-outline
                    show_background: true
                    show_state: false
                    show_attribute: false
                    name: Date du dernier test
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    icon: mdi:server-outline
                    icon_color: gainsboro
                    content: >-
                      {{ states("sensor.speedtest_isp") }} <-> Server: {{
                      states("sensor.speedtest_server_name") }}  / {{
                      states("sensor.speedtest_server_location_2") }}  / {{
                      states("sensor.speedtest_server_country_2") }}
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          margin-top: -8px;
                          box-shadow: 2px 2px 4px 0px rgba(0,0,0,0.5) !important;
                          border: 5px rgba(0,0,0,0.25) outset !important;
                          --chip-height: 35px;
                          --chip-icon-size: 20px;
                          --chip-font-size: 14px;
                        }
                alignment: left
              - type: vertical-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_download
                    name: Download
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.speedtest_cli_download
                        name: Download
                    name: Download
                    decimals: '0'
                    more_info: true
                    line_width: 2
                    hours_to_show: 24
                    points_per_hour: 2
                    show:
                      fill: true
                      graph: line
                      icon: true
                      name: true
                      state: true
                      labels: true
                      extrema: true
                      average: true
                      points: false
                      icon_adaptive_color: true
                    color_thresholds:
                      - value: 100
                        color: '#ef1d0f'
                      - value: 200
                        color: '#ef5a0f'
                      - value: 400
                        color: '#f0da11'
                      - value: 600
                        color: '#11f13a'
                      - value: 800
                        color: '#1da4f2'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_upload
                    name: Upload
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
              - type: vertical-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.speedtest_cli_upload
                        name: Upload
                    name: Upload
                    decimals: '0'
                    more_info: true
                    line_width: 2
                    hours_to_show: 24
                    points_per_hour: 2
                    show:
                      fill: true
                      graph: line
                      icon: true
                      name: true
                      state: true
                      labels: true
                      extrema: true
                      average: true
                      points: false
                      icon_adaptive_color: true
                    color_thresholds:
                      - value: 50
                        color: '#ef1d0f'
                      - value: 100
                        color: '#ef5a0f'
                      - value: 200
                        color: '#f0da11'
                      - value: 400
                        color: '#11f13a'
                      - value: 600
                        color: '#1da4f2'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_ping
                    name: Ping
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
              - type: custom:mini-graph-card
                decimals: 1
                hour24: true
                height: 79
                hours_to_show: 24
                points_per_hour: 1
                group_by: interval
                line_width: 2
                entities:
                  - entity: sensor.speedtest_cli_ping
                    name: Ping (24h)
                show:
                  fill: true
                  graph: line
                  icon: true
                  name: true
                  state: true
                  labels: true
                  extrema: true
                  average: true
                  points: false
                  icon_adaptive_color: true
                align_icon: right
                align_state: right
                font_size: 125
                animate: true
                color_thresholds:
                  - value: 40
                    color: '#ef1d0f'
                  - value: 35
                    color: '#ef5a0f'
                  - value: 30
                    color: '#f0da11'
                  - value: 25
                    color: '#11f13a'
                  - value: 20
                    color: '#1da4f2'
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
    title: Systemes freebox
    cards: []
  - title: MÃ J
    path: maj
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. SERVER
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;background: transparent !important;
                      box-shadow: transparent !important;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3" '
                    - grid-template-columns: 1fr 0.69fr 0.05fr
                    - grid-template-rows: 0fr 0fr
                  card:
                    - margin-top: 1.5rem
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1: null
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: Home Assistant Server
                      subtitle: >
                        Core v{{ state_attr('update.home_assistant_core_update',
                        'installed_version') }} - OS v{{
                          state_attr('update.home_assistant_operating_system_update',
                        'installed_version') }} - Supervisor v{{
                        state_attr('update.home_assistant_supervisor_update',
                        'installed_version') }}
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          ha-card {
                              margin-right: -15rem;
                           }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('hassio')|select('search','update.home')|select('is_state','on')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hassio')|select('search','update.home')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}}  MÃ J
                         sur {{total}}" > {% elif maj == 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} MÃ J sur {{total}}" >
                        {% elif maj > 1 %} <ha-alert alert-type="warning"
                        title="{{maj}} mises a jour sur {{total}}" ></ha-alert>
                        {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-border-color: transparent !important;
                            --card-background-color: transparent !important;
                          }
                          ha-markdown.no-header {
                            margin: 0px !important;
                          }
                          ha-card {
                            margin-top: -1rem;
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_core_update
                        name: HA Core
                        show_buttons_control: true
                        icon_type: entity-picture
                        fill_container: false
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_core_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_core_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_core_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_operating_system_update
                        name: HA OS
                        show_buttons_control: true
                        icon_type: entity-picture
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_operating_system_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_operating_system_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_operating_system_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_supervisor_update
                        name: HA Supervisor
                        show_buttons_control: true
                        icon_type: entity-picture
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_supervisor_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_supervisor_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_core_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
              - type: vertical-stack
                cards:
                  - type: custom:button-card
                    show_name: false
                    show_icon: false
                    show_state: false
                    card_mod:
                      style: |
                        ha-card {
                          pointer-events: none;
                        }
                    styles:
                      grid:
                        - grid-template-areas: '"card1 card2 card3" '
                        - grid-template-columns: 1fr 0.69fr 0.05fr
                        - grid-template-rows: 0fr 0fr
                      card:
                        - padding: 5px 0px 5px 10px
                        - background: rgba(0,0,0,0)
                      custom_fields:
                        card1: null
                        card2:
                          - align-self: top
                          - height: 100%
                    custom_fields:
                      card1:
                        card:
                          type: custom:mushroom-title-card
                          title: HACS
                          subtitle: >-
                            Installed v{{ state_attr('update.hacs_update',
                            'installed_version') }} - Latest v{{
                            state_attr('update.hacs_update', 'latest_version')
                            }}
                          alignment: start
                          card_mod:
                            style: |
                              .header {
                                padding: 0px !important;
                              }
                              ha-card {
                                  margin-right: -15rem;
                               }
                      card2:
                        card:
                          type: markdown
                          content: >-
                            {% set
                            need_update=integration_entities('hacs')|select('search','update.hacs_update')|select('is_state','of')|list|count|int(2)
                            %} {% if need_update == 0 %} <ha-alert
                            alert-type="success" title="HACS est Ã  jour" > {%
                            else %} <ha-alert alert-type="error" title="1 mise a
                            jour de HASC est disponible" ></ha-alert> {% endif
                            %}
                          card_mod:
                            style: |
                              :host {
                                --ha-card-margin: 0px;
                                --ha-card-border-color: transparent !important;
                                --card-background-color: transparent !important;
                              }
                              ha-markdown.no-header {
                                margin: 0px !important;
                              }
                              ha-card {
                                margin-top: -1.3rem;
                                margin-bottom: -1.3rem;
                                margin-left: -1rem;
                                font-size: 1rem;
                                --mdc-icon-size: 1.3rem;
                               }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: https://github.com/hacs/integration/releases
                      - type: template
                        entity: update.hacs_update
                        content: >-
                          Installed v{{ state_attr('update.hacs_update',
                          'installed_version') }}
                        icon_color: green
                        icon: mdi:package-variant-closed
                        tap_action:
                          action: none
                      - type: template
                        entity: update.hacs_update
                        content: >-
                          Latest v{{ state_attr('update.hacs_update',
                          'latest_version') }}
                        icon_color: orange
                        icon: mdi:package-variant-closed
                        tap_action:
                          action: none
                    card_mod:
                      style:
                        mushroom-template-chip:nth-child(2):
                          $: |
                            mushroom-chip{
                            pointer-events: none;
                            }
                        mushroom-template-chip:nth-child(3):
                          $: |
                            mushroom-chip{
                            pointer-events: none;
                            }
                  - type: custom:auto-entities
                    card:
                      type: vertical-stack
                    card_param: cards
                    filter:
                      include:
                        - entity_id: update.hacs_update
                          state: 'on'
                          options:
                            type: custom:button-card
                            show_name: true
                            show_icon: true
                            show_state: true
                            show_entity_picture: true
                            variables:
                              url: |
                                [[[
                                  return entity.attributes.release_url
                                ]]]
                              sensor: |
                                [[[
                                  let name = Object.values(entity)
                                 return name[0]
                                  ]]]
                            name: |
                              [[[
                                return entity.attributes.friendly_name.replace('update','')
                              ]]]
                            state_display: >
                              [[[ 

                              if(entity.state== "on" &
                              entity.attributes.in_progress == false)
                                 return  entity.attributes.installed_version +' - ' + entity.attributes.latest_version
                              else if(entity.state== "off")
                               return helpers.localize(entity) +' - '+ entity.attributes.installed_version
                              else
                                return "instal - "+entity.attributes.in_progress+"%"
                              ]]]
                            styles:
                              grid:
                                - grid-template-areas: '"i n n cardupload" "i s cardurl cardupload"'
                                - grid-template-columns: 1fr 1fr 1fr 1.5fr;
                                - grid-template-rows: repeat(2, 50%);
                                - gap: 0px 0px;
                              card:
                                - padding: 0px
                                - height: 100%
                                - width: 100%
                              icon:
                                - align-self: center
                                - left: 25%
                                - width: 55%
                              name:
                                - justify-self: start
                                - font-size: 0.9em
                                - font-weight: 450
                                - padding-top: 8px
                              state:
                                - justify-self: start
                                - font-size: 0.75em
                                - padding-bottom: 0.7em
                                - padding-right: 8rem
                              custom_fields:
                                cardurl:
                                  - justify-self: center
                                  - margin-bottom: 0.7em
                                  - margin-left: 2rem
                                  - margin-right: '-2rem'
                            custom_fields:
                              cardurl:
                                card:
                                  type: custom:button-card
                                  show_icon: false
                                  name: |
                                    [[[
                                     if (variables.url == null)return ""
                                     else
                                      {return '<a style="color:white" href="'+[variables.url]+'">'+[variables.url.substr(8,18).toLowerCase()]+'</a>'}
                                     endif
                                    ]]]
                                  tap_action:
                                    action: url
                                    url_path: |
                                      [[[
                                       return variables.url
                                      ]]]
                                  styles:
                                    card:
                                      - background: rgba(100,150,255,0.5)
                                      - width: 13rem
                                      - box-sizing: border-box
                                      - padding: 0px
                                    name:
                                      - font-size: 1.2rem
                                      - font-weight: bold
                                      - font-style: italic
                              cardupload:
                                card:
                                  show_icon: true
                                  type: custom:button-card
                                  icon: |
                                    [[[
                                     if(entity.state == "off")
                                     return ""
                                     if(entity.attributes.in_progress == false)
                                     return 'mdi:upload-circle'
                                     else return 'mdi:rotate-right'
                                    ]]]
                                  styles:
                                    card:
                                      - background: none
                                      - border: none
                                    icon:
                                      - animation: |
                                          [[[
                                           if(entity.attributes.in_progress == false)
                                            return '' 
                                           else return 'rotating 1s linear infinite'
                                          ]]]
                                      - color: |
                                          [[[
                                           if(entity.state == 'on' & entity.attributes.in_progress != false)
                                           return 'green'
                                           else return 'rgba(85,252,252, 1)'
                                          ]]]
                                      - left: 18%
                                      - width: 40%
                                  tap_action:
                                    action: perform-action
                                    perform_action: update.install
                                    target:
                                      entity_id: '[[[return variables.sensor]]]'
                      exclude: []
                      card_param: cards
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. UPDATE
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - margin-top: 1.5rem
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: Addons updates
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        rejet=['update.home_assistant_core_update','update.home_assistant_operating_system_update','update.home_assistant_supervisor_update']
                        %}  {% set
                        maj=integration_entities('hassio')|select('search','update.')|select('is_state','on')|reject('in',rejet)|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hassio')|select('search','update.')|reject('in',rejet)|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MÃ J sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} MÃ J sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} MÃ j sur {{total}}"
                        ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('Home Assistant','HA').replace('Update','')
                          ]]]
                        state_display: |
                          [[[ if(entity.state== "on")
                           return 'v' + entity.attributes.installed_version +' - v' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - v'+ entity.attributes.installed_version
                          else
                           return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s s cardupload"'
                            - grid-template-columns: 0.6fr 1fr 1.6fr 1fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                        custom_fields:
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)'
                                      ]]]
                                  - left: 17%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude:
                    - name: Home*
                    - integration: hacs
                    - integration: mqtt
                  card_param: cards
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: HACS updates
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('hacs')|select('search','update.')|select('is_state','on')|reject('in','update.hacs_update')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hacs')|select('search','update.')|reject('in','update.hacs_update')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MÃ J sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} MÃ J sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}}  mÃ j sur {{total}}"
                        ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: markdown
                content: >-
                  {% set maj = states.update |
                  selectattr('attributes.release_summary','defined') |
                  selectattr('attributes.release_summary','eq','<ha-alert
                  alert-type=\'error\'>Restart of Home Assistant
                  required</ha-alert>') |map(attribute='name') |list %}

                  {% set maj_count = maj|count|int(2) %}

                  {% if maj_count >= 1 %} <ha-alert alert-type="error"
                  title="{{maj_count}} intÃ©grations nÃ©cessitent un redÃ©marrage">

                  <hr>

                  <ul>{% for i in maj%}

                  <li>{{i}}</li>

                  {% endfor%}</ul>

                  {% else %}

                  {% endif %}</ha-alert>
                card_mod:
                  style: |
                    :host {
                      --ha-card-margin: 0px;
                      --ha-card-background: #00000000 !important;
                      --ha-card-border-color: #00000000 !important;
                      }
                    ha-markdown.no-header {
                      padding: 4rem !important;
                      padding-top: 0rem !important;
                      padding-bottom: 0rem !important;
                    }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      integration: hacs
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          url: |
                            [[[
                              return entity.attributes.release_url
                            ]]]
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('update','')
                          ]]]
                        state_display: >
                          [[[ 

                          if(entity.state== "on" & entity.attributes.in_progress
                          == false)
                             return  entity.attributes.installed_version +' - ' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - '+ entity.attributes.installed_version
                          else
                            return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s cardurl cardupload"'
                            - grid-template-columns: 1fr 1fr 1fr 1.5fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                            - padding-right: 8rem
                          custom_fields:
                            cardurl:
                              - justify-self: center
                              - margin-bottom: 0.7em
                              - margin-left: 2rem
                              - margin-right: '-2rem'
                        custom_fields:
                          cardurl:
                            card:
                              type: custom:button-card
                              show_icon: false
                              name: |
                                [[[
                                 if (variables.url == null)return ""
                                 else
                                  {return '<a style="color:white" href="'+[variables.url]+'">'+[variables.url.substr(8,18).toLowerCase()]+'</a>'}
                                 endif
                                ]]]
                              tap_action:
                                action: url
                                url_path: |
                                  [[[
                                   return variables.url
                                  ]]]
                              styles:
                                card:
                                  - background: rgba(100,150,255,0.5)
                                  - width: 13rem
                                  - box-sizing: border-box
                                  - padding: 0px
                                name:
                                  - font-size: 1.2rem
                                  - font-weight: bold
                                  - font-style: italic
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)'
                                      ]]]
                                  - left: 18%
                                  - width: 40%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude:
                    - entity_id: update.hacs_update
                  card_param: cards
                sort:
                  method: friendly_name
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: ZigBee2MQTT
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('mqtt')|select('search','update.')|select('is_state','on')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('mqtt')|select('search','update.')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MÃ J sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} MÃ j sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} mises a jour sur
                        {{total}}" ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      integration: mqtt
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('Home Assistant','HA').replace('Update','')
                          ]]]
                        state_display: >
                          [[[ if(entity.state== "on" &
                          entity.attributes.in_progress == false)
                           return 'v' + entity.attributes.installed_version +' - v' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - v'+ entity.attributes.installed_version
                          else
                           return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s s cardupload"'
                            - grid-template-columns: 0.6fr 1fr 1.6fr 1fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                        custom_fields:
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)' 
                                      ]]]
                                  - left: 17%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude: []
                  card_param: cards
                sort:
                  method: friendly_name
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. ADD-ON
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_core_update
                    show_buttons_control: false
                    icon_type: entity-picture
                    layout: horizontal
                    secondary_info: none
                    name: Home Assistant Core
                    card_mod:
                      style: |
                        ha-card {
                            --card-primary-line-height: 2.5rem;
                            --card-primary-font-size: 1.7rem;
                            --card-primary-font-weight: normal;
                            border: none !important;
                            box-shadow: none !important;
                            background: rgba(0,0,0,0);
                            margin-top: 1rem;
                         }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: https://www.home-assistant.io/latest-release-notes/
                      - type: entity
                        entity: sensor.home_assistant_core_cpu_percent
                        icon_color: blue
                      - type: entity
                        entity: sensor.home_assistant_core_memory_percent
                        icon_color: orange
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_supervisor_update
                    show_buttons_control: false
                    icon_type: entity-picture
                    layout: horizontal
                    secondary_info: none
                    name: Home Assistant Supervisor
                    card_mod:
                      style: |
                        ha-card {
                            --card-primary-line-height: 2.5rem;
                            --card-primary-font-size: 1.7rem;
                            --card-primary-font-weight: normal;
                            border: none !important;
                            box-shadow: none !important;
                            background: rgba(0,0,0,0);
                            margin-top: 1.2rem;
                         }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: >-
                            https://github.com/home-assistant/supervisor/releases/latest
                      - type: entity
                        entity: sensor.home_assistant_supervisor_cpu_percent
                        icon_color: blue
                      - type: entity
                        entity: sensor.home_assistant_supervisor_memory_percent
                        icon_color: orange
    cards: []
  - type: sections
    max_columns: 1
    path: air-quality
    title: Air Quality
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:virus-outline
            heading: AIR QUALITY
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: SALON
            icon: mdi:sofa
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:streamline-card
            template: pm25_ring-tile
            variables:
              card_name: PM2.5 du Salon
              entity: sensor.qualite_air_salon_ikea_pm25
              marker2: sensor.pm2_5_salon_moy_24h
            grid_options:
              columns: 6
              rows: auto
          - type: custom:streamline-card
            template: cov_ring-tile
            variables:
              card_name: tCOV du Salon
              entity: sensor.tcov_salon_ppb
              marker2: sensor.tcov_salon_moy_24h
            grid_options:
              columns: 6
              rows: auto
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.qualite_air_salon_ikea_pm25
            name: Graph. PM2.5 Salon
            icon: mdi:open-in-new
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#spm25'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#spm25'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.tcov_salon_ppb
            name: Graph. tCOV Salon
            icon: mdi:open-in-new
            unit: ppb
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#scov'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#scov'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#spm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality SALON
                icon: mdi:air-filter
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_salon_ikea_pm25
                  mean_24h_entity: sensor.pm2_5_salon_moy_24h
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#scov'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality SALON
                icon: mdi:air-filter
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_salon_ikea_voc_index
                  mean_24h_entity: sensor.tcov_salon_moy_24h
          - type: custom:bubble-card
            card_type: separator
            name: BUREAU
            icon: mdi:desktop-tower-monitor
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:streamline-card
            template: pm25_ring-tile
            variables:
              card_name: PM2.5 du Bureau
              entity: sensor.qualite_air_bureau_ikea_pm25
              marker2: sensor.pm2_5_bureau_moy_24h
            grid_options:
              columns: 6
              rows: auto
          - type: custom:streamline-card
            template: cov_ring-tile
            variables:
              card_name: tCOV du Bureau
              entity: sensor.tcov_bureau_ppb
              marker2: sensor.tcov_bureau_moy_24h
            grid_options:
              columns: 6
              rows: auto
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.qualite_air_bureau_ikea_pm25
            name: Graph. PM2.5 Bureau
            icon: mdi:open-in-new
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#bpm25'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#bpm25'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.tcov_bureau_ppb
            name: Graph. tCOV Bureau
            icon: mdi:open-in-new
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#bcov'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#bcov'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bpm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality BUREAU
                icon: mdi:air-filter
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_bureau_ikea_pm25
                  mean_24h_entity: sensor.pm2_5_bureau_moy_24h
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bcov'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality BUREAU
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_bureau_ikea_voc_index
                  mean_24h_entity: sensor.tcov_bureau_moy_24h
          - type: custom:bubble-card
            card_type: separator
            name: CHAMBRE
            icon: mdi:bed
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:streamline-card
            template: pm25_ring-tile
            variables:
              card_name: PM2.5 de la Chambre
              entity: sensor.qualite_air_chambre_ikea_pm25
              marker2: sensor.pm2_5_chambre_moy_24h
            grid_options:
              columns: 6
              rows: auto
          - type: custom:streamline-card
            template: cov_ring-tile
            variables:
              card_name: tCOV du Chambre
              entity: sensor.tcov_chambre_ppb
              marker2: sensor.tcov_chambre_moy_24h
            grid_options:
              columns: 6
              rows: 1
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.qualite_air_chambre_ikea_pm25
            name: Graph. PM2.5 Chambre
            icon: mdi:open-in-new
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#cpm25'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#cpm25'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: sensor.tcov_chambre_ppb
            name: Graph. tCOV Chambre
            icon: mdi:open-in-new
            show_state: true
            tap_action:
              action: navigate
              navigation_path: '#ccov'
            styles: |
              .bubble-card, .bubble-button-background {
                background: transparent !important;
                border: none !important; box-shadow: none !important;
              }
            grid_options:
              columns: 6
              rows: auto
            show_attribute: false
            show_icon: true
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#ccov'
            card_mod:
              style: |
                ha-card {
                  margin-top:-30px;     
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cpm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality CHAMBRE
                icon: mdi:air-filter
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_chambre_ikea_pm25
                  mean_24h_entity: sensor.pm2_5_chambre_moy_24h
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#ccov'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality CHAMBRE
                icon: mdi:air-filter
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_chambre_ikea_voc_index
                  mean_24h_entity: sensor.tcov_chambre_moy_24h
    cards: []
  - type: sections
    max_columns: 1
    title: POLLEN - POLLUTION
    path: pollen-pollution
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:decagram
            heading: POLLENS - POLUTION
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: POLLENS [ Atmo France - Vence ]
          - type: custom:vertical-stack-in-card
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:entity-progress-card-template
                    entity: sensor.qualite_globale_pollen_vence
                    name: QualitÃ© Pollens
                    icon: mdi:flower-pollen
                    secondary: '{{ state_attr(entity, ''LibellÃ©'') }} ({{ states(entity) }})'
                    bar_color: '{{ state_attr(entity, ''Couleur'') }}'
                    color: '{{ state_attr(entity, ''Couleur'') }}'
                    bar_size: large
                    bar_effect: radius
                    percent: |
                      {% set current = states(entity) | int(0) %}
                      {% set max_value = 7 %}
                      {% set percent = (current / max_value * 100) | round(0) %}
                      {{ percent }}
                    icon_tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: vertical-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - square: false
                        type: grid
                        columns: 3
                        cards:
                          - type: custom:ring-tile
                            entity: sensor.concentration_gramine_vence
                            name: GraminÃ©es
                            ring_entity: sensor.niveau_gramine_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.concentration_ambroisie_vence
                            name: Ambroisie
                            ring_entity: sensor.niveau_ambroisie_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.concentration_armoise_vence
                            name: Armoise
                            ring_entity: sensor.niveau_armoise_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.concentration_aulne_vence
                            name: Aulne
                            ring_entity: sensor.niveau_aulne_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.concentration_bouleau_vence
                            name: Bouleau
                            ring_entity: sensor.niveau_bouleau_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.concentration_olivier_vence
                            name: Olivier
                            ring_entity: sensor.niveau_olivier_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.96);
                                  margin: 0px 0px 0px 0px;
                                }
            card_mod:
              style: |
                ha-card {
                border: none !important;
                box-shadow: none !important;
                background: none !important;
                margin: 0;
                padding: 0;
                 }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: QUALITE DE L'AIR [ Atmo France - Vence ]
          - type: custom:vertical-stack-in-card
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:entity-progress-card-template
                    entity: sensor.qualite_globale_vence
                    name: QualitÃ© Air
                    secondary: '{{ state_attr(entity, ''LibellÃ©'') }} ({{ states(entity) }})'
                    bar_color: '{{ state_attr(entity, ''Couleur'') }}'
                    color: '{{ state_attr(entity, ''Couleur'') }}'
                    bar_size: large
                    bar_effect: radius
                    percent: |
                      {% set current = states(entity) | int(0) %}
                      {% set max_value = 7 %}
                      {% set percent = (current / max_value * 100) | round(0) %}
                      {{ percent }}
                    icon_tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: vertical-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - square: false
                        type: grid
                        columns: 5
                        cards:
                          - type: custom:ring-tile
                            entity: sensor.ozone_vence
                            name: Oâ‚ƒ (Ozone)
                            ring_entity: sensor.ozone_vence
                            ring_type: opn
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.57);
                                  margin: 0px 0px 0px -2px;
                                }        
                          - type: custom:ring-tile
                            entity: sensor.dioxyde_d_azote_vence
                            name: NOâ‚‚ (Azote)
                            ring_entity: sensor.dioxyde_d_azote_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.57);
                                  margin: 0px -2px 0px 0px;
                                }
                          - type: custom:ring-tile
                            entity: sensor.dioxyde_de_soufre_vence
                            name: SOâ‚‚ (Souffre)
                            ring_entity: sensor.dioxyde_de_soufre_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.57);
                                  margin: 0px 0px 0px 0px;
                                }  
                          - type: custom:ring-tile
                            entity: sensor.pm10_vence
                            name: PM10
                            ring_entity: sensor.pm10_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.57);
                                  margin: 0px 0px 0px 0px;;
                                }
                          - type: custom:ring-tile
                            entity: sensor.pm25_vence
                            name: PM25
                            ring_entity: sensor.pm25_vence
                            ring_type: open
                            ring_size: 3
                            scale: ticks_with_labels
                            middle_element: value_with_unit
                            bottom_element: name
                            colorize_icon: true
                            indicator: dot
                            min: 0
                            max: 7
                            colour:
                              '0': '#ddd'
                              '1': '#50f0e6'
                              '2': '#50ccaa'
                              '3': '#f0e641'
                              '4': '#ff5050'
                              '5': '#960032'
                              '6': '#872181'
                              '7': '#888'
                            card_mod:
                              style: |
                                ha-card {
                                  border: none !important;
                                  box-shadow: none !important;
                                  background: none !important;
                                  align-items: center;
                                  justify-content: center;      
                                  transform: scale(0.57);
                                  margin: 0px 0px 0px 0px;
                                }
            card_mod:
              style: |
                ha-card {
                border: none !important;
                box-shadow: none !important;
                background: none !important;
                margin: 0;
                padding: 0;
                 }
        column_span: 10
    cards: []
    header:
      layout: responsive
      badges_position: bottom
      badges_wrap: wrap
  - type: sections
    max_columns: 1
    title: VIGIEAU / VIGI - EAU
    path: vigieau
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:water
            heading: VIGIEAU / VIGI - EAU
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: false
              border_radius: true
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: SÃ‰CHERESSE
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: transparent !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
                card:
                  type: horizontal-stack
                  cards:
                    - type: custom:button-card
                      entity: sensor.alert_level_in_vence
                      name: 'Vigi - Eau Vence:'
                      layout: icon_name_state2nd
                      color_type: icon
                      show_name: true
                      show_state: true
                      state_display: |
                        [[[
                          if (entity.state === "vigilance (pas de restriction)") return "Aucune restriction";
                          if (entity.state === "alerte_renforcee") return "Alerte renforcÃ©e";
                          return entity.state;
                        ]]]
                      state:
                        - value: null
                          operator: '=='
                          color: grey
                          icon: mdi:water-off
                          styles:
                            state:
                              - color: grey
                        - value: vigilance (pas de restriction)
                          operator: '=='
                          color: rgb(232, 237, 255)
                          icon: mdi:water-check
                          styles:
                            state:
                              - color: rgb(232, 237, 255)
                        - value: vigilance
                          operator: '=='
                          color: rgb(255, 237, 160)
                          icon: mdi:water-minus
                          styles:
                            state:
                              - color: rgb(255, 237, 160)
                        - value: alerte
                          operator: '=='
                          color: rgb(254, 178, 7 un6)
                          icon: mdi:water-alert
                          styles:
                            state:
                              - color: rgb(254, 178, 76)
                        - value: alerte_renforcee
                          operator: '=='
                          color: rgb(252, 78, 42)
                          icon: mdi:water-remove
                          styles:
                            state:
                              - color: rgb(252, 78, 42)
                        - value: crise
                          operator: '=='
                          color: rgb(177, 0, 38)
                          icon: mdi:water-off
                          styles:
                            state:
                              - color: rgb(177, 0, 38)
                      size: 50%
                      styles:
                        card:
                          - font-weight: bold
                          - '--mdc-ripple-color': rgb(68, 115, 158)
                          - '--mdc-ripple-press-opacity': 0.5
                        name:
                          - font-size: 15px
                        state:
                          - font-weight: bold
                          - font-size: 15px
                    - type: custom:bar-card
                      entities:
                        - entity: sensor.alert_level_in_vence_numeric
                          name: ' '
                          icon: |
                            [[[
                              var iconName = entity.attributes.icon || 'mdi:water-outline';
                              return iconName;
                            ]]]
                          height: 32px
                          color: |
                            [[[
                              var colorName = entity.attributes.Couleur || 'grey';
                              return colorName;
                            ]]]
                          min: 0
                          max: 4
                          target: 3.5
                          animation:
                            state: 'on'
                          positions:
                            indicator: inside
                            icon: inside
                          severity:
                            - color: rgb(232, 237, 255)
                              icon: mdi:water-check
                              from: 0
                              to: 0
                            - color: rgb(255, 237, 160)
                              icon: mdi:water-minus
                              from: 1
                              to: 1
                            - color: rgb(255, 237, 160)
                              icon: mdi:water-alert
                              from: 2
                              to: 2
                            - color: rgb(252, 78, 42)
                              icon: mdi:water-remove
                              from: 3
                              to: 3
                            - color: rgb(254, 178, 76)
                              from: 4
                              to: 4
                      card_mod:
                        style: |
                          bar-card-currentbar,
                          bar-card-backgroundbar {
                            border-radius: 10px;
                          }
                          bar-card-value {
                            margin-right: 25px;
                            font-weight: bold;
                            font-size: 15px;
                            color: white;
                          }
                          ha-icon{
                            color: black !important;
                          }
              - type: conditional
                conditions:
                  - entity: sensor.alert_level_in_vence
                    state_not: nul
                card:
                  type: custom:mod-card
                  card_mod:
                    style: |
                      ha-card {
                        margin: 7px 2px 5px 2px;
                      }
                  card:
                    type: custom:auto-entities
                    card:
                      type: grid
                      columns: 4
                      square: false
                    card_param: cards
                    filter:
                      include:
                        - entity_id: sensor.*_restrictions_vence
                          options:
                            type: custom:button-card
                            color_type: icon
                            aspect_ratio: 1/1
                            show_name: true
                            show_state: true
                            name: |
                              [[[ return entity.attributes.friendly_name; ]]]
                            color: |
                              [[[
                                const state = entity.state;
                                if (state.length > 30) return "rgb(255, 216, 148)";
                                if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                if (state === "Interdiction") return "rgb(252, 78, 42)";
                                if (state === "unknown") return "grey";
                                return "grey";
                              ]]]
                            tap_action:
                              action: fire-dom-event
                              browser_mod:
                                service: browser_mod.popup
                                data:
                                  title: >
                                    [[[ return entity.attributes.friendly_name;
                                    ]]]
                                  style: |
                                    --popup-min-width: 300px;
                                    --popup-max-width: 300px; 
                                  content:
                                    type: custom:button-card
                                    entity: |
                                      [[[ return entity.entity_id; ]]]
                                    show_name: true
                                    show_state: true
                                    show_icon: true
                                    name: >
                                      [[[ return
                                      entity.attributes.friendly_name; ]]]
                                    styles:
                                      card: null
                                      name:
                                        - font-size: 16px
                                      state:
                                        - font-size: 22px
                                        - white-space: normal
                                        - font-weight: bold
                                        - color: |
                                            [[[
                                              const state = entity.state;
                                              if (state.length > 30) return "rgb(255, 216, 148)";
                                              if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                              if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                              if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                              if (state === "Interdiction") return "rgb(252, 78, 42)";
                                              if (state === "unknown") return "grey";
                                              return "grey";
                                            ]]]
                                      icon:
                                        - color: |
                                            [[[
                                              const state = entity.state;
                                              if (state.length > 30) return "rgb(255, 216, 148)";
                                              if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                              if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                              if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                              if (state === "Interdiction") return "rgb(252, 78, 42)";
                                              if (state === "unknown") return "grey";
                                              return "grey";
                                            ]]]
                            styles:
                              card:
                                - '--mdc-ripple-color': rgb(68, 115, 158)
                                - '--mdc-ripple-press-opacity': 0.5
                                - border-radius: 8px
                                - background: transparent
                                - box-shadow: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "0px 0px 0px 2px rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "0px 0px 0px 2px rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "0px 0px 0px 2px rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "0px 0px 0px 2px rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "0px 0px 0px 2px rgb(252, 78, 42)";
                                      if (state === "unknown") return "0px 0px 0px 2px grey";
                                      return "0px 0px 0px 2px grey";
                                    ]]]
                              name:
                                - font-size: 12px
                                - white-space: normal
                              state:
                                - font-weight: bold
                                - font-size: 12px
                                - white-space: normal
                                - color: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "rgb(252, 78, 42)";
                                      if (state === "unknown") return "grey";
                                      return "grey";
                                    ]]]
                              icon:
                                - color: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "rgb(252, 78, 42)";
                                      if (state === "unknown") return "grey";
                                      return "grey";
                                    ]]]
